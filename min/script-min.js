function initializeGuiControls(){var t=new dat.GUI,e=t.addFolder("World building"),n=e.addFolder("Parameters");n.add(this,"particleCount"),n.add(this,"dt");var r=e.addFolder("Physical Constants");r.add(this,"EPSILON"),r.add(this,"DELTA"),r.add(this,"G"),r.add(this,"K");var i=e.addFolder("Universe boundary");i.add(this,"if_showUniverseBoundary"),i.add(this,"if_use_periodic_boundary_condition").name("Use PBC");var o=i.addFolder("Custom size");o.add(this,"spaceBoundaryX").name("Size, X").onChange(function(t){boxMesh&&(boxMesh.scale.x=spaceBoundaryX/originalSpaceBoundaryX)}),o.add(this,"spaceBoundaryY").name("Size, Y").onChange(function(t){boxMesh&&(boxMesh.scale.y=spaceBoundaryY/originalSpaceBoundaryY)}),o.add(this,"spaceBoundaryZ").name("Size, Z").onChange(function(t){boxMesh&&(boxMesh.scale.z=spaceBoundaryZ/originalSpaceBoundaryZ)});var a=e.addFolder("Forcefields to apply");a.add(this,"if_apply_LJpotential").name("LJ potential"),a.add(this,"if_apply_gravitation").name("Gravitation"),a.add(this,"if_apply_coulombForce").name("Coulomb Force"),e.open();var s=t.addFolder("Plotting");s.add(this,"if_ReferenceFrame_movesWithSun").name("Center the sun");var c=s.addFolder("Particle trajectories");c.add(this,"if_showTrajectory").name("Show"),c.add(this,"maxTrajectoryLength").name("Steps to remember").onChange(function(t){});var l=s.addFolder("Arrows for forces and velocities");l.add(this,"if_showArrows").name("Show arrows").onChange(function(t){_.each(arrowForces,function(e){e.visible=t}),_.each(arrowVelocities,function(e){e.visible=t})}),l.add(this,"if_limitArrowsMaxLength").name("Limit length"),l.add(this,"maxArrowLength").name("Max length"),l.add(this,"unitArrowLength").name("Unit length"),l.add(this,"if_showMapscale").name("Show scales").onChange(function(t){$(".mapscale").toggle()}),l.add(this,"if_proportionate_arrows_with_vectors").name("Proportionate arrows with vectors"),s.open();var u=t.addFolder("Commands");u.add(this,"clearState").name("New world"),u.open(),t.remember(this),t.close()}function save(t,e){localStorage.setItem(t,JSON.stringify(e))}function saveState(){save("particleCount",particleCount),save("particleColors",particleColors),save("particlePositions",particlePositions),save("particleForces",particleForces),save("particleVelocities",particleVelocities),save("particleMasses",particleMasses),save("particleCharges",particleCharges),save("time",time),save("lastSnapshotTime",lastSnapshotTime)}function clearState(){localStorage.removeItem("particleColors"),localStorage.removeItem("particlePositions"),localStorage.removeItem("particleForces"),localStorage.removeItem("particleVelocities"),localStorage.removeItem("particleMasses"),localStorage.removeItem("particleCharges"),localStorage.removeItem("time"),localStorage.removeItem("lastSnapshotTime"),window.onbeforeunload=null,location.reload()}function loadState(){return console.log("Loading particleCount..."),previous_particleCount=JSON.parse(localStorage.getItem("particleCount")),null==previous_particleCount?(console.log("Failed."),!1):(console.log("Loading particleColors..."),previous_particleColors=JSON.parse(localStorage.getItem("particleColors")),null==previous_particleColors?(console.log("Failed."),!1):(console.log("Loading particlePositions..."),previous_particlePositions=JSON.parse(localStorage.getItem("particlePositions")),null==previous_particlePositions?(console.log("Failed."),!1):(console.log("Loading particleForces..."),previous_particleForces=JSON.parse(localStorage.getItem("particleForces")),null==previous_particleForces?(console.log("Failed."),!1):(console.log("Loading particleVelocities..."),previous_particleVelocities=JSON.parse(localStorage.getItem("particleVelocities")),null==previous_particleVelocities?(console.log("Failed."),!1):(console.log("Loading particleMasses..."),previous_particleMasses=JSON.parse(localStorage.getItem("particleMasses")),null==previous_particleMasses?(console.log("Failed."),!1):(console.log("Loading particleCharges..."),previous_particleCharges=JSON.parse(localStorage.getItem("particleCharges")),null==previous_particleCharges?(console.log("Failed."),!1):(console.log("Loading time..."),previous_time=JSON.parse(localStorage.getItem("time")),null==previous_time?(console.log("Failed."),!1):(console.log("Loading lastSnapshotTime..."),previous_lastSnapshotTime=JSON.parse(localStorage.getItem("lastSnapshotTime")),null==previous_lastSnapshotTime?(console.log("Failed."),!1):(console.log("Successfully loaded all variables."),!0)))))))))}function generateTexture(){var t=32,e=document.createElement("canvas");e.width=t,e.height=t;var n=e.getContext("2d"),r=t/2,i=t/2,o=t/2;return n.beginPath(),n.arc(r,i,o,0,2*Math.PI,!1),n.fillStyle="#fff",n.fill(),e}function drawBox(){boxGeometry=new THREE.BoxGeometry(2*spaceBoundaryX,2*spaceBoundaryY,2*spaceBoundaryZ),boxMaterial=new THREE.MeshBasicMaterial({color:11184810,wireframe:!0,opacity:.8}),boxMesh=new THREE.Mesh(boxGeometry,boxMaterial),scene.add(boxMesh)}function addParticle(t,e,n,r,i,o,a,s,c,l,u,h,d,p){var f=new THREE.Color;f.setHSL(t,e,n),particleColors.push(f);var m=new THREE.Vector3(r,i,o);particlePositions.push(m),particles.vertices.push(m);var g=new THREE.Vector3(a,s,c);particleVelocities.push(g);var v=new THREE.Vector3(l,u,h);particleForces.push(v),particleMasses.push(d),totalMass+=d,particleCharges.push(p);var y=new THREE.ArrowHelper(new THREE.Vector3,new THREE.Vector3,1,21930);scene.add(y),arrowVelocities.push(y);var y=new THREE.ArrowHelper(new THREE.Vector3,new THREE.Vector3,1,5592405);if(scene.add(y),arrowForces.push(y),if_showTrajectory){var _=new THREE.BufferGeometry;trajectoryGeometries.push(_);var b=new Float32Array(3*maxTrajectoryLength);_.addAttribute("position",new THREE.BufferAttribute(b,3));for(var x=0;x<maxTrajectoryLength;x++)_.attributes.position.setXYZ(x,m.x,m.y,m.z);var w=f.clone();w.offsetHSL(0,-.5,.2),thisTrajectoryMaterial=new THREE.LineBasicMaterial({color:w,linewidth:.5});var E=new THREE.Line(_,thisTrajectoryMaterial);trajectoryLines.push(E),scene.add(E)}}function createParticleSystem(){if(particles=new THREE.Geometry,texture=new THREE.Texture(generateTexture()),texture.needsUpdate=!0,particleMaterial=new THREE.PointsMaterial({map:texture,blending:THREE.NormalBlending,depthTest:!1,transparent:!0,opacity:.9,size:.3,vertexColors:THREE.VertexColors}),loadState()){console.log("State from previous session loaded."),previous_particleCount<particleCount||if_override_particleCount_setting_with_lastState?particleCountToRead=previous_particleCount:particleCountToRead=particleCount;for(var t=0;t<particleCountToRead;t++){var e=new THREE.Color;e.set(previous_particleColors[t]),tempColorInHSL=e.getHSL(),addParticle(colorH=tempColorInHSL.h,colorS=tempColorInHSL.s,colorL=tempColorInHSL.l,positionX=previous_particlePositions[t].x,positionY=previous_particlePositions[t].y,positionZ=previous_particlePositions[t].z,velocityX=previous_particleVelocities[t].x,velocityY=previous_particleVelocities[t].y,velocityZ=previous_particleVelocities[t].z,forceX=previous_particleForces[t].x,forceY=previous_particleForces[t].y,forceZ=previous_particleForces[t].z,thisMass=previous_particleMasses[t],thisCharge=previous_particleCharges[t])}var n=particleCount-previous_particleCount;n<0?console.log("Dropping",-n,"particles stored, since we only need",particleCount,"particles this time."):n>0&&console.log("md.js will be creating only",n,"particles from scratch, since",previous_particleCount,"has been loaded from previous browser session."),time=previous_time,lastSnapshotTime=previous_lastSnapshotTime}else{console.log("Creating new universe.");var n=particleCount;console.log("md.js will be creating all",particleCount,"particles from scratch."),if_makeSun&&addParticle(0,0,0,0,0,0,0,0,0,0,0,0,sunMass,0)}for(var t=particlePositions.length;t<particleCount;t++){if(if_makeSun){var r=_.random(-spaceBoundaryX,spaceBoundaryX,!0),i=0,o=_.random(-spaceBoundaryZ,spaceBoundaryZ,!0),a=Math.sqrt(r*r+i*i+o*o),s=0,c=Math.sqrt(G*particleMasses[0]/a),l=0;t%2==0&&(c*=-1)}else var r=_.random(-spaceBoundaryX,spaceBoundaryX,!0),i=_.random(-spaceBoundaryY,spaceBoundaryY,!0),o=_.random(-spaceBoundaryZ,spaceBoundaryZ,!0),a=Math.sqrt(r*r+i*i+o*o),s=0,c=0,l=0;addParticle(Math.random(),1,.5,r,i,o,s,c,l,0,0,0,_.random(16,20,!0),_.sample(availableCharges))}return particles.colors=particleColors,particleSystem=new THREE.Points(particles,particleMaterial),particleSystem}function init(){function t(e){e.alpha&&(controls=new THREE.DeviceOrientationControls(camera,!0),controls.connect(),controls.update(),element.addEventListener("click",fullscreen,!1),window.removeEventListener("deviceorientation",t,!0))}if_mobileDevice?$("#settings").hide():initializeGuiControls(),scene=new THREE.Scene,if_useFog&&(scene.fog=new THREE.Fog(16777215,0,20)),if_showUniverseBoundary&&drawBox(),scene.add(createParticleSystem()),camera=new THREE.PerspectiveCamera(90,window.innerWidth/window.innerHeight,1,1e6),camera.position.set(0,2,10),scene.add(camera),renderer=new THREE.WebGLRenderer({alpha:!0}),renderer.setSize(window.innerWidth,window.innerHeight),renderer.setPixelRatio(4),if_mobileDevice&&(effect=new THREE.StereoEffect(renderer)),element=renderer.domElement,container=document.body,container.appendChild(element),controls=new THREE.OrbitControls(camera,element),window.addEventListener("deviceorientation",t,!0),stats=new Stats,container.append(stats.domElement),window.addEventListener("resize",resize,!1),setTimeout(resize,1),window.onbeforeunload=saveState}function animate(){function t(t,e,n,r){var i=if_proportionate_arrows_with_vectors?n.length()*r:unitArrowLength;t.setLength(if_limitArrowsMaxLength&&i>maxArrowLength?maxArrowLength:i),t.position.copy(e),t.setDirection((new THREE.Vector3).copy(n).normalize())}time+=dt;for(var e=0;e<particleCount;e++)particleForces[e].set(0,0,0);for(var e=0;e<particleCount;e++)for(var n=e+1;n<particleCount;n++){if(if_apply_LJpotential){var r=(new THREE.Vector3).subVectors(particlePositions[e],particlePositions[n]),i=r.length(),o=DELTA/i;o<.5&&(o=.5),o=o*o*o,o*=o,r.setLength(4*EPSILON*(6/i)*(-2*o*o+o)),particleForces[e].sub(r),particleForces[n].add(r)}if(if_apply_gravitation){var r=(new THREE.Vector3).subVectors(particlePositions[e],particlePositions[n]),i=r.length();i<d_min&&(console.log("particle",e,",",n,"too near."),i=d_min),r.setLength(G*particleMasses[e]*particleMasses[n]/(i*i)),particleForces[e].sub(r),particleForces[n].add(r)}if(if_apply_coulombForce){var r=(new THREE.Vector3).subVectors(particlePositions[e],particlePositions[n]),i=r.length();i<d_min&&(console.log("particle",e,",",n,"too near."),i=d_min),r.setLength(-K*particleCharges[e]*particleCharges[n]/(i*i)),particleForces[e].sub(r),particleForces[n].add(r)}}highestForcePresent=_.max(_.map(particleForces,function(t){return t.length()})),arrowScaleForForces=unitArrowLength/highestForcePresent,$(".mapscale#force").width(1e6*arrowScaleForForces),highestVelocityPresent=_.max(_.map(particleVelocities,function(t){return t.length()})),arrowScaleForVelocities=unitArrowLength/highestVelocityPresent,$(".mapscale#velocity").width(1e4*arrowScaleForVelocities);for(var e=0;e<particleCount;e++){if(particleVelocities[e].addScaledVector(particleForces[e],dt/particleMasses[e]),particlePositions[e].addScaledVector(particleVelocities[e],dt),if_use_periodic_boundary_condition){for(;particlePositions[e].x<-spaceBoundaryX;)particlePositions[e].x+=2*spaceBoundaryX;for(;particlePositions[e].x>spaceBoundaryX;)particlePositions[e].x-=2*spaceBoundaryX;for(;particlePositions[e].y<-spaceBoundaryY;)particlePositions[e].y+=2*spaceBoundaryY;for(;particlePositions[e].y>spaceBoundaryY;)particlePositions[e].y-=2*spaceBoundaryY;for(;particlePositions[e].z<-spaceBoundaryZ;)particlePositions[e].z+=2*spaceBoundaryZ;for(;particlePositions[e].z>spaceBoundaryZ;)particlePositions[e].z-=2*spaceBoundaryZ}if(if_showArrows&&(t(arrow=arrowVelocities[e],from=particlePositions[e],vector=particleVelocities[e],scale=arrowScaleForForces),t(arrow=arrowForces[e],from=particlePositions[e],vector=particleForces[e],scale=arrowScaleForVelocities)),if_showTrajectory&&time-lastSnapshotTime>snapshotDuration){for(var a=trajectoryLines[e].geometry.attributes.position,n=0;n<maxTrajectoryLength-1;n++)a.copyAt(n,a,n+1);a.setXYZ(n,particlePositions[e].x,particlePositions[e].y,particlePositions[e].z),a.needsUpdate=!0}}if(if_showTrajectory&&time-lastSnapshotTime>snapshotDuration&&(lastSnapshotTime=time),if_ReferenceFrame_movesWithSun)for(var e in particlePositions)particlePositions[e].sub(particlePositions[0]);particleSystem.geometry.verticesNeedUpdate=!0,update(),render(),requestAnimationFrame(animate),stats.update()}function resize(){var t=container.offsetWidth,e=container.offsetHeight;camera.aspect=t/e,camera.updateProjectionMatrix(),renderer.setSize(t,e),if_mobileDevice&&effect.setSize(t,e)}function update(){camera.updateProjectionMatrix(),controls.update()}function render(){if_mobileDevice?effect.render(scene,camera):renderer.render(scene,camera)}function fullscreen(){container.requestFullscreen?container.requestFullscreen():container.msRequestFullscreen?container.msRequestFullscreen():container.mozRequestFullScreen?container.mozRequestFullScreen():container.webkitRequestFullscreen&&container.webkitRequestFullscreen()}!function(t,e){"use strict";function n(t){var e=t.length,n=st.type(t);return!st.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===n||"function"!==n&&(0===e||"number"==typeof e&&e>0&&e-1 in t)))}function r(t){var e=xt[t]={};return st.each(t.match(lt)||[],function(t,n){e[n]=!0}),e}function i(t,n,r,i){if(st.acceptData(t)){var o,a,s=st.expando,c="string"==typeof n,l=t.nodeType,u=l?st.cache:t,h=l?t[s]:t[s]&&s;if(h&&u[h]&&(i||u[h].data)||!c||r!==e)return h||(l?t[s]=h=Q.pop()||st.guid++:h=s),u[h]||(u[h]={},l||(u[h].toJSON=st.noop)),("object"==typeof n||"function"==typeof n)&&(i?u[h]=st.extend(u[h],n):u[h].data=st.extend(u[h].data,n)),o=u[h],i||(o.data||(o.data={}),o=o.data),r!==e&&(o[st.camelCase(n)]=r),c?(a=o[n],null==a&&(a=o[st.camelCase(n)])):a=o,a}}function o(t,e,n){if(st.acceptData(t)){var r,i,o,a=t.nodeType,c=a?st.cache:t,l=a?t[st.expando]:st.expando;if(c[l]){if(e&&(r=n?c[l]:c[l].data)){st.isArray(e)?e=e.concat(st.map(e,st.camelCase)):e in r?e=[e]:(e=st.camelCase(e),e=e in r?[e]:e.split(" "));for(i=0,o=e.length;o>i;i++)delete r[e[i]];if(!(n?s:st.isEmptyObject)(r))return}(n||(delete c[l].data,s(c[l])))&&(a?st.cleanData([t],!0):st.support.deleteExpando||c!=c.window?delete c[l]:c[l]=null)}}}function a(t,n,r){if(r===e&&1===t.nodeType){var i="data-"+n.replace(Et,"-$1").toLowerCase();if(r=t.getAttribute(i),"string"==typeof r){try{r="true"===r||"false"!==r&&("null"===r?null:+r+""===r?+r:wt.test(r)?st.parseJSON(r):r)}catch(t){}st.data(t,n,r)}else r=e}return r}function s(t){var e;for(e in t)if(("data"!==e||!st.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function c(){return!0}function l(){return!1}function u(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function h(t,e,n){if(e=e||0,st.isFunction(e))return st.grep(t,function(t,r){var i=!!e.call(t,r,t);return i===n});if(e.nodeType)return st.grep(t,function(t){return t===e===n});if("string"==typeof e){var r=st.grep(t,function(t){return 1===t.nodeType});if(jt.test(e))return st.filter(e,r,!n);e=st.filter(e,r)}return st.grep(t,function(t){return st.inArray(t,e)>=0===n})}function d(t){var e=Vt.split("|"),n=t.createDocumentFragment();if(n.createElement)for(;e.length;)n.createElement(e.pop());return n}function p(t,e){return t.getElementsByTagName(e)[0]||t.appendChild(t.ownerDocument.createElement(e))}function f(t){var e=t.getAttributeNode("type");return t.type=(e&&e.specified)+"/"+t.type,t}function m(t){var e=ne.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function g(t,e){for(var n,r=0;null!=(n=t[r]);r++)st._data(n,"globalEval",!e||st._data(e[r],"globalEval"))}function v(t,e){if(1===e.nodeType&&st.hasData(t)){var n,r,i,o=st._data(t),a=st._data(e,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)st.event.add(e,n,s[n][r])}a.data&&(a.data=st.extend({},a.data))}}function y(t,e){var n,r,i;if(1===e.nodeType){if(n=e.nodeName.toLowerCase(),!st.support.noCloneEvent&&e[st.expando]){r=st._data(e);for(i in r.events)st.removeEvent(e,i,r.handle);e.removeAttribute(st.expando)}"script"===n&&e.text!==t.text?(f(e).text=t.text,m(e)):"object"===n?(e.parentNode&&(e.outerHTML=t.outerHTML),st.support.html5Clone&&t.innerHTML&&!st.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===n&&Kt.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}}function _(t,n){var r,i,o=0,a=t.getElementsByTagName!==e?t.getElementsByTagName(n||"*"):t.querySelectorAll!==e?t.querySelectorAll(n||"*"):e;if(!a)for(a=[],r=t.childNodes||t;null!=(i=r[o]);o++)!n||st.nodeName(i,n)?a.push(i):st.merge(a,_(i,n));return n===e||n&&st.nodeName(t,n)?st.merge([t],a):a}function b(t){Kt.test(t.type)&&(t.defaultChecked=t.checked)}function x(t,e){if(e in t)return e;for(var n=e.charAt(0).toUpperCase()+e.slice(1),r=e,i=we.length;i--;)if(e=we[i]+n,e in t)return e;return r}function w(t,e){return t=e||t,"none"===st.css(t,"display")||!st.contains(t.ownerDocument,t)}function E(t,e){for(var n,r=[],i=0,o=t.length;o>i;i++)n=t[i],n.style&&(r[i]=st._data(n,"olddisplay"),e?(r[i]||"none"!==n.style.display||(n.style.display=""),""===n.style.display&&w(n)&&(r[i]=st._data(n,"olddisplay",A(n.nodeName)))):r[i]||w(n)||st._data(n,"olddisplay",st.css(n,"display")));for(i=0;o>i;i++)n=t[i],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[i]||"":"none"));return t}function M(t,e,n){var r=me.exec(e);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):e}function T(t,e,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=st.css(t,n+xe[o],!0,i)),r?("content"===n&&(a-=st.css(t,"padding"+xe[o],!0,i)),"margin"!==n&&(a-=st.css(t,"border"+xe[o]+"Width",!0,i))):(a+=st.css(t,"padding"+xe[o],!0,i),"padding"!==n&&(a+=st.css(t,"border"+xe[o]+"Width",!0,i)));return a}function S(t,e,n){var r=!0,i="width"===e?t.offsetWidth:t.offsetHeight,o=ce(t),a=st.support.boxSizing&&"border-box"===st.css(t,"boxSizing",!1,o);if(0>=i||null==i){if(i=se(t,e,o),(0>i||null==i)&&(i=t.style[e]),ge.test(i))return i;r=a&&(st.support.boxSizingReliable||i===t.style[e]),i=parseFloat(i)||0}return i+T(t,e,n||(a?"border":"content"),r,o)+"px"}function A(t){var e=X,n=ye[t];return n||(n=L(t,e),"none"!==n&&n||(le=(le||st("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(le[0].contentWindow||le[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),n=L(t,e),le.detach()),ye[t]=n),n}function L(t,e){var n=st(e.createElement(t)).appendTo(e.body),r=st.css(n[0],"display");return n.remove(),r}function R(t,e,n,r){var i;if(st.isArray(e))st.each(e,function(e,i){n||Me.test(t)?r(t,i):R(t+"["+("object"==typeof i?e:"")+"]",i,n,r)});else if(n||"object"!==st.type(e))r(t,e);else for(i in e)R(t+"["+i+"]",e[i],n,r)}function C(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,o=e.toLowerCase().match(lt)||[];if(st.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function P(t,n,r,i){function o(c){var l;return a[c]=!0,st.each(t[c]||[],function(t,c){var u=c(n,r,i);return"string"!=typeof u||s||a[u]?s?!(l=u):e:(n.dataTypes.unshift(u),o(u),!1)}),l}var a={},s=t===je;return o(n.dataTypes[0])||!a["*"]&&o("*")}function O(t,n){var r,i,o=st.ajaxSettings.flatOptions||{};for(r in n)n[r]!==e&&((o[r]?t:i||(i={}))[r]=n[r]);return i&&st.extend(!0,t,i),t}function N(t,n,r){var i,o,a,s,c=t.contents,l=t.dataTypes,u=t.responseFields;for(o in u)o in r&&(n[u[o]]=r[o]);for(;"*"===l[0];)l.shift(),i===e&&(i=t.mimeType||n.getResponseHeader("Content-Type"));if(i)for(o in c)if(c[o]&&c[o].test(i)){l.unshift(o);break}if(l[0]in r)a=l[0];else{for(o in r){if(!l[0]||t.converters[o+" "+l[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==l[0]&&l.unshift(a),r[a]):e}function I(t,e){var n,r,i,o,a={},s=0,c=t.dataTypes.slice(),l=c[0];if(t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c[1])for(n in t.converters)a[n.toLowerCase()]=t.converters[n];for(;i=c[++s];)if("*"!==i){if("*"!==l&&l!==i){if(n=a[l+" "+i]||a["* "+i],!n)for(r in a)if(o=r.split(" "),o[1]===i&&(n=a[l+" "+o[0]]||a["* "+o[0]])){n===!0?n=a[r]:a[r]!==!0&&(i=o[0],c.splice(s--,0,i));break}if(n!==!0)if(n&&t.throws)e=n(e);else try{e=n(e)}catch(t){return{state:"parsererror",error:n?t:"No conversion from "+l+" to "+i}}}l=i}return{state:"success",data:e}}function D(){try{return new t.XMLHttpRequest}catch(t){}}function U(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function F(){return setTimeout(function(){Ze=e}),Ze=st.now()}function B(t,e){st.each(e,function(e,n){for(var r=(en[e]||[]).concat(en["*"]),i=0,o=r.length;o>i;i++)if(r[i].call(t,e,n))return})}function z(t,e,n){var r,i,o=0,a=tn.length,s=st.Deferred().always(function(){delete c.elem}),c=function(){if(i)return!1;for(var e=Ze||F(),n=Math.max(0,l.startTime+l.duration-e),r=n/l.duration||0,o=1-r,a=0,c=l.tweens.length;c>a;a++)l.tweens[a].run(o);return s.notifyWith(t,[l,o,n]),1>o&&c?n:(s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:st.extend({},e),opts:st.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:Ze||F(),duration:n.duration,tweens:[],createTween:function(e,n){var r=st.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(r),r},stop:function(e){var n=0,r=e?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return e?s.resolveWith(t,[l,e]):s.rejectWith(t,[l,e]),this}}),u=l.props;for(k(u,l.opts.specialEasing);a>o;o++)if(r=tn[o].call(l,t,u,l.opts))return r;return B(l,u),st.isFunction(l.opts.start)&&l.opts.start.call(t,l),st.fx.timer(st.extend(c,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function k(t,e){var n,r,i,o,a;for(n in t)if(r=st.camelCase(n),i=e[r],o=t[n],st.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),a=st.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete t[r];for(n in o)n in t||(t[n]=o[n],e[n]=i)}else e[r]=i}function j(t,e,n){var r,i,o,a,s,c,l,u,h,d=this,p=t.style,f={},m=[],g=t.nodeType&&w(t);n.queue||(u=st._queueHooks(t,"fx"),null==u.unqueued&&(u.unqueued=0,h=u.empty.fire,u.empty.fire=function(){u.unqueued||h()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,st.queue(t,"fx").length||u.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===st.css(t,"display")&&"none"===st.css(t,"float")&&(st.support.inlineBlockNeedsLayout&&"inline"!==A(t.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",st.support.shrinkWrapBlocks||d.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in e)if(o=e[r],$e.exec(o)){if(delete e[r],c=c||"toggle"===o,o===(g?"hide":"show"))continue;m.push(r)}if(a=m.length){s=st._data(t,"fxshow")||st._data(t,"fxshow",{}),"hidden"in s&&(g=s.hidden),c&&(s.hidden=!g),g?st(t).show():d.done(function(){st(t).hide()}),d.done(function(){var e;st._removeData(t,"fxshow");for(e in f)st.style(t,e,f[e])});for(r=0;a>r;r++)i=m[r],l=d.createTween(i,g?s[i]:0),f[i]=s[i]||st.style(t,i),i in s||(s[i]=l.start,g&&(l.end=l.start,l.start="width"===i||"height"===i?1:0))}}function $(t,e,n,r,i){return new $.prototype.init(t,e,n,r,i)}function H(t,e){var n,r={height:t},i=0;for(e=e?1:0;4>i;i+=2-e)n=xe[i],r["margin"+n]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function G(t){return st.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}var V,W,X=t.document,q=t.location,Y=t.jQuery,Z=t.$,J={},Q=[],K="1.9.0",tt=Q.concat,et=Q.push,nt=Q.slice,rt=Q.indexOf,it=J.toString,ot=J.hasOwnProperty,at=K.trim,st=function(t,e){return new st.fn.init(t,e,V)},ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,lt=/\S+/g,ut=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ht=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,dt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,pt=/^[\],:{}\s]*$/,ft=/(?:^|:|,)(?:\s*\[)+/g,mt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,gt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,vt=/^-ms-/,yt=/-([\da-z])/gi,_t=function(t,e){return e.toUpperCase()},bt=function(){X.addEventListener?(X.removeEventListener("DOMContentLoaded",bt,!1),st.ready()):"complete"===X.readyState&&(X.detachEvent("onreadystatechange",bt),st.ready())};st.fn=st.prototype={jquery:K,constructor:st,init:function(t,n,r){var i,o;if(!t)return this;if("string"==typeof t){if(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:ht.exec(t),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(t):this.constructor(n).find(t);if(i[1]){if(n=n instanceof st?n[0]:n,st.merge(this,st.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:X,!0)),dt.test(i[1])&&st.isPlainObject(n))for(i in n)st.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(o=X.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(t);this.length=1,this[0]=o}return this.context=X,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):st.isFunction(t)?r.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),st.makeArray(t,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return nt.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=st.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return st.each(this,t,e)},ready:function(t){return st.ready.promise().done(t),this},slice:function(){return this.pushStack(nt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},map:function(t){return this.pushStack(st.map(this,function(e,n){return t.call(e,n,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:et,sort:[].sort,splice:[].splice},st.fn.init.prototype=st.fn,st.extend=st.fn.extend=function(){var t,n,r,i,o,a,s=arguments[0]||{},c=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},c=2),"object"==typeof s||st.isFunction(s)||(s={}),l===c&&(s=this,--c);l>c;c++)if(null!=(t=arguments[c]))for(n in t)r=s[n],i=t[n],s!==i&&(u&&i&&(st.isPlainObject(i)||(o=st.isArray(i)))?(o?(o=!1,a=r&&st.isArray(r)?r:[]):a=r&&st.isPlainObject(r)?r:{},s[n]=st.extend(u,a,i)):i!==e&&(s[n]=i));return s},st.extend({noConflict:function(e){return t.$===st&&(t.$=Z),e&&t.jQuery===st&&(t.jQuery=Y),st},isReady:!1,readyWait:1,holdReady:function(t){t?st.readyWait++:st.ready(!0)},ready:function(t){if(t===!0?!--st.readyWait:!st.isReady){if(!X.body)return setTimeout(st.ready);st.isReady=!0,t!==!0&&--st.readyWait>0||(W.resolveWith(X,[st]),st.fn.trigger&&st(X).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===st.type(t)},isArray:Array.isArray||function(t){return"array"===st.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?J[it.call(t)]||"object":typeof t},isPlainObject:function(t){if(!t||"object"!==st.type(t)||t.nodeType||st.isWindow(t))return!1;try{if(t.constructor&&!ot.call(t,"constructor")&&!ot.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var n;for(n in t);return n===e||ot.call(t,n)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw Error(t)},parseHTML:function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||X;var r=dt.exec(t),i=!n&&[];return r?[e.createElement(r[1])]:(r=st.buildFragment([t],e,i),i&&st(i).remove(),st.merge([],r.childNodes))},parseJSON:function(n){return t.JSON&&t.JSON.parse?t.JSON.parse(n):null===n?n:"string"==typeof n&&(n=st.trim(n),n&&pt.test(n.replace(mt,"@").replace(gt,"]").replace(ft,"")))?Function("return "+n)():(st.error("Invalid JSON: "+n),e)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{t.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(t){r=e}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||st.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(e){e&&st.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(vt,"ms-").replace(yt,_t)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,r){var i,o=0,a=t.length,s=n(t);if(r){if(s)for(;a>o&&(i=e.apply(t[o],r),i!==!1);o++);else for(o in t)if(i=e.apply(t[o],r),i===!1)break}else if(s)for(;a>o&&(i=e.call(t[o],o,t[o]),i!==!1);o++);else for(o in t)if(i=e.call(t[o],o,t[o]),i===!1)break;return t},trim:at&&!at.call("\ufeffÂ ")?function(t){return null==t?"":at.call(t)}:function(t){return null==t?"":(t+"").replace(ut,"")},makeArray:function(t,e){var r=e||[];return null!=t&&(n(Object(t))?st.merge(r,"string"==typeof t?[t]:t):et.call(r,t)),r},inArray:function(t,e,n){var r;if(e){if(rt)return rt.call(e,t,n);for(r=e.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in e&&e[n]===t)return n}return-1},merge:function(t,n){var r=n.length,i=t.length,o=0;if("number"==typeof r)for(;r>o;o++)t[i++]=n[o];else for(;n[o]!==e;)t[i++]=n[o++];return t.length=i,t},grep:function(t,e,n){var r,i=[],o=0,a=t.length;for(n=!!n;a>o;o++)r=!!e(t[o],o),n!==r&&i.push(t[o]);return i},map:function(t,e,r){var i,o=0,a=t.length,s=n(t),c=[];if(s)for(;a>o;o++)i=e(t[o],o,r),null!=i&&(c[c.length]=i);else for(o in t)i=e(t[o],o,r),null!=i&&(c[c.length]=i);return tt.apply([],c)},guid:1,proxy:function(t,n){var r,i,o;return"string"==typeof n&&(r=t[n],n=t,t=r),st.isFunction(t)?(i=nt.call(arguments,2),o=function(){return t.apply(n||this,i.concat(nt.call(arguments)))},o.guid=t.guid=t.guid||st.guid++,o):e},access:function(t,n,r,i,o,a,s){var c=0,l=t.length,u=null==r;if("object"===st.type(r)){o=!0;for(c in r)st.access(t,n,c,r[c],!0,a,s)}else if(i!==e&&(o=!0,st.isFunction(i)||(s=!0),u&&(s?(n.call(t,i),n=null):(u=n,n=function(t,e,n){return u.call(st(t),n)})),n))for(;l>c;c++)n(t[c],r,s?i:i.call(t[c],c,n(t[c],r)));return o?t:u?n.call(t):l?n(t[0],r):a},now:function(){return(new Date).getTime()}}),st.ready.promise=function(e){if(!W)if(W=st.Deferred(),"complete"===X.readyState)setTimeout(st.ready);else if(X.addEventListener)X.addEventListener("DOMContentLoaded",bt,!1),t.addEventListener("load",st.ready,!1);else{X.attachEvent("onreadystatechange",bt),t.attachEvent("onload",st.ready);var n=!1;try{n=null==t.frameElement&&X.documentElement}catch(t){}n&&n.doScroll&&function t(){if(!st.isReady){try{n.doScroll("left")}catch(e){return setTimeout(t,50)}st.ready()}}()}return W.promise(e)},st.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){J["[object "+e+"]"]=e.toLowerCase()}),V=st(X);var xt={};st.Callbacks=function(t){t="string"==typeof t?xt[t]||r(t):st.extend({},t);var n,i,o,a,s,c,l=[],u=!t.once&&[],h=function(e){for(n=t.memory&&e,i=!0,c=a||0,a=0,s=l.length,o=!0;l&&s>c;c++)if(l[c].apply(e[0],e[1])===!1&&t.stopOnFalse){n=!1;break}o=!1,l&&(u?u.length&&h(u.shift()):n?l=[]:d.disable())},d={add:function(){if(l){var e=l.length;!function e(n){st.each(n,function(n,r){var i=st.type(r);"function"===i?t.unique&&d.has(r)||l.push(r):r&&r.length&&"string"!==i&&e(r)})}(arguments),o?s=l.length:n&&(a=e,h(n))}return this},remove:function(){return l&&st.each(arguments,function(t,e){for(var n;(n=st.inArray(e,l,n))>-1;)l.splice(n,1),o&&(s>=n&&s--,c>=n&&c--)}),this},has:function(t){return st.inArray(t,l)>-1},empty:function(){return l=[],this},disable:function(){
return l=u=n=e,this},disabled:function(){return!l},lock:function(){return u=e,n||d.disable(),this},locked:function(){return!u},fireWith:function(t,e){return e=e||[],e=[t,e.slice?e.slice():e],!l||i&&!u||(o?u.push(e):h(e)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d},st.extend({Deferred:function(t){var e=[["resolve","done",st.Callbacks("once memory"),"resolved"],["reject","fail",st.Callbacks("once memory"),"rejected"],["notify","progress",st.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var t=arguments;return st.Deferred(function(n){st.each(e,function(e,o){var a=o[0],s=st.isFunction(t[e])&&t[e];i[o[1]](function(){var t=s&&s.apply(this,arguments);t&&st.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?st.extend(t,r):r}},i={};return r.pipe=r.then,st.each(e,function(t,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},e[1^t][2].disable,e[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),t&&t.call(i,i),i},when:function(t){var e,n,r,i=0,o=nt.call(arguments),a=o.length,s=1!==a||t&&st.isFunction(t.promise)?a:0,c=1===s?t:st.Deferred(),l=function(t,n,r){return function(i){n[t]=this,r[t]=arguments.length>1?nt.call(arguments):i,r===e?c.notifyWith(n,r):--s||c.resolveWith(n,r)}};if(a>1)for(e=Array(a),n=Array(a),r=Array(a);a>i;i++)o[i]&&st.isFunction(o[i].promise)?o[i].promise().done(l(i,r,o)).fail(c.reject).progress(l(i,n,e)):--s;return s||c.resolveWith(r,o),c.promise()}}),st.support=function(){var n,r,i,o,a,s,c,l,u,h,d=X.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=d.getElementsByTagName("*"),i=d.getElementsByTagName("a")[0],!r||!i||!r.length)return{};o=X.createElement("select"),a=o.appendChild(X.createElement("option")),s=d.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",n={getSetAttribute:"t"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.5/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:!!s.value,optSelected:a.selected,enctype:!!X.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==X.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===X.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},s.checked=!0,n.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,n.optDisabled=!a.disabled;try{delete d.test}catch(t){n.deleteExpando=!1}s=X.createElement("input"),s.setAttribute("value",""),n.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),n.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),c=X.createDocumentFragment(),c.appendChild(s),n.appendChecked=s.checked,n.checkClone=c.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){n.noCloneEvent=!1}),d.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})d.setAttribute(l="on"+h,"t"),n[h+"Bubbles"]=l in t||d.attributes[l].expando===!1;return d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",n.clearCloneStyle="content-box"===d.style.backgroundClip,st(function(){var r,i,o,a="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",s=X.getElementsByTagName("body")[0];s&&(r=X.createElement("div"),r.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(r).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=d.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",u=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",n.reliableHiddenOffsets=u&&0===o[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",n.boxSizing=4===d.offsetWidth,n.doesNotIncludeMarginInBodyOffset=1!==s.offsetTop,t.getComputedStyle&&(n.pixelPosition="1%"!==(t.getComputedStyle(d,null)||{}).top,n.boxSizingReliable="4px"===(t.getComputedStyle(d,null)||{width:"4px"}).width,i=d.appendChild(X.createElement("div")),i.style.cssText=d.style.cssText=a,i.style.marginRight=i.style.width="0",d.style.width="1px",n.reliableMarginRight=!parseFloat((t.getComputedStyle(i,null)||{}).marginRight)),d.style.zoom!==e&&(d.innerHTML="",d.style.cssText=a+"width:1px;padding:1px;display:inline;zoom:1",n.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",n.shrinkWrapBlocks=3!==d.offsetWidth,s.style.zoom=1),s.removeChild(r),r=d=o=i=null)}),r=o=c=a=i=s=null,n}();var wt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Et=/([A-Z])/g;st.extend({cache:{},expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?st.cache[t[st.expando]]:t[st.expando],!!t&&!s(t)},data:function(t,e,n){return i(t,e,n,!1)},removeData:function(t,e){return o(t,e,!1)},_data:function(t,e,n){return i(t,e,n,!0)},_removeData:function(t,e){return o(t,e,!0)},acceptData:function(t){var e=t.nodeName&&st.noData[t.nodeName.toLowerCase()];return!e||e!==!0&&t.getAttribute("classid")===e}}),st.fn.extend({data:function(t,n){var r,i,o=this[0],s=0,c=null;if(t===e){if(this.length&&(c=st.data(o),1===o.nodeType&&!st._data(o,"parsedAttrs"))){for(r=o.attributes;r.length>s;s++)i=r[s].name,i.indexOf("data-")||(i=st.camelCase(i.substring(5)),a(o,i,c[i]));st._data(o,"parsedAttrs",!0)}return c}return"object"==typeof t?this.each(function(){st.data(this,t)}):st.access(this,function(n){return n===e?o?a(o,t,st.data(o,t)):null:(this.each(function(){st.data(this,t,n)}),e)},null,n,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){st.removeData(this,t)})}}),st.extend({queue:function(t,n,r){var i;return t?(n=(n||"fx")+"queue",i=st._data(t,n),r&&(!i||st.isArray(r)?i=st._data(t,n,st.makeArray(r)):i.push(r)),i||[]):e},dequeue:function(t,e){e=e||"fx";var n=st.queue(t,e),r=n.length,i=n.shift(),o=st._queueHooks(t,e),a=function(){st.dequeue(t,e)};"inprogress"===i&&(i=n.shift(),r--),o.cur=i,i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return st._data(t,n)||st._data(t,n,{empty:st.Callbacks("once memory").add(function(){st._removeData(t,e+"queue"),st._removeData(t,n)})})}}),st.fn.extend({queue:function(t,n){var r=2;return"string"!=typeof t&&(n=t,t="fx",r--),r>arguments.length?st.queue(this[0],t):n===e?this:this.each(function(){var e=st.queue(this,t,n);st._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&st.dequeue(this,t)})},dequeue:function(t){return this.each(function(){st.dequeue(this,t)})},delay:function(t,e){return t=st.fx?st.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var r=setTimeout(e,t);n.stop=function(){clearTimeout(r)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,n){var r,i=1,o=st.Deferred(),a=this,s=this.length,c=function(){--i||o.resolveWith(a,[a])};for("string"!=typeof t&&(n=t,t=e),t=t||"fx";s--;)r=st._data(a[s],t+"queueHooks"),r&&r.empty&&(i++,r.empty.add(c));return c(),o.promise(n)}});var Mt,Tt,St=/[\t\r\n]/g,At=/\r/g,Lt=/^(?:input|select|textarea|button|object)$/i,Rt=/^(?:a|area)$/i,Ct=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Pt=/^(?:checked|selected)$/i,Ot=st.support.getSetAttribute,Nt=st.support.input;st.fn.extend({attr:function(t,e){return st.access(this,st.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){st.removeAttr(this,t)})},prop:function(t,e){return st.access(this,st.prop,t,e,arguments.length>1)},removeProp:function(t){return t=st.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(t){}})},addClass:function(t){var e,n,r,i,o,a=0,s=this.length,c="string"==typeof t&&t;if(st.isFunction(t))return this.each(function(e){st(this).addClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(lt)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(St," "):" ")){for(o=0;i=e[o++];)0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=st.trim(r)}return this},removeClass:function(t){var e,n,r,i,o,a=0,s=this.length,c=0===arguments.length||"string"==typeof t&&t;if(st.isFunction(t))return this.each(function(e){st(this).removeClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(lt)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(St," "):"")){for(o=0;i=e[o++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");n.className=t?st.trim(r):""}return this},toggleClass:function(t,e){var n=typeof t,r="boolean"==typeof e;return st.isFunction(t)?this.each(function(n){st(this).toggleClass(t.call(this,n,this.className,e),e)}):this.each(function(){if("string"===n)for(var i,o=0,a=st(this),s=e,c=t.match(lt)||[];i=c[o++];)s=r?s:!a.hasClass(i),a[s?"addClass":"removeClass"](i);else("undefined"===n||"boolean"===n)&&(this.className&&st._data(this,"__className__",this.className),this.className=this.className||t===!1?"":st._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(St," ").indexOf(e)>=0)return!0;return!1},val:function(t){var n,r,i,o=this[0];return arguments.length?(i=st.isFunction(t),this.each(function(r){var o,a=st(this);1===this.nodeType&&(o=i?t.call(this,r,a.val()):t,null==o?o="":"number"==typeof o?o+="":st.isArray(o)&&(o=st.map(o,function(t){return null==t?"":t+""})),n=st.valHooks[this.type]||st.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==e||(this.value=o))})):o?(n=st.valHooks[o.type]||st.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(o,"value"))!==e?r:(r=o.value,"string"==typeof r?r.replace(At,""):null==r?"":r)):void 0}}),st.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){for(var e,n,r=t.options,i=t.selectedIndex,o="select-one"===t.type||0>i,a=o?null:[],s=o?i+1:r.length,c=0>i?s:o?i:0;s>c;c++)if(n=r[c],!(!n.selected&&c!==i||(st.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&st.nodeName(n.parentNode,"optgroup"))){if(e=st(n).val(),o)return e;a.push(e)}return a},set:function(t,e){var n=st.makeArray(e);return st(t).find("option").each(function(){this.selected=st.inArray(st(this).val(),n)>=0}),n.length||(t.selectedIndex=-1),n}}},attr:function(t,n,r){var i,o,a,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return t.getAttribute===e?st.prop(t,n,r):(a=1!==s||!st.isXMLDoc(t),a&&(n=n.toLowerCase(),o=st.attrHooks[n]||(Ct.test(n)?Tt:Mt)),r===e?o&&a&&"get"in o&&null!==(i=o.get(t,n))?i:(t.getAttribute!==e&&(i=t.getAttribute(n)),null==i?e:i):null!==r?o&&a&&"set"in o&&(i=o.set(t,r,n))!==e?i:(t.setAttribute(n,r+""),r):(st.removeAttr(t,n),e))},removeAttr:function(t,e){var n,r,i=0,o=e&&e.match(lt);if(o&&1===t.nodeType)for(;n=o[i++];)r=st.propFix[n]||n,Ct.test(n)?!Ot&&Pt.test(n)?t[st.camelCase("default-"+n)]=t[r]=!1:t[r]=!1:st.attr(t,n,""),t.removeAttribute(Ot?n:r)},attrHooks:{type:{set:function(t,e){if(!st.support.radioValue&&"radio"===e&&st.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(t,n,r){var i,o,a,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return a=1!==s||!st.isXMLDoc(t),a&&(n=st.propFix[n]||n,o=st.propHooks[n]),r!==e?o&&"set"in o&&(i=o.set(t,r,n))!==e?i:t[n]=r:o&&"get"in o&&null!==(i=o.get(t,n))?i:t[n]},propHooks:{tabIndex:{get:function(t){var n=t.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):Lt.test(t.nodeName)||Rt.test(t.nodeName)&&t.href?0:e}}}}),Tt={get:function(t,n){var r=st.prop(t,n),i="boolean"==typeof r&&t.getAttribute(n),o="boolean"==typeof r?Nt&&Ot?null!=i:Pt.test(n)?t[st.camelCase("default-"+n)]:!!i:t.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():e},set:function(t,e,n){return e===!1?st.removeAttr(t,n):Nt&&Ot||!Pt.test(n)?t.setAttribute(!Ot&&st.propFix[n]||n,n):t[st.camelCase("default-"+n)]=t[n]=!0,n}},Nt&&Ot||(st.attrHooks.value={get:function(t,n){var r=t.getAttributeNode(n);return st.nodeName(t,"input")?t.defaultValue:r&&r.specified?r.value:e},set:function(t,n,r){return st.nodeName(t,"input")?(t.defaultValue=n,e):Mt&&Mt.set(t,n,r)}}),Ot||(Mt=st.valHooks.button={get:function(t,n){var r=t.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:e},set:function(t,n,r){var i=t.getAttributeNode(r);return i||t.setAttributeNode(i=t.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===t.getAttribute(r)?n:e}},st.attrHooks.contenteditable={get:Mt.get,set:function(t,e,n){Mt.set(t,""!==e&&e,n)}},st.each(["width","height"],function(t,n){st.attrHooks[n]=st.extend(st.attrHooks[n],{set:function(t,r){return""===r?(t.setAttribute(n,"auto"),r):e}})})),st.support.hrefNormalized||(st.each(["href","src","width","height"],function(t,n){st.attrHooks[n]=st.extend(st.attrHooks[n],{get:function(t){var r=t.getAttribute(n,2);return null==r?e:r}})}),st.each(["href","src"],function(t,e){st.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}})),st.support.style||(st.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),st.support.optSelected||(st.propHooks.selected=st.extend(st.propHooks.selected,{get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}})),st.support.enctype||(st.propFix.enctype="encoding"),st.support.checkOn||st.each(["radio","checkbox"],function(){st.valHooks[this]={get:function(t){return null===t.getAttribute("value")?"on":t.value}}}),st.each(["radio","checkbox"],function(){st.valHooks[this]=st.extend(st.valHooks[this],{set:function(t,n){return st.isArray(n)?t.checked=st.inArray(st(t).val(),n)>=0:e}})});var It=/^(?:input|select|textarea)$/i,Dt=/^key/,Ut=/^(?:mouse|contextmenu)|click/,Ft=/^(?:focusinfocus|focusoutblur)$/,Bt=/^([^.]*)(?:\.(.+)|)$/;st.event={global:{},add:function(t,n,r,i,o){var a,s,c,l,u,h,d,p,f,m,g,v=3!==t.nodeType&&8!==t.nodeType&&st._data(t);if(v){for(r.handler&&(a=r,r=a.handler,o=a.selector),r.guid||(r.guid=st.guid++),(l=v.events)||(l=v.events={}),(s=v.handle)||(s=v.handle=function(t){return st===e||t&&st.event.triggered===t.type?e:st.event.dispatch.apply(s.elem,arguments)},s.elem=t),n=(n||"").match(lt)||[""],u=n.length;u--;)c=Bt.exec(n[u])||[],f=g=c[1],m=(c[2]||"").split(".").sort(),d=st.event.special[f]||{},f=(o?d.delegateType:d.bindType)||f,d=st.event.special[f]||{},h=st.extend({type:f,origType:g,data:i,handler:r,guid:r.guid,selector:o,needsContext:o&&st.expr.match.needsContext.test(o),namespace:m.join(".")},a),(p=l[f])||(p=l[f]=[],p.delegateCount=0,d.setup&&d.setup.call(t,i,m,s)!==!1||(t.addEventListener?t.addEventListener(f,s,!1):t.attachEvent&&t.attachEvent("on"+f,s))),d.add&&(d.add.call(t,h),h.handler.guid||(h.handler.guid=r.guid)),o?p.splice(p.delegateCount++,0,h):p.push(h),st.event.global[f]=!0;t=null}},remove:function(t,e,n,r,i){var o,a,s,c,l,u,h,d,p,f,m,g=st.hasData(t)&&st._data(t);if(g&&(c=g.events)){for(e=(e||"").match(lt)||[""],l=e.length;l--;)if(s=Bt.exec(e[l])||[],p=m=s[1],f=(s[2]||"").split(".").sort(),p){for(h=st.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,d=c[p]||[],s=s[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)u=d[o],!i&&m!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||r&&r!==u.selector&&("**"!==r||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));a&&!d.length&&(h.teardown&&h.teardown.call(t,f,g.handle)!==!1||st.removeEvent(t,p,g.handle),delete c[p])}else for(p in c)st.event.remove(t,p+e[l],n,r,!0);st.isEmptyObject(c)&&(delete g.handle,st._removeData(t,"events"))}},trigger:function(n,r,i,o){var a,s,c,l,u,h,d,p=[i||X],f=n.type||n,m=n.namespace?n.namespace.split("."):[];if(s=c=i=i||X,3!==i.nodeType&&8!==i.nodeType&&!Ft.test(f+st.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),u=0>f.indexOf(":")&&"on"+f,n=n[st.expando]?n:new st.Event(f,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=e,n.target||(n.target=i),r=null==r?[n]:st.makeArray(r,[n]),d=st.event.special[f]||{},o||!d.trigger||d.trigger.apply(i,r)!==!1)){if(!o&&!d.noBubble&&!st.isWindow(i)){for(l=d.delegateType||f,Ft.test(l+f)||(s=s.parentNode);s;s=s.parentNode)p.push(s),c=s;c===(i.ownerDocument||X)&&p.push(c.defaultView||c.parentWindow||t)}for(a=0;(s=p[a++])&&!n.isPropagationStopped();)n.type=a>1?l:d.bindType||f,h=(st._data(s,"events")||{})[n.type]&&st._data(s,"handle"),h&&h.apply(s,r),h=u&&s[u],h&&st.acceptData(s)&&h.apply&&h.apply(s,r)===!1&&n.preventDefault();if(n.type=f,!(o||n.isDefaultPrevented()||d._default&&d._default.apply(i.ownerDocument,r)!==!1||"click"===f&&st.nodeName(i,"a")||!st.acceptData(i)||!u||!i[f]||st.isWindow(i))){c=i[u],c&&(i[u]=null),st.event.triggered=f;try{i[f]()}catch(t){}st.event.triggered=e,c&&(i[u]=c)}return n.result}},dispatch:function(t){t=st.event.fix(t);var n,r,i,o,a,s=[],c=nt.call(arguments),l=(st._data(this,"events")||{})[t.type]||[],u=st.event.special[t.type]||{};if(c[0]=t,t.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,t)!==!1){for(s=st.event.handlers.call(this,t,l),n=0;(o=s[n++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,r=0;(a=o.handlers[r++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(a.namespace))&&(t.handleObj=a,t.data=a.data,i=((st.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,c),i!==e&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,n){var r,i,o,a,s=[],c=n.delegateCount,l=t.target;if(c&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!=this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==t.type){for(i=[],r=0;c>r;r++)a=n[r],o=a.selector+" ",i[o]===e&&(i[o]=a.needsContext?st(o,this).index(l)>=0:st.find(o,this,null,[l]).length),i[o]&&i.push(a);i.length&&s.push({elem:l,handlers:i})}return n.length>c&&s.push({elem:this,handlers:n.slice(c)}),s},fix:function(t){if(t[st.expando])return t;var e,n,r=t,i=st.event.fixHooks[t.type]||{},o=i.props?this.props.concat(i.props):this.props;for(t=new st.Event(r),e=o.length;e--;)n=o[e],t[n]=r[n];return t.target||(t.target=r.srcElement||X),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,i.filter?i.filter(t,r):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,n){var r,i,o,a=n.button,s=n.fromElement;return null==t.pageX&&null!=n.clientX&&(r=t.target.ownerDocument||X,i=r.documentElement,o=r.body,t.pageX=n.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),t.pageY=n.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),!t.relatedTarget&&s&&(t.relatedTarget=s===t.target?n.toElement:s),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},special:{load:{noBubble:!0},click:{trigger:function(){return st.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):e}},focus:{trigger:function(){if(this!==X.activeElement&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===X.activeElement&&this.blur?(this.blur(),!1):e},delegateType:"focusout"},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,r){var i=st.extend(new st.Event,n,{type:t,isSimulated:!0,originalEvent:{}});r?st.event.trigger(i,null,e):st.event.dispatch.call(e,i),i.isDefaultPrevented()&&n.preventDefault()}},st.removeEvent=X.removeEventListener?function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)}:function(t,n,r){var i="on"+n;t.detachEvent&&(t[i]===e&&(t[i]=null),t.detachEvent(i,r))},st.Event=function(t,n){return this instanceof st.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?c:l):this.type=t,n&&st.extend(this,n),this.timeStamp=t&&t.timeStamp||st.now(),this[st.expando]=!0,e):new st.Event(t,n)},st.Event.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=c,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=c,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=c,this.stopPropagation()}},st.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){st.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=this,i=t.relatedTarget,o=t.handleObj;return(!i||i!==r&&!st.contains(r,i))&&(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),st.support.submitBubbles||(st.event.special.submit={setup:function(){return!st.nodeName(this,"form")&&(st.event.add(this,"click._submit keypress._submit",function(t){var n=t.target,r=st.nodeName(n,"input")||st.nodeName(n,"button")?n.form:e;r&&!st._data(r,"submitBubbles")&&(st.event.add(r,"submit._submit",function(t){t._submit_bubble=!0}),st._data(r,"submitBubbles",!0))}),e)},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&st.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return!st.nodeName(this,"form")&&(st.event.remove(this,"._submit"),e)}}),st.support.changeBubbles||(st.event.special.change={setup:function(){return It.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(st.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),st.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),st.event.simulate("change",this,t,!0)})),!1):(st.event.add(this,"beforeactivate._change",function(t){var e=t.target;It.test(e.nodeName)&&!st._data(e,"changeBubbles")&&(st.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||st.event.simulate("change",this.parentNode,t,!0)}),st._data(e,"changeBubbles",!0))}),e)},handle:function(t){var n=t.target;return this!==n||t.isSimulated||t.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?t.handleObj.handler.apply(this,arguments):e},teardown:function(){return st.event.remove(this,"._change"),!It.test(this.nodeName)}}),st.support.focusinBubbles||st.each({focus:"focusin",blur:"focusout"},function(t,e){var n=0,r=function(t){st.event.simulate(e,t.target,st.event.fix(t),!0)};st.event.special[e]={setup:function(){0===n++&&X.addEventListener(t,r,!0)},teardown:function(){0===--n&&X.removeEventListener(t,r,!0)}}}),st.fn.extend({on:function(t,n,r,i,o){var a,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=e);for(s in t)this.on(s,n,r,t[s],o);return this}if(null==r&&null==i?(i=n,r=n=e):null==i&&("string"==typeof n?(i=r,r=e):(i=r,r=n,n=e)),i===!1)i=l;else if(!i)return this;return 1===o&&(a=i,i=function(t){return st().off(t),a.apply(this,arguments)},i.guid=a.guid||(a.guid=st.guid++)),this.each(function(){st.event.add(this,t,i,r,n)})},one:function(t,e,n,r){return this.on(t,e,n,r,1)},off:function(t,n,r){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,st(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(o in t)this.off(o,n,t[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=e),r===!1&&(r=l),this.each(function(){st.event.remove(this,t,r,n)})},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},trigger:function(t,e){return this.each(function(){st.event.trigger(t,e,this)})},triggerHandler:function(t,n){var r=this[0];return r?st.event.trigger(t,n,r,!0):e},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),st.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){st.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)},Dt.test(e)&&(st.event.fixHooks[e]=st.event.keyHooks),Ut.test(e)&&(st.event.fixHooks[e]=st.event.mouseHooks)}),function(t,e){function n(t){return ft.test(t+"")}function r(){var t,e=[];return t=function(n,r){return e.push(n+=" ")>M.cacheLength&&delete t[e.shift()],t[n]=r}}function i(t){return t[z]=!0,t}function o(t){var e=P.createElement("div");try{return t(e)}catch(t){return!1}finally{e=null}}function a(t,e,n,r){var i,o,a,s,c,l,u,p,f,m;if((e?e.ownerDocument||e:k)!==P&&C(e),e=e||P,n=n||[],!t||"string"!=typeof t)return n;if(1!==(s=e.nodeType)&&9!==s)return[];if(!N&&!r){if(i=mt.exec(t))if(a=i[1]){if(9===s){if(o=e.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&F(e,o)&&o.id===a)return n.push(o),n}else{if(i[2])return J.apply(n,Q.call(e.getElementsByTagName(t),0)),n;if((a=i[3])&&j.getByClassName&&e.getElementsByClassName)return J.apply(n,Q.call(e.getElementsByClassName(a),0)),n}if(j.qsa&&!I.test(t)){if(u=!0,p=z,f=e,m=9===s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(l=h(t),(u=e.getAttribute("id"))?p=u.replace(yt,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",c=l.length;c--;)l[c]=p+d(l[c]);f=pt.test(t)&&e.parentNode||e,m=l.join(",")}if(m)try{return J.apply(n,Q.call(f.querySelectorAll(m),0)),n}catch(t){}finally{u||e.removeAttribute("id")}}}return b(t.replace(at,"$1"),e,n,r)}function s(t,e){for(var n=t&&e&&t.nextSibling;n;n=n.nextSibling)if(n===e)return-1;return t?1:-1}function c(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function l(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function u(t){return i(function(e){return e=+e,i(function(n,r){for(var i,o=t([],n.length,e),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function h(t,e){var n,r,i,o,s,c,l,u=V[t+" "];if(u)return e?0:u.slice(0);for(s=t,c=[],l=M.preFilter;s;){(!n||(r=ct.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),c.push(i=[])),n=!1,(r=lt.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(at," ")}),s=s.slice(n.length));for(o in M.filter)!(r=dt[o].exec(s))||l[o]&&!(r=l[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?a.error(t):V(t,c).slice(0)}function d(t){for(var e=0,n=t.length,r="";n>e;e++)r+=t[e].value;return r}function p(t,e,n){var r=e.dir,i=n&&"parentNode"===e.dir,o=H++;return e.first?function(e,n,o){for(;e=e[r];)if(1===e.nodeType||i)return t(e,n,o)}:function(e,n,a){var s,c,l,u=$+" "+o;if(a){for(;e=e[r];)if((1===e.nodeType||i)&&t(e,n,a))return!0}else for(;e=e[r];)if(1===e.nodeType||i)if(l=e[z]||(e[z]={}),(c=l[r])&&c[0]===u){if((s=c[1])===!0||s===E)return s===!0}else if(c=l[r]=[u],c[1]=t(e,n,a)||E,c[1]===!0)return!0}}function f(t){return t.length>1?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function m(t,e,n,r,i){for(var o,a=[],s=0,c=t.length,l=null!=e;c>s;s++)(o=t[s])&&(!n||n(o,r,i))&&(a.push(o),l&&e.push(s));return a}function g(t,e,n,r,o,a){return r&&!r[z]&&(r=g(r)),o&&!o[z]&&(o=g(o,a)),i(function(i,a,s,c){var l,u,h,d=[],p=[],f=a.length,g=i||_(e||"*",s.nodeType?[s]:s,[]),v=!t||!i&&e?g:m(g,d,t,s,c),y=n?o||(i?t:f||r)?[]:a:v;if(n&&n(v,y,s,c),r)for(l=m(y,p),r(l,[],s,c),u=l.length;u--;)(h=l[u])&&(y[p[u]]=!(v[p[u]]=h));if(i){if(o||t){if(o){for(l=[],u=y.length;u--;)(h=y[u])&&l.push(v[u]=h);o(null,y=[],l,c)}for(u=y.length;u--;)(h=y[u])&&(l=o?K.call(i,h):d[u])>-1&&(i[l]=!(a[l]=h))}}else y=m(y===a?y.splice(f,y.length):y),o?o(null,a,y,c):J.apply(a,y)})}function v(t){for(var e,n,r,i=t.length,o=M.relative[t[0].type],a=o||M.relative[" "],s=o?1:0,c=p(function(t){return t===e},a,!0),l=p(function(t){return K.call(e,t)>-1},a,!0),u=[function(t,n,r){return!o&&(r||n!==R)||((e=n).nodeType?c(t,n,r):l(t,n,r))}];i>s;s++)if(n=M.relative[t[s].type])u=[p(f(u),n)];else{if(n=M.filter[t[s].type].apply(null,t[s].matches),n[z]){for(r=++s;i>r&&!M.relative[t[r].type];r++);return g(s>1&&f(u),s>1&&d(t.slice(0,s-1)).replace(at,"$1"),n,r>s&&v(t.slice(s,r)),i>r&&v(t=t.slice(r)),i>r&&d(t))}u.push(n)}return f(u)}function y(t,e){var n=0,r=e.length>0,o=t.length>0,s=function(i,s,c,l,u){var h,d,p,f=[],g=0,v="0",y=i&&[],_=null!=u,b=R,x=i||o&&M.find.TAG("*",u&&s.parentNode||s),w=$+=null==b?1:Math.E;for(_&&(R=s!==P&&s,E=n);null!=(h=x[v]);v++){if(o&&h){for(d=0;p=t[d];d++)if(p(h,s,c)){l.push(h);break}_&&($=w,E=++n)}r&&((h=!p&&h)&&g--,i&&y.push(h))}if(g+=v,r&&v!==g){for(d=0;p=e[d];d++)p(y,f,s,c);if(i){if(g>0)for(;v--;)y[v]||f[v]||(f[v]=Z.call(l));f=m(f)}J.apply(l,f),_&&!i&&f.length>0&&g+e.length>1&&a.uniqueSort(l)}return _&&($=w,R=b),y};return r?i(s):s}function _(t,e,n){for(var r=0,i=e.length;i>r;r++)a(t,e[r],n);return n}function b(t,e,n,r){var i,o,a,s,c,l=h(t);if(!r&&1===l.length){if(o=l[0]=l[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&9===e.nodeType&&!N&&M.relative[o[1].type]){if(e=M.find.ID(a.matches[0].replace(bt,xt),e)[0],!e)return n;t=t.slice(o.shift().value.length)}for(i=dt.needsContext.test(t)?-1:o.length-1;i>=0&&(a=o[i],!M.relative[s=a.type]);i--)if((c=M.find[s])&&(r=c(a.matches[0].replace(bt,xt),pt.test(o[0].type)&&e.parentNode||e))){if(o.splice(i,1),t=r.length&&d(o),!t)return J.apply(n,Q.call(r,0)),n;break}}return A(t,l)(r,e,N,n,pt.test(t)),n}function x(){}var w,E,M,T,S,A,L,R,C,P,O,N,I,D,U,F,B,z="sizzle"+-new Date,k=t.document,j={},$=0,H=0,G=r(),V=r(),W=r(),X=typeof e,q=1<<31,Y=[],Z=Y.pop,J=Y.push,Q=Y.slice,K=Y.indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1},tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt=et.replace("w","w#"),rt="([*^$|!~]?=)",it="\\["+tt+"*("+et+")"+tt+"*(?:"+rt+tt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+nt+")|)|)"+tt+"*\\]",ot=":("+et+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+it.replace(3,8)+")*)|.*)\\)|)",at=RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),ct=RegExp("^"+tt+"*,"+tt+"*"),lt=RegExp("^"+tt+"*([\\x20\\t\\r\\n\\f>+~])"+tt+"*"),ut=RegExp(ot),ht=RegExp("^"+nt+"$"),dt={ID:RegExp("^#("+et+")"),
CLASS:RegExp("^\\.("+et+")"),NAME:RegExp("^\\[name=['\"]?("+et+")['\"]?\\]"),TAG:RegExp("^("+et.replace("w","w*")+")"),ATTR:RegExp("^"+it),PSEUDO:RegExp("^"+ot),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),needsContext:RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},pt=/[\x20\t\r\n\f]*[+~]/,ft=/\{\s*\[native code\]\s*\}/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gt=/^(?:input|select|textarea|button)$/i,vt=/^h\d$/i,yt=/'|\\/g,_t=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,bt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,xt=function(t,e){var n="0x"+e-65536;return n!==n?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{Q.call(O.childNodes,0)[0].nodeType}catch(t){Q=function(t){for(var e,n=[];e=this[t];t++)n.push(e);return n}}S=a.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},C=a.setDocument=function(t){var r=t?t.ownerDocument||t:k;return r!==P&&9===r.nodeType&&r.documentElement?(P=r,O=r.documentElement,N=S(r),j.tagNameNoComments=o(function(t){return t.appendChild(r.createComment("")),!t.getElementsByTagName("*").length}),j.attributes=o(function(t){t.innerHTML="<select></select>";var e=typeof t.lastChild.getAttribute("multiple");return"boolean"!==e&&"string"!==e}),j.getByClassName=o(function(t){return t.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!(!t.getElementsByClassName||!t.getElementsByClassName("e").length)&&(t.lastChild.className="e",2===t.getElementsByClassName("e").length)}),j.getByName=o(function(t){t.id=z+0,t.innerHTML="<a name='"+z+"'></a><div name='"+z+"'></div>",O.insertBefore(t,O.firstChild);var e=r.getElementsByName&&r.getElementsByName(z).length===2+r.getElementsByName(z+0).length;return j.getIdNotName=!r.getElementById(z),O.removeChild(t),e}),M.attrHandle=o(function(t){return t.innerHTML="<a href='#'></a>",t.firstChild&&typeof t.firstChild.getAttribute!==X&&"#"===t.firstChild.getAttribute("href")})?{}:{href:function(t){return t.getAttribute("href",2)},type:function(t){return t.getAttribute("type")}},j.getIdNotName?(M.find.ID=function(t,e){if(typeof e.getElementById!==X&&!N){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},M.filter.ID=function(t){var e=t.replace(bt,xt);return function(t){return t.getAttribute("id")===e}}):(M.find.ID=function(t,n){if(typeof n.getElementById!==X&&!N){var r=n.getElementById(t);return r?r.id===t||typeof r.getAttributeNode!==X&&r.getAttributeNode("id").value===t?[r]:e:[]}},M.filter.ID=function(t){var e=t.replace(bt,xt);return function(t){var n=typeof t.getAttributeNode!==X&&t.getAttributeNode("id");return n&&n.value===e}}),M.find.TAG=j.tagNameNoComments?function(t,n){return typeof n.getElementsByTagName!==X?n.getElementsByTagName(t):e}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[i];i++)1===n.nodeType&&r.push(n);return r}return o},M.find.NAME=j.getByName&&function(t,n){return typeof n.getElementsByName!==X?n.getElementsByName(name):e},M.find.CLASS=j.getByClassName&&function(t,n){return typeof n.getElementsByClassName===X||N?e:n.getElementsByClassName(t)},D=[],I=[":focus"],(j.qsa=n(r.querySelectorAll))&&(o(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||I.push("\\["+tt+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),t.querySelectorAll(":checked").length||I.push(":checked")}),o(function(t){t.innerHTML="<input type='hidden' i=''/>",t.querySelectorAll("[i^='']").length&&I.push("[*^$]="+tt+"*(?:\"\"|'')"),t.querySelectorAll(":enabled").length||I.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),I.push(",.*:")})),(j.matchesSelector=n(U=O.matchesSelector||O.mozMatchesSelector||O.webkitMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&o(function(t){j.disconnectedMatch=U.call(t,"div"),U.call(t,"[s!='']:x"),D.push("!=",ot)}),I=RegExp(I.join("|")),D=RegExp(D.join("|")),F=n(O.contains)||O.compareDocumentPosition?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},B=O.compareDocumentPosition?function(t,e){var n;return t===e?(L=!0,0):(n=e.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(e))?1&n||t.parentNode&&11===t.parentNode.nodeType?t===r||F(k,t)?-1:e===r||F(k,e)?1:0:4&n?-1:1:t.compareDocumentPosition?-1:1}:function(t,e){var n,i=0,o=t.parentNode,a=e.parentNode,c=[t],l=[e];if(t===e)return L=!0,0;if(t.sourceIndex&&e.sourceIndex)return(~e.sourceIndex||q)-(F(k,t)&&~t.sourceIndex||q);if(!o||!a)return t===r?-1:e===r?1:o?-1:a?1:0;if(o===a)return s(t,e);for(n=t;n=n.parentNode;)c.unshift(n);for(n=e;n=n.parentNode;)l.unshift(n);for(;c[i]===l[i];)i++;return i?s(c[i],l[i]):c[i]===k?-1:l[i]===k?1:0},L=!1,[0,0].sort(B),j.detectDuplicates=L,P):P},a.matches=function(t,e){return a(t,null,null,e)},a.matchesSelector=function(t,e){if((t.ownerDocument||t)!==P&&C(t),e=e.replace(_t,"='$1']"),!(!j.matchesSelector||N||D&&D.test(e)||I.test(e)))try{var n=U.call(t,e);if(n||j.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return a(e,P,null,[t]).length>0},a.contains=function(t,e){return(t.ownerDocument||t)!==P&&C(t),F(t,e)},a.attr=function(t,e){var n;return(t.ownerDocument||t)!==P&&C(t),N||(e=e.toLowerCase()),(n=M.attrHandle[e])?n(t):N||j.attributes?t.getAttribute(e):((n=t.getAttributeNode(e))||t.getAttribute(e))&&t[e]===!0?e:n&&n.specified?n.value:null},a.error=function(t){throw Error("Syntax error, unrecognized expression: "+t)},a.uniqueSort=function(t){var e,n=[],r=1,i=0;if(L=!j.detectDuplicates,t.sort(B),L){for(;e=t[r];r++)e===t[r-1]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return t},T=a.getText=function(t){var e,n="",r=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=T(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[r];r++)n+=T(e);return n},M=a.selectors={cacheLength:50,createPseudo:i,match:dt,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(bt,xt),t[3]=(t[4]||t[5]||"").replace(bt,xt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||a.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&a.error(t[0]),t},PSEUDO:function(t){var e,n=!t[5]&&t[2];return dt.CHILD.test(t[0])?null:(t[4]?t[2]=t[4]:n&&ut.test(n)&&(e=h(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){return"*"===t?function(){return!0}:(t=t.replace(bt,xt).toLowerCase(),function(e){return e.nodeName&&e.nodeName.toLowerCase()===t})},CLASS:function(t){var e=G[t+" "];return e||(e=RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&G(t,function(t){return e.test(t.className||typeof t.getAttribute!==X&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(r){var i=a.attr(r,t);return null==i?"!="===e:!e||(i+="","="===e?i===n:"!="===e?i!==n:"^="===e?n&&0===i.indexOf(n):"*="===e?n&&i.indexOf(n)>-1:"$="===e?n&&i.substr(i.length-n.length)===n:"~="===e?(" "+i+" ").indexOf(n)>-1:"|="===e&&(i===n||i.substr(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,c){var l,u,h,d,p,f,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!c&&!s;if(g){if(o){for(;m;){for(h=e;h=h[m];)if(s?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(u=g[z]||(g[z]={}),l=u[t]||[],p=l[0]===$&&l[1],d=l[0]===$&&l[2],h=p&&g.childNodes[p];h=++p&&h&&h[m]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===e){u[t]=[$,p,d];break}}else if(y&&(l=(e[z]||(e[z]={}))[t])&&l[0]===$)d=l[1];else for(;(h=++p&&h&&h[m]||(d=p=0)||f.pop())&&((s?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[z]||(h[z]={}))[t]=[$,d]),h!==e)););return d-=i,d===r||0===d%r&&d/r>=0}}},PSEUDO:function(t,e){var n,r=M.pseudos[t]||M.setFilters[t.toLowerCase()]||a.error("unsupported pseudo: "+t);return r[z]?r(e):r.length>1?(n=[t,t,"",e],M.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,n){for(var i,o=r(t,e),a=o.length;a--;)i=K.call(t,o[a]),t[i]=!(n[i]=o[a])}):function(t){return r(t,0,n)}):r}},pseudos:{not:i(function(t){var e=[],n=[],r=A(t.replace(at,"$1"));return r[z]?i(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),!n.pop()}}),has:i(function(t){return function(e){return a(t,e).length>0}}),contains:i(function(t){return function(e){return(e.textContent||e.innerText||T(e)).indexOf(t)>-1}}),lang:i(function(t){return ht.test(t||"")||a.error("unsupported lang: "+t),t=t.replace(bt,xt).toLowerCase(),function(e){var n;do if(n=N?e.getAttribute("xml:lang")||e.getAttribute("lang"):e.lang)return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===O},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!M.pseudos.empty(t)},header:function(t){return vt.test(t.nodeName)},input:function(t){return gt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,n){return[0>n?n+e:n]}),even:u(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:u(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:u(function(t,e,n){for(var r=0>n?n+e:n;--r>=0;)t.push(r);return t}),gt:u(function(t,e,n){for(var r=0>n?n+e:n;e>++r;)t.push(r);return t})}};for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})M.pseudos[w]=c(w);for(w in{submit:!0,reset:!0})M.pseudos[w]=l(w);A=a.compile=function(t,e){var n,r=[],i=[],o=W[t+" "];if(!o){for(e||(e=h(t)),n=e.length;n--;)o=v(e[n]),o[z]?r.push(o):i.push(o);o=W(t,y(i,r))}return o},M.pseudos.nth=M.pseudos.eq,M.filters=x.prototype=M.pseudos,M.setFilters=new x,C(),a.attr=st.attr,st.find=a,st.expr=a.selectors,st.expr[":"]=st.expr.pseudos,st.unique=a.uniqueSort,st.text=a.getText,st.isXMLDoc=a.isXML,st.contains=a.contains}(t);var zt=/Until$/,kt=/^(?:parents|prev(?:Until|All))/,jt=/^.[^:#\[\.,]*$/,Ht=st.expr.match.needsContext,Gt={children:!0,contents:!0,next:!0,prev:!0};st.fn.extend({find:function(t){var e,n,r;if("string"!=typeof t)return r=this,this.pushStack(st(t).filter(function(){for(e=0;r.length>e;e++)if(st.contains(r[e],this))return!0}));for(n=[],e=0;this.length>e;e++)st.find(t,this[e],n);return n=this.pushStack(st.unique(n)),n.selector=(this.selector?this.selector+" ":"")+t,n},has:function(t){var e,n=st(t,this),r=n.length;return this.filter(function(){for(e=0;r>e;e++)if(st.contains(this,n[e]))return!0})},not:function(t){return this.pushStack(h(this,t,!1))},filter:function(t){return this.pushStack(h(this,t,!0))},is:function(t){return!!t&&("string"==typeof t?Ht.test(t)?st(t,this.context).index(this[0])>=0:st.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){for(var n,r=0,i=this.length,o=[],a=Ht.test(t)||"string"!=typeof t?st(t,e||this.context):0;i>r;r++)for(n=this[r];n&&n.ownerDocument&&n!==e&&11!==n.nodeType;){if(a?a.index(n)>-1:st.find.matchesSelector(n,t)){o.push(n);break}n=n.parentNode}return this.pushStack(o.length>1?st.unique(o):o)},index:function(t){return t?"string"==typeof t?st.inArray(this[0],st(t)):st.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var n="string"==typeof t?st(t,e):st.makeArray(t&&t.nodeType?[t]:t),r=st.merge(this.get(),n);return this.pushStack(st.unique(r))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),st.fn.andSelf=st.fn.addBack,st.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return st.dir(t,"parentNode")},parentsUntil:function(t,e,n){return st.dir(t,"parentNode",n)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return st.dir(t,"nextSibling")},prevAll:function(t){return st.dir(t,"previousSibling")},nextUntil:function(t,e,n){return st.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return st.dir(t,"previousSibling",n)},siblings:function(t){return st.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return st.sibling(t.firstChild)},contents:function(t){return st.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:st.merge([],t.childNodes)}},function(t,e){st.fn[t]=function(n,r){var i=st.map(this,e,n);return zt.test(t)||(r=n),r&&"string"==typeof r&&(i=st.filter(r,i)),i=this.length>1&&!Gt[t]?st.unique(i):i,this.length>1&&kt.test(t)&&(i=i.reverse()),this.pushStack(i)}}),st.extend({filter:function(t,e,n){return n&&(t=":not("+t+")"),1===e.length?st.find.matchesSelector(e[0],t)?[e[0]]:[]:st.find.matches(t,e)},dir:function(t,n,r){for(var i=[],o=t[n];o&&9!==o.nodeType&&(r===e||1!==o.nodeType||!st(o).is(r));)1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}});var Vt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Wt=/ jQuery\d+="(?:null|\d+)"/g,Xt=RegExp("<(?:"+Vt+")[\\s/>]","i"),qt=/^\s+/,Yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Zt=/<([\w:]+)/,Jt=/<tbody/i,$t=/<|&#?\w+;/,Qt=/<(?:script|style|link)/i,Kt=/^(?:checkbox|radio)$/i,te=/checked\s*(?:[^=]|=\s*.checked.)/i,ee=/^$|\/(?:java|ecma)script/i,ne=/^true\/(.*)/,re=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ie={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:st.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},oe=d(X),ae=oe.appendChild(X.createElement("div"));ie.optgroup=ie.option,ie.tbody=ie.tfoot=ie.colgroup=ie.caption=ie.thead,ie.th=ie.td,st.fn.extend({text:function(t){return st.access(this,function(t){return t===e?st.text(this):this.empty().append((this[0]&&this[0].ownerDocument||X).createTextNode(t))},null,t,arguments.length)},wrapAll:function(t){if(st.isFunction(t))return this.each(function(e){st(this).wrapAll(t.call(this,e))});if(this[0]){var e=st(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return st.isFunction(t)?this.each(function(e){st(this).wrapInner(t.call(this,e))}):this.each(function(){var e=st(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=st.isFunction(t);return this.each(function(n){st(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){st.nodeName(this,"body")||st(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(t)})},prepend:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(t,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var n,r=0;null!=(n=this[r]);r++)(!t||st.filter(t,[n]).length>0)&&(e||1!==n.nodeType||st.cleanData(_(n)),n.parentNode&&(e&&st.contains(n.ownerDocument,n)&&g(_(n,"script")),n.parentNode.removeChild(n)));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&st.cleanData(_(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&st.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return st.clone(this,t,e)})},html:function(t){return st.access(this,function(t){var n=this[0]||{},r=0,i=this.length;if(t===e)return 1===n.nodeType?n.innerHTML.replace(Wt,""):e;if(!("string"!=typeof t||Qt.test(t)||!st.support.htmlSerialize&&Xt.test(t)||!st.support.leadingWhitespace&&qt.test(t)||ie[(Zt.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Yt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(st.cleanData(_(n,!1)),n.innerHTML=t);n=0}catch(t){}}n&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(t){var e=st.isFunction(t);return e||"string"==typeof t||(t=st(t).not(this).detach()),this.domManip([t],!0,function(t){var e=this.nextSibling,n=this.parentNode;(n&&1===this.nodeType||11===this.nodeType)&&(st(this).remove(),e?e.parentNode.insertBefore(t,e):n.appendChild(t))})},detach:function(t){return this.remove(t,!0)},domManip:function(t,n,r){t=tt.apply([],t);var i,o,a,s,c,l,u=0,h=this.length,d=this,g=h-1,v=t[0],y=st.isFunction(v);if(y||!(1>=h||"string"!=typeof v||st.support.checkClone)&&te.test(v))return this.each(function(i){var o=d.eq(i);y&&(t[0]=v.call(this,i,n?o.html():e)),o.domManip(t,n,r)});if(h&&(i=st.buildFragment(t,this[0].ownerDocument,!1,this),o=i.firstChild,1===i.childNodes.length&&(i=o),o)){for(n=n&&st.nodeName(o,"tr"),a=st.map(_(i,"script"),f),s=a.length;h>u;u++)c=i,u!==g&&(c=st.clone(c,!0,!0),s&&st.merge(a,_(c,"script"))),r.call(n&&st.nodeName(this[u],"table")?p(this[u],"tbody"):this[u],c,u);if(s)for(l=a[a.length-1].ownerDocument,st.map(a,m),u=0;s>u;u++)c=a[u],ee.test(c.type||"")&&!st._data(c,"globalEval")&&st.contains(l,c)&&(c.src?st.ajax({url:c.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):st.globalEval((c.text||c.textContent||c.innerHTML||"").replace(re,"")));i=o=null}return this}}),st.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){st.fn[t]=function(t){for(var n,r=0,i=[],o=st(t),a=o.length-1;a>=r;r++)n=r===a?this:this.clone(!0),st(o[r])[e](n),et.apply(i,n.get());return this.pushStack(i)}}),st.extend({clone:function(t,e,n){var r,i,o,a,s,c=st.contains(t.ownerDocument,t);if(st.support.html5Clone||st.isXMLDoc(t)||!Xt.test("<"+t.nodeName+">")?s=t.cloneNode(!0):(ae.innerHTML=t.outerHTML,ae.removeChild(s=ae.firstChild)),!(st.support.noCloneEvent&&st.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||st.isXMLDoc(t)))for(r=_(s),i=_(t),a=0;null!=(o=i[a]);++a)r[a]&&y(o,r[a]);if(e)if(n)for(i=i||_(t),r=r||_(s),a=0;null!=(o=i[a]);a++)v(o,r[a]);else v(t,s);return r=_(s,"script"),r.length>0&&g(r,!c&&_(t,"script")),r=i=o=null,s},buildFragment:function(t,e,n,r){for(var i,o,a,s,c,l,u,h=t.length,p=d(e),f=[],m=0;h>m;m++)if(o=t[m],o||0===o)if("object"===st.type(o))st.merge(f,o.nodeType?[o]:o);else if($t.test(o)){for(s=s||p.appendChild(e.createElement("div")),a=(Zt.exec(o)||["",""])[1].toLowerCase(),c=ie[a]||ie._default,s.innerHTML=c[1]+o.replace(Yt,"<$1></$2>")+c[2],u=c[0];u--;)s=s.lastChild;if(!st.support.leadingWhitespace&&qt.test(o)&&f.push(e.createTextNode(qt.exec(o)[0])),!st.support.tbody)for(o="table"!==a||Jt.test(o)?"<table>"!==c[1]||Jt.test(o)?0:s:s.firstChild,u=o&&o.childNodes.length;u--;)st.nodeName(l=o.childNodes[u],"tbody")&&!l.childNodes.length&&o.removeChild(l);for(st.merge(f,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=p.lastChild}else f.push(e.createTextNode(o));for(s&&p.removeChild(s),st.support.appendChecked||st.grep(_(f,"input"),b),m=0;o=f[m++];)if((!r||-1===st.inArray(o,r))&&(i=st.contains(o.ownerDocument,o),s=_(p.appendChild(o),"script"),i&&g(s),n))for(u=0;o=s[u++];)ee.test(o.type||"")&&n.push(o);return s=null,p},cleanData:function(t,n){for(var r,i,o,a,s=0,c=st.expando,l=st.cache,u=st.support.deleteExpando,h=st.event.special;null!=(o=t[s]);s++)if((n||st.acceptData(o))&&(i=o[c],r=i&&l[i])){if(r.events)for(a in r.events)h[a]?st.event.remove(o,a):st.removeEvent(o,a,r.handle);l[i]&&(delete l[i],u?delete o[c]:o.removeAttribute!==e?o.removeAttribute(c):o[c]=null,Q.push(i))}}});var se,ce,le,ue=/alpha\([^)]*\)/i,he=/opacity\s*=\s*([^)]*)/,de=/^(top|right|bottom|left)$/,pe=/^(none|table(?!-c[ea]).+)/,fe=/^margin/,me=RegExp("^("+ct+")(.*)$","i"),ge=RegExp("^("+ct+")(?!px)[a-z%]+$","i"),ve=RegExp("^([+-])=("+ct+")","i"),ye={BODY:"block"},_e={position:"absolute",visibility:"hidden",display:"block"},be={letterSpacing:0,fontWeight:400},xe=["Top","Right","Bottom","Left"],we=["Webkit","O","Moz","ms"];st.fn.extend({css:function(t,n){return st.access(this,function(t,n,r){var i,o,a={},s=0;if(st.isArray(n)){for(i=ce(t),o=n.length;o>s;s++)a[n[s]]=st.css(t,n[s],!1,i);return a}return r!==e?st.style(t,n,r):st.css(t,n)},t,n,arguments.length>1)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(t){var e="boolean"==typeof t;return this.each(function(){(e?t:w(this))?st(this).show():st(this).hide()})}}),st.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=se(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:st.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,n,r,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,a,s,c=st.camelCase(n),l=t.style;if(n=st.cssProps[c]||(st.cssProps[c]=x(l,c)),s=st.cssHooks[n]||st.cssHooks[c],r===e)return s&&"get"in s&&(o=s.get(t,!1,i))!==e?o:l[n];if(a=typeof r,"string"===a&&(o=ve.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(st.css(t,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||st.cssNumber[c]||(r+="px"),st.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set"in s&&(r=s.set(t,r,i))===e)))try{l[n]=r}catch(t){}}},css:function(t,n,r,i){var o,a,s,c=st.camelCase(n);return n=st.cssProps[c]||(st.cssProps[c]=x(t.style,c)),s=st.cssHooks[n]||st.cssHooks[c],s&&"get"in s&&(o=s.get(t,!0,r)),o===e&&(o=se(t,n,i)),"normal"===o&&n in be&&(o=be[n]),r?(a=parseFloat(o),r===!0||st.isNumeric(a)?a||0:o):o},swap:function(t,e,n,r){var i,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];i=n.apply(t,r||[]);for(o in e)t.style[o]=a[o];return i}}),t.getComputedStyle?(ce=function(e){return t.getComputedStyle(e,null)},se=function(t,n,r){var i,o,a,s=r||ce(t),c=s?s.getPropertyValue(n)||s[n]:e,l=t.style;return s&&(""!==c||st.contains(t.ownerDocument,t)||(c=st.style(t,n)),ge.test(c)&&fe.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=c,c=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),c}):X.documentElement.currentStyle&&(ce=function(t){return t.currentStyle},se=function(t,n,r){var i,o,a,s=r||ce(t),c=s?s[n]:e,l=t.style;return null==c&&l&&l[n]&&(c=l[n]),ge.test(c)&&!de.test(n)&&(i=l.left,o=t.runtimeStyle,a=o&&o.left,a&&(o.left=t.currentStyle.left),l.left="fontSize"===n?"1em":c,c=l.pixelLeft+"px",l.left=i,a&&(o.left=a)),""===c?"auto":c}),st.each(["height","width"],function(t,n){st.cssHooks[n]={get:function(t,r,i){return r?0===t.offsetWidth&&pe.test(st.css(t,"display"))?st.swap(t,_e,function(){return S(t,n,i)}):S(t,n,i):e},set:function(t,e,r){var i=r&&ce(t);return M(t,e,r?T(t,n,r,st.support.boxSizing&&"border-box"===st.css(t,"boxSizing",!1,i),i):0)}}}),st.support.opacity||(st.cssHooks.opacity={get:function(t,e){return he.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var n=t.style,r=t.currentStyle,i=st.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(e>=1||""===e)&&""===st.trim(o.replace(ue,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===e||r&&!r.filter)||(n.filter=ue.test(o)?o.replace(ue,i):o+" "+i)}}),st(function(){st.support.reliableMarginRight||(st.cssHooks.marginRight={get:function(t,n){return n?st.swap(t,{display:"inline-block"},se,[t,"marginRight"]):e}}),!st.support.pixelPosition&&st.fn.position&&st.each(["top","left"],function(t,n){st.cssHooks[n]={get:function(t,r){return r?(r=se(t,n),ge.test(r)?st(t).position()[n]+"px":r):e}}})}),st.expr&&st.expr.filters&&(st.expr.filters.hidden=function(t){return 0===t.offsetWidth&&0===t.offsetHeight||!st.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||st.css(t,"display"))},st.expr.filters.visible=function(t){return!st.expr.filters.hidden(t)}),st.each({margin:"",padding:"",border:"Width"},function(t,e){st.cssHooks[t+e]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];4>r;r++)i[t+xe[r]+e]=o[r]||o[r-2]||o[0];return i}},fe.test(t)||(st.cssHooks[t+e].set=M)});var Ee=/%20/g,Me=/\[\]$/,Te=/\r?\n/g,Se=/^(?:submit|button|image|reset)$/i,Ae=/^(?:input|select|textarea|keygen)/i;st.fn.extend({serialize:function(){return st.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=st.prop(this,"elements");return t?st.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!st(this).is(":disabled")&&Ae.test(this.nodeName)&&!Se.test(t)&&(this.checked||!Kt.test(t))}).map(function(t,e){var n=st(this).val();return null==n?null:st.isArray(n)?st.map(n,function(t){return{name:e.name,value:t.replace(Te,"\r\n")}}):{name:e.name,value:n.replace(Te,"\r\n")}}).get()}}),st.param=function(t,n){var r,i=[],o=function(t,e){e=st.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(n===e&&(n=st.ajaxSettings&&st.ajaxSettings.traditional),st.isArray(t)||t.jquery&&!st.isPlainObject(t))st.each(t,function(){o(this.name,this.value)});else for(r in t)R(r,t[r],n,o);return i.join("&").replace(Ee,"+")};var Le,Re,Ce=st.now(),Pe=/\?/,Oe=/#.*$/,Ne=/([?&])_=[^&]*/,Ie=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,De=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ue=/^(?:GET|HEAD)$/,Fe=/^\/\//,Be=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ze=st.fn.load,ke={},je={},He="*/".concat("*");try{Re=q.href}catch(t){Re=X.createElement("a"),Re.href="",Re=Re.href}Le=Be.exec(Re.toLowerCase())||[],st.fn.load=function(t,n,r){if("string"!=typeof t&&ze)return ze.apply(this,arguments);var i,o,a,s=this,c=t.indexOf(" ");return c>=0&&(i=t.slice(c,t.length),t=t.slice(0,c)),st.isFunction(n)?(r=n,n=e):n&&"object"==typeof n&&(o="POST"),s.length>0&&st.ajax({url:t,type:o,dataType:"html",data:n}).done(function(t){a=arguments,s.html(i?st("<div>").append(st.parseHTML(t)).find(i):t)}).complete(r&&function(t,e){s.each(r,a||[t.responseText,e,t])}),this},st.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){st.fn[e]=function(t){return this.on(e,t)}}),st.each(["get","post"],function(t,n){st[n]=function(t,r,i,o){return st.isFunction(r)&&(o=o||i,i=r,r=e),st.ajax({url:t,type:n,dataType:o,data:r,success:i})}}),st.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Re,type:"GET",isLocal:De.test(Le[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":He,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":t.String,"text html":!0,"text json":st.parseJSON,"text xml":st.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?O(O(t,st.ajaxSettings),e):O(st.ajaxSettings,t)},ajaxPrefilter:C(ke),ajaxTransport:C(je),ajax:function(t,n){function r(t,n,r,s){var l,h,y,_,x,E=n;2!==b&&(b=2,c&&clearTimeout(c),i=e,a=s||"",w.readyState=t>0?4:0,r&&(_=N(d,w,r)),t>=200&&300>t||304===t?(d.ifModified&&(x=w.getResponseHeader("Last-Modified"),x&&(st.lastModified[o]=x),x=w.getResponseHeader("etag"),x&&(st.etag[o]=x)),304===t?(l=!0,E="notmodified"):(l=I(d,_),E=l.state,h=l.data,y=l.error,l=!y)):(y=E,(t||!E)&&(E="error",0>t&&(t=0))),w.status=t,w.statusText=(n||E)+"",l?m.resolveWith(p,[h,E,w]):m.rejectWith(p,[w,E,y]),w.statusCode(v),v=e,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[w,d,l?h:y]),g.fireWith(p,[w,E]),u&&(f.trigger("ajaxComplete",[w,d]),--st.active||st.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=e),n=n||{};var i,o,a,s,c,l,u,h,d=st.ajaxSetup({},n),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?st(p):st.event,m=st.Deferred(),g=st.Callbacks("once memory"),v=d.statusCode||{},y={},_={},b=0,x="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!s)for(s={};e=Ie.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return b||(t=_[n]=_[n]||t,y[t]=e),this},overrideMimeType:function(t){return b||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>b)for(e in t)v[e]=[v[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||x;return i&&i.abort(e),r(0,e),this}};if(m.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,d.url=((t||d.url||Re)+"").replace(Oe,"").replace(Fe,Le[1]+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=st.trim(d.dataType||"*").toLowerCase().match(lt)||[""],null==d.crossDomain&&(l=Be.exec(d.url.toLowerCase()),d.crossDomain=!(!l||l[1]===Le[1]&&l[2]===Le[2]&&(l[3]||("http:"===l[1]?80:443))==(Le[3]||("http:"===Le[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=st.param(d.data,d.traditional)),P(ke,d,n,w),2===b)return w;u=d.global,u&&0===st.active++&&st.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Ue.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(Pe.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Ne.test(o)?o.replace(Ne,"$1_="+Ce++):o+(Pe.test(o)?"&":"?")+"_="+Ce++)),d.ifModified&&(st.lastModified[o]&&w.setRequestHeader("If-Modified-Since",st.lastModified[o]),st.etag[o]&&w.setRequestHeader("If-None-Match",st.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||n.contentType)&&w.setRequestHeader("Content-Type",d.contentType),w.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+He+"; q=0.01":""):d.accepts["*"]);for(h in d.headers)w.setRequestHeader(h,d.headers[h]);if(d.beforeSend&&(d.beforeSend.call(p,w,d)===!1||2===b))return w.abort();x="abort";for(h in{success:1,error:1,complete:1})w[h](d[h]);if(i=P(je,d,n,w)){w.readyState=1,u&&f.trigger("ajaxSend",[w,d]),d.async&&d.timeout>0&&(c=setTimeout(function(){w.abort("timeout")},d.timeout));try{b=1,i.send(y,r)}catch(t){if(!(2>b))throw t;r(-1,t)}}else r(-1,"No Transport");return w},getScript:function(t,n){return st.get(t,e,n,"script");
},getJSON:function(t,e,n){return st.get(t,e,n,"json")}}),st.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return st.globalEval(t),t}}}),st.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),st.ajaxTransport("script",function(t){if(t.crossDomain){var n,r=X.head||st("head")[0]||X.documentElement;return{send:function(e,i){n=X.createElement("script"),n.async=!0,t.scriptCharset&&(n.charset=t.scriptCharset),n.src=t.url,n.onload=n.onreadystatechange=function(t,e){(e||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,e||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(e,!0)}}}});var Ge=[],Ve=/(=)\?(?=&|$)|\?\?/;st.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ge.pop()||st.expando+"_"+Ce++;return this[t]=!0,t}}),st.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,c=n.jsonp!==!1&&(Ve.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ve.test(n.data)&&"data");return c||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=st.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,c?n[c]=n[c].replace(Ve,"$1"+o):n.jsonp!==!1&&(n.url+=(Pe.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||st.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=t[o],t[o]=function(){s=arguments},i.always(function(){t[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Ge.push(o)),s&&st.isFunction(a)&&a(s[0]),s=a=e}),"script"):e});var We,Xe,qe=0,Ye=t.ActiveXObject&&function(){var t;for(t in We)We[t](e,!0)};st.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&D()||U()}:D,Xe=st.ajaxSettings.xhr(),st.support.cors=!!Xe&&"withCredentials"in Xe,Xe=st.support.ajax=!!Xe,Xe&&st.ajaxTransport(function(n){if(!n.crossDomain||st.support.cors){var r;return{send:function(i,o){var a,s,c=n.xhr();if(n.username?c.open(n.type,n.url,n.async,n.username,n.password):c.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)c[s]=n.xhrFields[s];n.mimeType&&c.overrideMimeType&&c.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)c.setRequestHeader(s,i[s])}catch(t){}c.send(n.hasContent&&n.data||null),r=function(t,i){var s,l,u,h,d;try{if(r&&(i||4===c.readyState))if(r=e,a&&(c.onreadystatechange=st.noop,Ye&&delete We[a]),i)4!==c.readyState&&c.abort();else{h={},s=c.status,d=c.responseXML,u=c.getAllResponseHeaders(),d&&d.documentElement&&(h.xml=d),"string"==typeof c.responseText&&(h.text=c.responseText);try{l=c.statusText}catch(t){l=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=h.text?200:404}}catch(t){i||o(-1,t)}h&&o(s,l,h,u)},n.async?4===c.readyState?setTimeout(r):(a=++qe,Ye&&(We||(We={},st(t).unload(Ye)),We[a]=r),c.onreadystatechange=r):r()},abort:function(){r&&r(e,!0)}}}});var Ze,Je,$e=/^(?:toggle|show|hide)$/,Qe=RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),Ke=/queueHooks$/,tn=[j],en={"*":[function(t,e){var n,r,i=this.createTween(t,e),o=Qe.exec(e),a=i.cur(),s=+a||0,c=1,l=20;if(o){if(n=+o[2],r=o[3]||(st.cssNumber[t]?"":"px"),"px"!==r&&s){s=st.css(i.elem,t,!0)||n||1;do c=c||".5",s/=c,st.style(i.elem,t,s+r);while(c!==(c=i.cur()/a)&&1!==c&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};st.Animation=st.extend(z,{tweener:function(t,e){st.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,r=0,i=t.length;i>r;r++)n=t[r],en[n]=en[n]||[],en[n].unshift(e)},prefilter:function(t,e){e?tn.unshift(t):tn.push(t)}}),st.Tween=$,$.prototype={constructor:$,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||"swing",this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(st.cssNumber[n]?"":"px")},cur:function(){var t=$.propHooks[this.prop];return t&&t.get?t.get(this):$.propHooks._default.get(this)},run:function(t){var e,n=$.propHooks[this.prop];return this.pos=e=this.options.duration?st.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):$.propHooks._default.set(this),this}},$.prototype.init.prototype=$.prototype,$.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=st.css(t.elem,t.prop,"auto"),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){st.fx.step[t.prop]?st.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[st.cssProps[t.prop]]||st.cssHooks[t.prop])?st.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},$.propHooks.scrollTop=$.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},st.each(["toggle","show","hide"],function(t,e){var n=st.fn[e];st.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(H(e,!0),t,r,i)}}),st.fn.extend({fadeTo:function(t,e,n,r){return this.filter(w).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=st.isEmptyObject(t),o=st.speed(e,n,r),a=function(){var e=z(this,st.extend({},t),o);a.finish=function(){e.stop(!0)},(i||st._data(this,"finish"))&&e.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,n,r){var i=function(t){var e=t.stop;delete t.stop,e(r)};return"string"!=typeof t&&(r=n,n=t,t=e),n&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,n=null!=t&&t+"queueHooks",o=st.timers,a=st._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Ke.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=t&&o[n].queue!==t||(o[n].anim.stop(r),e=!1,o.splice(n,1));(e||!r)&&st.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=st._data(this),r=n[t+"queue"],i=n[t+"queueHooks"],o=st.timers,a=r?r.length:0;for(n.finish=!0,st.queue(this,t,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish})}}),st.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){st.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}}),st.speed=function(t,e,n){var r=t&&"object"==typeof t?st.extend({},t):{complete:n||!n&&e||st.isFunction(t)&&t,duration:t,easing:n&&e||e&&!st.isFunction(e)&&e};return r.duration=st.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in st.fx.speeds?st.fx.speeds[r.duration]:st.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){st.isFunction(r.old)&&r.old.call(this),r.queue&&st.dequeue(this,r.queue)},r},st.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},st.timers=[],st.fx=$.prototype.init,st.fx.tick=function(){var t,n=st.timers,r=0;for(Ze=st.now();n.length>r;r++)t=n[r],t()||n[r]!==t||n.splice(r--,1);n.length||st.fx.stop(),Ze=e},st.fx.timer=function(t){t()&&st.timers.push(t)&&st.fx.start()},st.fx.interval=13,st.fx.start=function(){Je||(Je=setInterval(st.fx.tick,st.fx.interval))},st.fx.stop=function(){clearInterval(Je),Je=null},st.fx.speeds={slow:600,fast:200,_default:400},st.fx.step={},st.expr&&st.expr.filters&&(st.expr.filters.animated=function(t){return st.grep(st.timers,function(e){return t===e.elem}).length}),st.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){st.offset.setOffset(this,t,e)});var n,r,i={top:0,left:0},o=this[0],a=o&&o.ownerDocument;return a?(n=a.documentElement,st.contains(n,o)?(o.getBoundingClientRect!==e&&(i=o.getBoundingClientRect()),r=G(a),{top:i.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:i.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):i):void 0},st.offset={setOffset:function(t,e,n){var r=st.css(t,"position");"static"===r&&(t.style.position="relative");var i,o,a=st(t),s=a.offset(),c=st.css(t,"top"),l=st.css(t,"left"),u=("absolute"===r||"fixed"===r)&&st.inArray("auto",[c,l])>-1,h={},d={};u?(d=a.position(),i=d.top,o=d.left):(i=parseFloat(c)||0,o=parseFloat(l)||0),st.isFunction(e)&&(e=e.call(t,n,s)),null!=e.top&&(h.top=e.top-s.top+i),null!=e.left&&(h.left=e.left-s.left+o),"using"in e?e.using.call(t,h):a.css(h)}},st.fn.extend({position:function(){if(this[0]){var t,e,n={top:0,left:0},r=this[0];return"fixed"===st.css(r,"position")?e=r.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),st.nodeName(t[0],"html")||(n=t.offset()),n.top+=st.css(t[0],"borderTopWidth",!0),n.left+=st.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-st.css(r,"marginTop",!0),left:e.left-n.left-st.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||X.documentElement;t&&!st.nodeName(t,"html")&&"static"===st.css(t,"position");)t=t.offsetParent;return t||X.documentElement})}}),st.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r=/Y/.test(n);st.fn[t]=function(i){return st.access(this,function(t,i,o){var a=G(t);return o===e?a?n in a?a[n]:a.document.documentElement[i]:t[i]:(a?a.scrollTo(r?st(a).scrollLeft():o,r?o:st(a).scrollTop()):t[i]=o,e)},t,i,arguments.length,null)}}),st.each({Height:"height",Width:"width"},function(t,n){st.each({padding:"inner"+t,content:n,"":"outer"+t},function(r,i){st.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return st.access(this,function(n,r,i){var o;return st.isWindow(n)?n.document.documentElement["client"+t]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+t],o["scroll"+t],n.body["offset"+t],o["offset"+t],o["client"+t])):i===e?st.css(n,r,s):st.style(n,r,i,s)},n,a?i:e,a,null)}})}),t.jQuery=t.$=st,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return st})}(window),function(){function t(t,e){return t.set(e[0],e[1]),t}function e(t,e){return t.add(e),t}function n(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function r(t,e,n,r){for(var i=-1,o=t?t.length:0;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function i(t,e){for(var n=-1,r=t?t.length:0;++n<r&&!1!==e(t[n],n,t););return t}function o(t,e){for(var n=t?t.length:0;n--&&!1!==e(t[n],n,t););return t}function a(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(!e(t[n],n,t))return!1;return!0}function s(t,e){for(var n=-1,r=t?t.length:0,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function c(t,e){return!(!t||!t.length)&&-1<v(t,e,0)}function l(t,e,n){for(var r=-1,i=t?t.length:0;++r<i;)if(n(e,t[r]))return!0;return!1}function u(t,e){for(var n=-1,r=t?t.length:0,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function h(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function d(t,e,n,r){var i=-1,o=t?t.length:0;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function p(t,e,n,r){var i=t?t.length:0;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function f(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(e(t[n],n,t))return!0;return!1}function m(t,e,n){var r;return n(t,function(t,n,i){return e(t,n,i)?(r=n,!1):void 0}),r}function g(t,e,n,r){var i=t.length;for(n+=r?1:-1;r?n--:++n<i;)if(e(t[n],n,t))return n;return-1}function v(t,e,n){if(e!==e)return I(t,n);--n;for(var r=t.length;++n<r;)if(t[n]===e)return n;return-1}function y(t,e,n,r){--n;for(var i=t.length;++n<i;)if(r(t[n],e))return n;return-1}function _(t,e){var n=t?t.length:0;return n?w(t,e)/n:W}function b(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function x(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].c;return t}function w(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==G&&(n=n===G?o:n+o)}return n}function E(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function M(t,e){return u(e,function(e){return[e,t[e]]})}function T(t){return function(e){return t(e)}}function S(t,e){return u(e,function(e){return t[e]})}function A(t,e){return t.has(e)}function L(t,e){for(var n=-1,r=t.length;++n<r&&-1<v(e,t[n],0););return n}function R(t,e){for(var n=t.length;n--&&-1<v(e,t[n],0););return n}function C(t){return t&&t.Object===Object?t:null}function P(t){return Ut[t]}function O(t){return Ft[t]}function N(t){return"\\"+zt[t]}function I(t,e,n){var r=t.length;for(e+=n?1:-1;n?e--:++e<r;){var i=t[e];if(i!==i)return e}return-1}function D(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function U(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function F(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function $(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&"__lodash_placeholder__"!==a||(t[n]="__lodash_placeholder__",o[i++]=n)}return o}function B(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function z(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function k(t){if(!t||!Pt.test(t))return t.length;for(var e=Rt.lastIndex=0;Rt.test(t);)e++;return e}function j(t){return Bt[t]}function H(C){function Mt(t,e){return C.setTimeout.call(qt,t,e)}function Tt(t){if(Vr(t)&&!ya(t)&&!(t instanceof Ft)){if(t instanceof Ut)return t;if(Pi.call(t,"__wrapped__"))return lr(t)}return new Ut(t)}function St(){}function Ut(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=G}function Ft(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Bt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function zt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ht(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Gt(t){var e=-1,n=t?t.length:0;for(this.__data__=new Ht;++e<n;)this.add(t[e])}function Wt(t){this.__data__=new zt(t)}function Xt(t,e,n,r){return t===G||Dr(t,Si[n])&&!Pi.call(r,n)?e:t}function Zt(t,e,n){(n===G||Dr(t[e],n))&&("number"!=typeof e||n!==G||e in t)||(t[e]=n)}function Jt(t,e,n){var r=t[e];Pi.call(t,e)&&Dr(r,n)&&(n!==G||e in t)||(t[e]=n)}function $t(t,e){for(var n=t.length;n--;)if(Dr(t[n][0],e))return n;return-1}function Qt(t,e,n,r){return Mo(t,function(t,i,o){e(r,t,n(t),o)}),r}function Kt(t,e){return t&&hn(e,ai(e),t)}function te(t,e){for(var n=-1,r=null==t,i=e.length,o=Array(i);++n<i;)o[n]=r?G:ii(t,e[n]);return o}function ee(t,e,n){return t===t&&(n!==G&&(t=n>=t?t:n),e!==G&&(t=t>=e?t:e)),t}function ne(t,e,n,r,o,a,s){var c;if(r&&(c=a?r(t,o,a,s):r(t)),c!==G)return c;if(!Gr(t))return t;if(o=ya(t)){if(c=qn(t),!e)return un(t,c)}else{var l=Wn(t),u="[object Function]"==l||"[object GeneratorFunction]"==l;if(_a(t))return on(t,e);if("[object Object]"==l||"[object Arguments]"==l||u&&!a){if(D(t))return a?t:{};if(c=Yn(u?{}:t),!e)return dn(t,Kt(c,t))}else{if(!Dt[l])return a?t:{};c=Zn(t,l,ne,e)}}if(s||(s=new Wt),a=s.get(t))return a;if(s.set(t,c),!o)var h=n?me(t,ai,Vn):ai(t);return i(h||t,function(i,o){h&&(o=i,i=t[o]),Jt(c,o,ne(i,e,n,r,o,t,s))}),c}function re(t){var e=ai(t),n=e.length;return function(r){if(null==r)return!n;for(var i=n;i--;){var o=e[i],a=t[o],s=r[o];if(s===G&&!(o in Object(r))||!a(s))return!1}return!0}}function ie(t){return Gr(t)?Vi(t):{}}function oe(t,e,n){if("function"!=typeof t)throw new Mi("Expected a function");return Mt(function(){t.apply(G,n)},e)}function ae(t,e,n,r){var i=-1,o=c,a=!0,s=t.length,h=[],d=e.length;if(!s)return h;n&&(e=u(e,T(n))),r?(o=l,a=!1):e.length>=200&&(o=A,a=!1,e=new Gt(e));t:for(;++i<s;){var p=t[i],f=n?n(p):p,p=r||0!==p?p:0;if(a&&f===f){for(var m=d;m--;)if(e[m]===f)continue t;h.push(p)}else o(e,f,r)||h.push(p)}return h}function se(t,e){var n=!0;return Mo(t,function(t,r,i){return n=!!e(t,r,i)}),n}function ce(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(s===G?a===a&&!Zr(a):n(a,s)))var s=a,c=o}return c}function le(t,e){var n=[];return Mo(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function ue(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=$n),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?ue(s,e-1,n,r,i):h(i,s):r||(i[i.length]=s)}return i}function he(t,e){return t&&So(t,e,ai)}function de(t,e){return t&&Ao(t,e,ai)}function pe(t,e){return s(e,function(e){return kr(t[e])})}function fe(t,e){e=er(e,t)?[e]:nn(e);for(var n=0,r=e.length;null!=t&&r>n;)t=t[sr(e[n++])];return n&&n==r?t:G}function me(t,e,n){return e=e(t),ya(t)?e:h(e,n(t))}function ge(t,e){return t>e}function ve(t,e){return null!=t&&(Pi.call(t,e)||"object"==typeof t&&e in t&&null===Zi(Object(t)))}function ye(t,e){return null!=t&&e in Object(t)}function _e(t,e,n){for(var r=n?l:c,i=t[0].length,o=t.length,a=o,s=Array(o),h=1/0,d=[];a--;){var p=t[a];a&&e&&(p=u(p,T(e))),h=to(p.length,h),s[a]=!n&&(e||i>=120&&p.length>=120)?new Gt(a&&p):G}var p=t[0],f=-1,m=s[0];t:for(;++f<i&&h>d.length;){var g=p[f],v=e?e(g):g,g=n||0!==g?g:0;if(m?!A(m,v):!r(d,v,n)){for(a=o;--a;){var y=s[a];if(y?!A(y,v):!r(t[a],v,n))continue t}m&&m.push(v),d.push(g)}}return d}function be(t,e,n){var r={};return he(t,function(t,i,o){e(r,n(t),i,o)}),r}function xe(t,e,r){return er(e,t)||(e=nn(e),t=ar(t,e),e=mr(e)),e=null==t?t:t[sr(e)],null==e?G:n(e,t,r)}function we(t,e,n,r,i){if(t===e)e=!0;else if(null==t||null==e||!Gr(t)&&!Vr(e))e=t!==t&&e!==e;else t:{var o=ya(t),a=ya(e),s="[object Array]",c="[object Array]";o||(s=Wn(t),s="[object Arguments]"==s?"[object Object]":s),a||(c=Wn(e),c="[object Arguments]"==c?"[object Object]":c);var l="[object Object]"==s&&!D(t),a="[object Object]"==c&&!D(e);if((c=s==c)&&!l)i||(i=new Wt),e=o||Jr(t)?Un(t,e,we,n,r,i):Fn(t,e,s,we,n,r,i);else{if(!(2&r)&&(o=l&&Pi.call(t,"__wrapped__"),s=a&&Pi.call(e,"__wrapped__"),o||s)){t=o?t.value():t,e=s?e.value():e,i||(i=new Wt),e=we(t,e,n,r,i);break t}if(c)e:if(i||(i=new Wt),o=2&r,s=ai(t),a=s.length,c=ai(e).length,a==c||o){for(l=a;l--;){var u=s[l];if(!(o?u in e:ve(e,u))){e=!1;break e}}if(c=i.get(t))e=c==e;else{c=!0,i.set(t,e);for(var h=o;++l<a;){var u=s[l],d=t[u],p=e[u];if(n)var f=o?n(p,d,u,e,t,i):n(d,p,u,t,e,i);if(f===G?d!==p&&!we(d,p,n,r,i):!f){c=!1;break}h||(h="constructor"==u)}c&&!h&&(n=t.constructor,r=e.constructor,n!=r&&"constructor"in t&&"constructor"in e&&!("function"==typeof n&&n instanceof n&&"function"==typeof r&&r instanceof r)&&(c=!1)),i.delete(t),e=c}}else e=!1;else e=!1}}return e}function Ee(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=Object(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){var s=n[i],c=s[0],l=t[c],u=s[1];if(a&&s[2]){if(l===G&&!(c in t))return!1}else{if(s=new Wt,r)var h=r(l,u,c,t,e,s);if(h===G?!we(u,l,r,3,s):!h)return!1}}return!0}function Me(t){return!(!Gr(t)||Ri&&Ri in t)&&(kr(t)||D(t)?Ui:yt).test(cr(t))}function Te(t){return"function"==typeof t?t:null==t?pi:"object"==typeof t?ya(t)?Ce(t[0],t[1]):Re(t):vi(t)}function Se(t){t=null==t?t:Object(t);var e,n=[];for(e in t)n.push(e);return n}function Ae(t,e){return e>t}function Le(t,e){var n=-1,r=Fr(t)?Array(t.length):[];return Mo(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function Re(t){var e=Hn(t);return 1==e.length&&e[0][2]?ir(e[0][0],e[0][1]):function(n){return n===t||Ee(n,t,e)}}function Ce(t,e){return er(t)&&e===e&&!Gr(e)?ir(sr(t),e):function(n){var r=ii(n,t);return r===G&&r===e?oi(n,t):we(e,r,G,3)}}function Pe(t,e,n,r,o){if(t!==e){if(!ya(e)&&!Jr(e))var a=si(e);i(a||e,function(i,s){if(a&&(s=i,i=e[s]),Gr(i)){o||(o=new Wt);var c=s,l=o,u=t[c],h=e[c],d=l.get(h);if(d)Zt(t,c,d);else{var d=r?r(u,h,c+"",t,e,l):G,p=d===G;p&&(d=h,ya(h)||Jr(h)?ya(u)?d=u:Br(u)?d=un(u):(p=!1,d=ne(h,!0)):Xr(h)||Ur(h)?Ur(u)?d=ni(u):!Gr(u)||n&&kr(u)?(p=!1,d=ne(h,!0)):d=u:p=!1),l.set(h,d),p&&Pe(d,h,n,r,l),l.delete(h),Zt(t,c,d)}}else c=r?r(t[s],i,s+"",t,e,o):G,c===G&&(c=i),Zt(t,s,c)})}}function Oe(t,e){var n=t.length;return n?(e+=0>e?n:0,Kn(e,n)?t[e]:G):void 0}function Ne(t,e,n){var r=-1;return e=u(e.length?e:[pi],T(kn())),t=Le(t,function(t){return{a:u(e,function(e){return e(t)}),b:++r,c:t}}),x(t,function(t,e){var r;t:{r=-1;for(var i=t.a,o=e.a,a=i.length,s=n.length;++r<a;){var c=sn(i[r],o[r]);if(c){r=r>=s?c:c*("desc"==n[r]?-1:1);break t}}r=t.b-e.b}return r})}function Ie(t,e){return t=Object(t),d(e,function(e,n){return n in t&&(e[n]=t[n]),e},{})}function De(t,e){for(var n=-1,r=me(t,si,Oo),i=r.length,o={};++n<i;){var a=r[n],s=t[a];e(s,a)&&(o[a]=s)}return o}function Ue(t){return function(e){return null==e?G:e[t]}}function Fe(t){return function(e){return fe(e,t)}}function Be(t,e,n,r){var i=r?y:v,o=-1,a=e.length,s=t;for(t===e&&(e=un(e)),n&&(s=u(t,T(n)));++o<a;)for(var c=0,l=e[o],l=n?n(l):l;-1<(c=i(s,l,c,r));)s!==t&&Xi.call(s,c,1),Xi.call(t,c,1);return t}function ze(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;if(Kn(i))Xi.call(t,i,1);else if(er(i,t))delete t[sr(i)];else{var i=nn(i),a=ar(t,i);null!=a&&delete a[sr(mr(i))]}}}}function ke(t,e){return t+Yi(no()*(e-t+1))}function je(t,e){var n="";if(!t||1>e||e>9007199254740991)return n;do e%2&&(n+=t),(e=Yi(e/2))&&(t+=t);while(e);return n}function He(t,e,n,r){e=er(e,t)?[e]:nn(e);for(var i=-1,o=e.length,a=o-1,s=t;null!=s&&++i<o;){var c=sr(e[i]);if(Gr(s)){var l=n;if(i!=a){var u=s[c],l=r?r(u,c,s):G;l===G&&(l=null==u?Kn(e[i+1])?[]:{}:u)}Jt(s,c,l)}s=s[c]}return t}function Ge(t,e,n){var r=-1,i=t.length;for(0>e&&(e=-e>i?0:i+e),n=n>i?i:n,0>n&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0,n=Array(i);++r<i;)n[r]=t[r+e];return n}function Ve(t,e){var n;return Mo(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function We(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e===e&&2147483647>=i){for(;i>r;){var o=r+i>>>1,a=t[o];null!==a&&!Zr(a)&&(n?e>=a:e>a)?r=o+1:i=o}return i}return Xe(t,e,pi,n)}function Xe(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,a=e!==e,s=null===e,c=Zr(e),l=e===G;o>i;){var u=Yi((i+o)/2),h=n(t[u]),d=h!==G,p=null===h,f=h===h,m=Zr(h);(a?r||f:l?f&&(r||d):s?f&&d&&(r||!p):c?f&&d&&!p&&(r||!m):p||m?0:r?e>=h:e>h)?i=u+1:o=u}return to(o,4294967294)}function qe(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Dr(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function Ye(t){return"number"==typeof t?t:Zr(t)?W:+t}function Ze(t){if("string"==typeof t)return t;if(Zr(t))return Eo?Eo.call(t):"";var e=t+"";return"0"==e&&1/t==-V?"-0":e}function Je(t,e,n){var r=-1,i=c,o=t.length,a=!0,s=[],u=s;if(n)a=!1,i=l;else if(o>=200){if(i=e?null:Ro(t))return B(i);a=!1,i=A,u=new Gt}else u=e?[]:s;t:for(;++r<o;){var h=t[r],d=e?e(h):h,h=n||0!==h?h:0;if(a&&d===d){for(var p=u.length;p--;)if(u[p]===d)continue t;e&&u.push(d),s.push(h)}else i(u,d,n)||(u!==s&&u.push(d),s.push(h))}return s}function $e(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Ge(t,r?0:o,r?o+1:i):Ge(t,r?o+1:0,r?i:o)}function Qe(t,e){var n=t;return n instanceof Ft&&(n=n.value()),d(e,function(t,e){return e.func.apply(e.thisArg,h([t],e.args))},n)}function Ke(t,e,n){for(var r=-1,i=t.length;++r<i;)var o=o?h(ae(o,t[r],e,n),ae(t[r],o,e,n)):t[r];return o&&o.length?Je(o,e,n):[]}function tn(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;)n(a,t[r],o>r?e[r]:G);return a}function en(t){return Br(t)?t:[]}function nn(t){return ya(t)?t:Do(t)}function rn(t,e,n){var r=t.length;return n=n===G?r:n,!e&&n>=r?t:Ge(t,e,n)}function on(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}function an(t){var e=new t.constructor(t.byteLength);return new ki(e).set(new ki(t)),e}function sn(t,e){if(t!==e){var n=t!==G,r=null===t,i=t===t,o=Zr(t),a=e!==G,s=null===e,c=e===e,l=Zr(e);if(!s&&!l&&!o&&t>e||o&&a&&c&&!s&&!l||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!l&&e>t||l&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return-1}return 0}function cn(t,e,n,r){var i=-1,o=t.length,a=n.length,s=-1,c=e.length,l=Ki(o-a,0),u=Array(c+l);for(r=!r;++s<c;)u[s]=e[s];for(;++i<a;)(r||o>i)&&(u[n[i]]=t[i]);for(;l--;)u[s++]=t[i++];return u}function ln(t,e,n,r){var i=-1,o=t.length,a=-1,s=n.length,c=-1,l=e.length,u=Ki(o-s,0),h=Array(u+l);for(r=!r;++i<u;)h[i]=t[i];for(u=i;++c<l;)h[u+c]=e[c];for(;++a<s;)(r||o>i)&&(h[u+n[a]]=t[i++]);return h}function un(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}function hn(t,e,n,r){n||(n={});for(var i=-1,o=e.length;++i<o;){var a=e[i],s=r?r(n[a],t[a],a,n,t):t[a];Jt(n,a,s)}return n}function dn(t,e){return hn(t,Vn(t),e)}function pn(t,e){return function(n,i){var o=ya(n)?r:Qt,a=e?e():{};return o(n,t,kn(i),a)}}function fn(t){return Ir(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:G,a=i>2?n[2]:G,o=t.length>3&&"function"==typeof o?(i--,o):G;for(a&&tr(n[0],n[1],a)&&(o=3>i?G:o,i=1),e=Object(e);++r<i;)(a=n[r])&&t(e,a,r,o);return e})}function mn(t,e){return function(n,r){if(null==n)return n;if(!Fr(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=Object(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function gn(t){return function(e,n,r){var i=-1,o=Object(e);r=r(e);for(var a=r.length;a--;){var s=r[t?a:++i];if(!1===n(o[s],s,o))break}return e}}function vn(t,e,n){function r(){return(this&&this!==qt&&this instanceof r?o:t).apply(i?n:this,arguments)}var i=1&e,o=bn(t);return r}function yn(t){return function(e){e=ri(e);var n=Pt.test(e)?e.match(Rt):G,r=n?n[0]:e.charAt(0);return e=n?rn(n,1).join(""):e.slice(1),r[t]()+e}}function _n(t){return function(e){return d(hi(ui(e).replace(At,"")),t,"")}}function bn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=ie(t.prototype),e=t.apply(n,e);return Gr(e)?e:n}}function xn(t,e,r){function i(){for(var a=arguments.length,s=Array(a),c=a,l=zn(i);c--;)s[c]=arguments[c];return c=3>a&&s[0]!==l&&s[a-1]!==l?[]:$(s,l),a-=c.length,r>a?On(t,e,Mn,i.placeholder,G,s,c,G,G,r-a):n(this&&this!==qt&&this instanceof i?o:t,this,s)}var o=bn(t);return i}function wn(t){return function(e,n,r){var i=Object(e);if(n=kn(n,3),!Fr(e))var o=ai(e);return r=t(o||e,function(t,e){return o&&(e=t,t=i[e]),n(t,e,i)},r),r>-1?e[o?o[r]:r]:G}}function En(t){return Ir(function(e){e=ue(e,1);var n=e.length,r=n,i=Ut.prototype.thru;for(t&&e.reverse();r--;){var o=e[r];if("function"!=typeof o)throw new Mi("Expected a function");if(i&&!a&&"wrapper"==Bn(o))var a=new Ut([],!0)}for(r=a?r:n;++r<n;)var o=e[r],i=Bn(o),s="wrapper"==i?Co(o):G,a=s&&nr(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?a[Bn(s[0])].apply(a,s[3]):1==o.length&&nr(o)?a[i]():a.thru(o);return function(){var t=arguments,r=t[0];if(a&&1==t.length&&ya(r)&&r.length>=200)return a.plant(r).value();for(var i=0,t=n?e[i].apply(this,t):r;++i<n;)t=e[i].call(this,t);return t}})}function Mn(t,e,n,r,i,o,a,s,c,l){function u(){for(var v=arguments.length,y=Array(v),_=v;_--;)y[_]=arguments[_];if(f){var b,x=zn(u),_=y.length;for(b=0;_--;)y[_]===x&&b++}if(r&&(y=cn(y,r,i,f)),o&&(y=ln(y,o,a,f)),v-=b,f&&l>v)return x=$(y,x),On(t,e,Mn,u.placeholder,n,y,x,s,c,l-v);if(x=d?n:this,_=p?x[t]:t,v=y.length,s){b=y.length;for(var w=to(s.length,b),E=un(y);w--;){var M=s[w];y[w]=Kn(M,b)?E[M]:G}}else m&&v>1&&y.reverse();return h&&v>c&&(y.length=c),this&&this!==qt&&this instanceof u&&(_=g||bn(_)),_.apply(x,y)}var h=128&e,d=1&e,p=2&e,f=24&e,m=512&e,g=p?G:bn(t);return u}function Tn(t,e){return function(n,r){return be(n,t,e(r))}}function Sn(t){return function(e,n){var r;if(e===G&&n===G)return 0;if(e!==G&&(r=e),n!==G){if(r===G)return n;"string"==typeof e||"string"==typeof n?(e=Ze(e),n=Ze(n)):(e=Ye(e),n=Ye(n)),r=t(e,n)}return r}}function An(t){return Ir(function(e){return e=1==e.length&&ya(e[0])?u(e[0],T(kn())):u(ue(e,1,Qn),T(kn())),Ir(function(r){var i=this;return t(e,function(t){return n(t,i,r)})})})}function Ln(t,e){e=e===G?" ":Ze(e);var n=e.length;return 2>n?n?je(e,t):e:(n=je(e,qi(t/k(e))),Pt.test(e)?rn(n.match(Rt),0,t).join(""):n.slice(0,t))}function Rn(t,e,r,i){function o(){for(var e=-1,c=arguments.length,l=-1,u=i.length,h=Array(u+c),d=this&&this!==qt&&this instanceof o?s:t;++l<u;)h[l]=i[l];for(;c--;)h[l++]=arguments[++e];return n(d,a?r:this,h)}var a=1&e,s=bn(t);return o}function Cn(t){return function(e,n,r){r&&"number"!=typeof r&&tr(e,n,r)&&(n=r=G),e=ei(e),e=e===e?e:0,n===G?(n=e,e=0):n=ei(n)||0,r=r===G?n>e?1:-1:ei(r)||0;var i=-1;n=Ki(qi((n-e)/(r||1)),0);for(var o=Array(n);n--;)o[t?n:++i]=e,e+=r;return o}}function Pn(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ei(e),n=ei(n)),t(e,n)}}function On(t,e,n,r,i,o,a,s,c,l){var u=8&e,h=u?a:G;a=u?G:a;var d=u?o:G;return o=u?G:o,e=(e|(u?32:64))&~(u?64:32),4&e||(e&=-4),e=[t,e,i,d,h,o,a,s,c,l],n=n.apply(G,e),nr(t)&&Io(n,e),n.placeholder=r,n}function Nn(t){var e=wi[t];return function(t,n){if(t=ei(t),n=to(Kr(n),292)){var r=(ri(t)+"e").split("e"),r=e(r[0]+"e"+(+r[1]+n)),r=(ri(r)+"e").split("e");return+(r[0]+"e"+(+r[1]-n))}return e(t)}}function In(t){return function(e){var n=Wn(e);return"[object Map]"==n?F(e):"[object Set]"==n?z(e):M(e,t(e))}}function Dn(t,e,n,r,i,o,a,s){var c=2&e;if(!c&&"function"!=typeof t)throw new Mi("Expected a function");var l=r?r.length:0;if(l||(e&=-97,r=i=G),a=a===G?a:Ki(Kr(a),0),s=s===G?s:Kr(s),l-=i?i.length:0,64&e){var u=r,h=i;r=i=G}var d=c?G:Co(t);return o=[t,e,n,r,i,u,h,o,a,s],d&&(n=o[1],t=d[1],e=n|t,r=128==t&&8==n||128==t&&256==n&&d[8]>=o[7].length||384==t&&d[8]>=d[7].length&&8==n,131>e||r)&&(1&t&&(o[2]=d[2],e|=1&n?0:4),(n=d[3])&&(r=o[3],o[3]=r?cn(r,n,d[4]):n,o[4]=r?$(o[3],"__lodash_placeholder__"):d[4]),(n=d[5])&&(r=o[5],o[5]=r?ln(r,n,d[6]):n,o[6]=r?$(o[5],"__lodash_placeholder__"):d[6]),(n=d[7])&&(o[7]=n),128&t&&(o[8]=null==o[8]?d[8]:to(o[8],d[8])),null==o[9]&&(o[9]=d[9]),o[0]=d[0],o[1]=e),t=o[0],e=o[1],n=o[2],r=o[3],i=o[4],s=o[9]=null==o[9]?c?0:t.length:Ki(o[9]-l,0),!s&&24&e&&(e&=-25),(d?Lo:Io)(e&&1!=e?8==e||16==e?xn(t,e,s):32!=e&&33!=e||i.length?Mn.apply(G,o):Rn(t,e,n,r):vn(t,e,n),o)}function Un(t,e,n,r,i,o){var a=2&i,s=t.length,c=e.length;if(s!=c&&!(a&&c>s))return!1;if(c=o.get(t))return c==e;var c=-1,l=!0,u=1&i?new Gt:G;for(o.set(t,e);++c<s;){var h=t[c],d=e[c];if(r)var p=a?r(d,h,c,e,t,o):r(h,d,c,t,e,o);if(p!==G){if(p)continue;l=!1;break}if(u){if(!f(e,function(t,e){return u.has(e)||h!==t&&!n(h,t,r,i,o)?void 0:u.add(e)})){l=!1;break}}else if(h!==d&&!n(h,d,r,i,o)){l=!1;break}}return o.delete(t),l}function Fn(t,e,n,r,i,o,a){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)break;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":if(t.byteLength!=e.byteLength||!r(new ki(t),new ki(e)))break;return!0;case"[object Boolean]":case"[object Date]":return+t==+e;case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object Number]":return t!=+t?e!=+e:t==+e;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=F;case"[object Set]":if(s||(s=B),t.size!=e.size&&!(2&o))break;return(n=a.get(t))?n==e:(o|=1,a.set(t,e),Un(s(t),s(e),r,i,o,a));case"[object Symbol]":if(wo)return wo.call(t)==wo.call(e)}return!1}function Bn(t){for(var e=t.name+"",n=mo[e],r=Pi.call(mo,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function zn(t){return(Pi.call(Tt,"placeholder")?Tt:t).placeholder}function kn(){var t=Tt.iteratee||fi,t=t===fi?Te:t;return arguments.length?t(arguments[0],arguments[1]):t}function jn(t,e){var n=t.__data__,r=typeof e;return("string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==e:null===e)?n["string"==typeof e?"string":"hash"]:n.map}function Hn(t){for(var e=ai(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,i===i&&!Gr(i)]}return e}function Gn(t,e){var n=null==t?G:t[e];return Me(n)?n:G}function Vn(t){return Hi(Object(t))}function Wn(t){return Ii.call(t)}function Xn(t,e,n){e=er(e,t)?[e]:nn(e);for(var r,i=-1,o=e.length;++i<o;){
var a=sr(e[i]);if(!(r=null!=t&&n(t,a)))break;t=t[a]}return r?r:(o=t?t.length:0,!!o&&Hr(o)&&Kn(a,o)&&(ya(t)||Yr(t)||Ur(t)))}function qn(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&Pi.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Yn(t){return"function"!=typeof t.constructor||rr(t)?{}:ie(Zi(Object(t)))}function Zn(n,r,i,o){var a=n.constructor;switch(r){case"[object ArrayBuffer]":return an(n);case"[object Boolean]":case"[object Date]":return new a(+n);case"[object DataView]":return r=o?an(n.buffer):n.buffer,new n.constructor(r,n.byteOffset,n.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return r=o?an(n.buffer):n.buffer,new n.constructor(r,n.byteOffset,n.length);case"[object Map]":return r=o?i(F(n),!0):F(n),d(r,t,new n.constructor);case"[object Number]":case"[object String]":return new a(n);case"[object RegExp]":return r=new n.constructor(n.source,ft.exec(n)),r.lastIndex=n.lastIndex,r;case"[object Set]":return r=o?i(B(n),!0):B(n),d(r,e,new n.constructor);case"[object Symbol]":return wo?Object(wo.call(n)):{}}}function Jn(t){var e=t?t.length:G;return Hr(e)&&(ya(t)||Yr(t)||Ur(t))?E(e,String):null}function $n(t){return ya(t)||Ur(t)}function Qn(t){return ya(t)&&!(2==t.length&&!kr(t[0]))}function Kn(t,e){return e=null==e?9007199254740991:e,!!e&&("number"==typeof t||bt.test(t))&&t>-1&&0==t%1&&e>t}function tr(t,e,n){if(!Gr(n))return!1;var r=typeof e;return!!("number"==r?Fr(n)&&Kn(e,n.length):"string"==r&&e in n)&&Dr(n[e],t)}function er(t,e){if(ya(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Zr(t))||(it.test(t)||!rt.test(t)||null!=e&&t in Object(e))}function nr(t){var e=Bn(t),n=Tt[e];return"function"==typeof n&&e in Ft.prototype&&(t===n||(e=Co(n),!!e&&t===e[0]))}function rr(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Si)}function ir(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==G||t in Object(n)))}}function or(t,e,n,r,i,o){return Gr(t)&&Gr(e)&&Pe(t,e,G,or,o.set(e,t)),t}function ar(t,e){return 1==e.length?t:fe(t,Ge(e,0,-1))}function sr(t){if("string"==typeof t||Zr(t))return t;var e=t+"";return"0"==e&&1/t==-V?"-0":e}function cr(t){if(null!=t){try{return Ci.call(t)}catch(t){}return t+""}return""}function lr(t){if(t instanceof Ft)return t.clone();var e=new Ut(t.__wrapped__,t.__chain__);return e.__actions__=un(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function ur(t,e,n){var r=t?t.length:0;return r?(e=n||e===G?1:Kr(e),Ge(t,0>e?0:e,r)):[]}function hr(t,e,n){var r=t?t.length:0;return r?(e=n||e===G?1:Kr(e),e=r-e,Ge(t,0,0>e?0:e)):[]}function dr(t,e,n){var r=t?t.length:0;return r?(n=null==n?0:Kr(n),0>n&&(n=Ki(r+n,0)),g(t,kn(e,3),n)):-1}function pr(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r-1;return n!==G&&(i=Kr(n),i=0>n?Ki(r+i,0):to(i,r-1)),g(t,kn(e,3),i,!0)}function fr(t){return t&&t.length?t[0]:G}function mr(t){var e=t?t.length:0;return e?t[e-1]:G}function gr(t,e){return t&&t.length&&e&&e.length?Be(t,e):t}function vr(t){return t?io.call(t):t}function yr(t){if(!t||!t.length)return[];var e=0;return t=s(t,function(t){return Br(t)?(e=Ki(t.length,e),!0):void 0}),E(e,function(e){return u(t,Ue(e))})}function _r(t,e){if(!t||!t.length)return[];var r=yr(t);return null==e?r:u(r,function(t){return n(e,G,t)})}function br(t){return t=Tt(t),t.__chain__=!0,t}function xr(t,e){return e(t)}function wr(){return this}function Er(t,e){return(ya(t)?i:Mo)(t,kn(e,3))}function Mr(t,e){return(ya(t)?o:To)(t,kn(e,3))}function Tr(t,e){return(ya(t)?u:Le)(t,kn(e,3))}function Sr(t,e,n){var r=-1,i=$r(t),o=i.length,a=o-1;for(e=(n?tr(t,e,n):e===G)?1:ee(Kr(e),0,o);++r<e;)t=ke(r,a),n=i[t],i[t]=i[r],i[r]=n;return i.length=e,i}function Ar(){return bi.now()}function Lr(t,e,n){return e=n?G:e,e=t&&null==e?t.length:e,Dn(t,128,G,G,G,G,e)}function Rr(t,e){var n;if("function"!=typeof e)throw new Mi("Expected a function");return t=Kr(t),function(){return 0<--t&&(n=e.apply(this,arguments)),1>=t&&(e=G),n}}function Cr(t,e,n){return e=n?G:e,t=Dn(t,8,G,G,G,G,G,e),t.placeholder=Cr.placeholder,t}function Pr(t,e,n){return e=n?G:e,t=Dn(t,16,G,G,G,G,G,e),t.placeholder=Pr.placeholder,t}function Or(t,e,n){function r(e){var n=c,r=l;return c=l=G,f=e,h=t.apply(r,n)}function i(t){var n=t-p;return t-=f,p===G||n>=e||0>n||g&&t>=u}function o(){var t=Ar();if(i(t))return a(t);var n;n=t-f,t=e-(t-p),n=g?to(t,u-n):t,d=Mt(o,n)}function a(t){return d=G,v&&c?r(t):(c=l=G,h)}function s(){var t=Ar(),n=i(t);if(c=arguments,l=this,p=t,n){if(d===G)return f=t=p,d=Mt(o,e),m?r(t):h;if(g)return d=Mt(o,e),r(p)}return d===G&&(d=Mt(o,e)),h}var c,l,u,h,d,p,f=0,m=!1,g=!1,v=!0;if("function"!=typeof t)throw new Mi("Expected a function");return e=ei(e)||0,Gr(n)&&(m=!!n.leading,u=(g="maxWait"in n)?Ki(ei(n.maxWait)||0,e):u,v="trailing"in n?!!n.trailing:v),s.cancel=function(){f=0,c=p=l=d=G},s.flush=function(){return d===G?h:a(Ar())},s}function Nr(t,e){function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;return o.has(i)?o.get(i):(r=t.apply(this,r),n.cache=o.set(i,r),r)}if("function"!=typeof t||e&&"function"!=typeof e)throw new Mi("Expected a function");return n.cache=new(Nr.Cache||Ht),n}function Ir(t,e){if("function"!=typeof t)throw new Mi("Expected a function");return e=Ki(e===G?t.length-1:Kr(e),0),function(){for(var r=arguments,i=-1,o=Ki(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];switch(e){case 0:return t.call(this,a);case 1:return t.call(this,r[0],a);case 2:return t.call(this,r[0],r[1],a)}for(o=Array(e+1),i=-1;++i<e;)o[i]=r[i];return o[e]=a,n(t,this,o)}}function Dr(t,e){return t===e||t!==t&&e!==e}function Ur(t){return Br(t)&&Pi.call(t,"callee")&&(!Wi.call(t,"callee")||"[object Arguments]"==Ii.call(t))}function Fr(t){return null!=t&&Hr(Po(t))&&!kr(t)}function Br(t){return Vr(t)&&Fr(t)}function zr(t){return!!Vr(t)&&("[object Error]"==Ii.call(t)||"string"==typeof t.message&&"string"==typeof t.name)}function kr(t){return t=Gr(t)?Ii.call(t):"","[object Function]"==t||"[object GeneratorFunction]"==t}function jr(t){return"number"==typeof t&&t==Kr(t)}function Hr(t){return"number"==typeof t&&t>-1&&0==t%1&&9007199254740991>=t}function Gr(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Vr(t){return!!t&&"object"==typeof t}function Wr(t){return"number"==typeof t||Vr(t)&&"[object Number]"==Ii.call(t)}function Xr(t){return!(!Vr(t)||"[object Object]"!=Ii.call(t)||D(t))&&(t=Zi(Object(t)),null===t||(t=Pi.call(t,"constructor")&&t.constructor,"function"==typeof t&&t instanceof t&&Ci.call(t)==Ni))}function qr(t){return Gr(t)&&"[object RegExp]"==Ii.call(t)}function Yr(t){return"string"==typeof t||!ya(t)&&Vr(t)&&"[object String]"==Ii.call(t)}function Zr(t){return"symbol"==typeof t||Vr(t)&&"[object Symbol]"==Ii.call(t)}function Jr(t){return Vr(t)&&Hr(t.length)&&!!It[Ii.call(t)]}function $r(t){if(!t)return[];if(Fr(t))return Yr(t)?t.match(Rt):un(t);if(Gi&&t[Gi])return U(t[Gi]());var e=Wn(t);return("[object Map]"==e?F:"[object Set]"==e?B:ci)(t)}function Qr(t){return t?(t=ei(t),t===V||t===-V?1.7976931348623157e308*(0>t?-1:1):t===t?t:0):0===t?t:0}function Kr(t){t=Qr(t);var e=t%1;return t===t?e?t-e:t:0}function ti(t){return t?ee(Kr(t),0,4294967295):0}function ei(t){if("number"==typeof t)return t;if(Zr(t))return W;if(Gr(t)&&(t=kr(t.valueOf)?t.valueOf():t,t=Gr(t)?t+"":t),"string"!=typeof t)return 0===t?t:+t;t=t.replace(ct,"");var e=vt.test(t);return e||_t.test(t)?jt(t.slice(2),e?2:8):gt.test(t)?W:+t}function ni(t){return hn(t,si(t))}function ri(t){return null==t?"":Ze(t)}function ii(t,e,n){return t=null==t?G:fe(t,e),t===G?n:t}function oi(t,e){return null!=t&&Xn(t,e,ye)}function ai(t){var e=rr(t);if(!e&&!Fr(t))return Qi(Object(t));var n,r=Jn(t),i=!!r,r=r||[],o=r.length;for(n in t)!ve(t,n)||i&&("length"==n||Kn(n,o))||e&&"constructor"==n||r.push(n);return r}function si(t){for(var e=-1,n=rr(t),r=Se(t),i=r.length,o=Jn(t),a=!!o,o=o||[],s=o.length;++e<i;){var c=r[e];a&&("length"==c||Kn(c,s))||"constructor"==c&&(n||!Pi.call(t,c))||o.push(c)}return o}function ci(t){return t?S(t,ai(t)):[]}function li(t){return Wa(ri(t).toLowerCase())}function ui(t){return(t=ri(t))&&t.replace(xt,P).replace(Lt,"")}function hi(t,e,n){return t=ri(t),e=n?G:e,e===G&&(e=Ot.test(t)?Ct:ht),t.match(e)||[]}function di(t){return function(){return t}}function pi(t){return t}function fi(t){return Te("function"==typeof t?t:ne(t,!0))}function mi(t,e,n){var r=ai(e),o=pe(e,r);null!=n||Gr(e)&&(o.length||!r.length)||(n=e,e=t,t=this,o=pe(e,ai(e)));var a=!(Gr(n)&&"chain"in n&&!n.chain),s=kr(t);return i(o,function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(a||e){var n=t(this.__wrapped__);return(n.__actions__=un(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,h([this.value()],arguments))})}),t}function gi(){}function vi(t){return er(t)?Ue(sr(t)):Fe(t)}function yi(){return[]}function _i(){return!1}C=C?Yt.defaults({},C,Yt.pick(qt,Nt)):qt;var bi=C.Date,xi=C.Error,wi=C.Math,Ei=C.RegExp,Mi=C.TypeError,Ti=C.Array.prototype,Si=C.Object.prototype,Ai=C.String.prototype,Li=C["__core-js_shared__"],Ri=function(){var t=/[^.]+$/.exec(Li&&Li.keys&&Li.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ci=C.Function.prototype.toString,Pi=Si.hasOwnProperty,Oi=0,Ni=Ci.call(Object),Ii=Si.toString,Di=qt._,Ui=Ei("^"+Ci.call(Pi).replace(at,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fi=Vt?C.Buffer:G,Bi=C.Reflect,zi=C.Symbol,ki=C.Uint8Array,ji=Bi?Bi.f:G,Hi=Object.getOwnPropertySymbols,Gi="symbol"==typeof(Gi=zi&&zi.iterator)?Gi:G,Vi=Object.create,Wi=Si.propertyIsEnumerable,Xi=Ti.splice,qi=wi.ceil,Yi=wi.floor,Zi=Object.getPrototypeOf,Ji=C.isFinite,$i=Ti.join,Qi=Object.keys,Ki=wi.max,to=wi.min,eo=C.parseInt,no=wi.random,ro=Ai.replace,io=Ti.reverse,oo=Ai.split,ao=Gn(C,"DataView"),so=Gn(C,"Map"),co=Gn(C,"Promise"),lo=Gn(C,"Set"),uo=Gn(C,"WeakMap"),ho=Gn(Object,"create"),po=uo&&new uo,fo=!Wi.call({valueOf:1},"valueOf"),mo={},go=cr(ao),vo=cr(so),yo=cr(co),_o=cr(lo),bo=cr(uo),xo=zi?zi.prototype:G,wo=xo?xo.valueOf:G,Eo=xo?xo.toString:G;Tt.templateSettings={escape:tt,evaluate:et,interpolate:nt,variable:"",imports:{_:Tt}},Tt.prototype=St.prototype,Tt.prototype.constructor=Tt,Ut.prototype=ie(St.prototype),Ut.prototype.constructor=Ut,Ft.prototype=ie(St.prototype),Ft.prototype.constructor=Ft,Bt.prototype.clear=function(){this.__data__=ho?ho(null):{}},Bt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Bt.prototype.get=function(t){var e=this.__data__;return ho?(t=e[t],"__lodash_hash_undefined__"===t?G:t):Pi.call(e,t)?e[t]:G},Bt.prototype.has=function(t){var e=this.__data__;return ho?e[t]!==G:Pi.call(e,t)},Bt.prototype.set=function(t,e){return this.__data__[t]=ho&&e===G?"__lodash_hash_undefined__":e,this},zt.prototype.clear=function(){this.__data__=[]},zt.prototype.delete=function(t){var e=this.__data__;return t=$t(e,t),!(0>t)&&(t==e.length-1?e.pop():Xi.call(e,t,1),!0)},zt.prototype.get=function(t){var e=this.__data__;return t=$t(e,t),0>t?G:e[t][1]},zt.prototype.has=function(t){return-1<$t(this.__data__,t)},zt.prototype.set=function(t,e){var n=this.__data__,r=$t(n,t);return 0>r?n.push([t,e]):n[r][1]=e,this},Ht.prototype.clear=function(){this.__data__={hash:new Bt,map:new(so||zt),string:new Bt}},Ht.prototype.delete=function(t){return jn(this,t).delete(t)},Ht.prototype.get=function(t){return jn(this,t).get(t)},Ht.prototype.has=function(t){return jn(this,t).has(t)},Ht.prototype.set=function(t,e){return jn(this,t).set(t,e),this},Gt.prototype.add=Gt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Gt.prototype.has=function(t){return this.__data__.has(t)},Wt.prototype.clear=function(){this.__data__=new zt},Wt.prototype.delete=function(t){return this.__data__.delete(t)},Wt.prototype.get=function(t){return this.__data__.get(t)},Wt.prototype.has=function(t){return this.__data__.has(t)},Wt.prototype.set=function(t,e){var n=this.__data__;return n instanceof zt&&200==n.__data__.length&&(n=this.__data__=new Ht(n.__data__)),n.set(t,e),this};var Mo=mn(he),To=mn(de,!0),So=gn(),Ao=gn(!0);ji&&!Wi.call({valueOf:1},"valueOf")&&(Se=function(t){return U(ji(t))});var Lo=po?function(t,e){return po.set(t,e),t}:pi,Ro=lo&&1/B(new lo([,-0]))[1]==V?function(t){return new lo(t)}:gi,Co=po?function(t){return po.get(t)}:gi,Po=Ue("length");Hi||(Vn=yi);var Oo=Hi?function(t){for(var e=[];t;)h(e,Vn(t)),t=Zi(Object(t));return e}:Vn;(ao&&"[object DataView]"!=Wn(new ao(new ArrayBuffer(1)))||so&&"[object Map]"!=Wn(new so)||co&&"[object Promise]"!=Wn(co.resolve())||lo&&"[object Set]"!=Wn(new lo)||uo&&"[object WeakMap]"!=Wn(new uo))&&(Wn=function(t){var e=Ii.call(t);if(t=(t="[object Object]"==e?t.constructor:G)?cr(t):G)switch(t){case go:return"[object DataView]";case vo:return"[object Map]";case yo:return"[object Promise]";case _o:return"[object Set]";case bo:return"[object WeakMap]"}return e});var No=Li?kr:_i,Io=function(){var t=0,e=0;return function(n,r){var i=Ar(),o=16-(i-e);if(e=i,o>0){if(150<=++t)return n}else t=0;return Lo(n,r)}}(),Do=Nr(function(t){var e=[];return ri(t).replace(ot,function(t,n,r,i){e.push(r?i.replace(dt,"$1"):n||t)}),e}),Uo=Ir(function(t,e){return Br(t)?ae(t,ue(e,1,Br,!0)):[]}),Fo=Ir(function(t,e){var n=mr(e);return Br(n)&&(n=G),Br(t)?ae(t,ue(e,1,Br,!0),kn(n)):[]}),Bo=Ir(function(t,e){var n=mr(e);return Br(n)&&(n=G),Br(t)?ae(t,ue(e,1,Br,!0),G,n):[]}),zo=Ir(function(t){var e=u(t,en);return e.length&&e[0]===t[0]?_e(e):[]}),ko=Ir(function(t){var e=mr(t),n=u(t,en);return e===mr(n)?e=G:n.pop(),n.length&&n[0]===t[0]?_e(n,kn(e)):[]}),jo=Ir(function(t){var e=mr(t),n=u(t,en);return e===mr(n)?e=G:n.pop(),n.length&&n[0]===t[0]?_e(n,G,e):[]}),Ho=Ir(gr),Go=Ir(function(t,e){e=ue(e,1);var n=t?t.length:0,r=te(t,e);return ze(t,u(e,function(t){return Kn(t,n)?+t:t}).sort(sn)),r}),Vo=Ir(function(t){return Je(ue(t,1,Br,!0))}),Wo=Ir(function(t){var e=mr(t);return Br(e)&&(e=G),Je(ue(t,1,Br,!0),kn(e))}),Xo=Ir(function(t){var e=mr(t);return Br(e)&&(e=G),Je(ue(t,1,Br,!0),G,e)}),qo=Ir(function(t,e){return Br(t)?ae(t,e):[]}),Yo=Ir(function(t){return Ke(s(t,Br))}),Zo=Ir(function(t){var e=mr(t);return Br(e)&&(e=G),Ke(s(t,Br),kn(e))}),Jo=Ir(function(t){var e=mr(t);return Br(e)&&(e=G),Ke(s(t,Br),G,e)}),$o=Ir(yr),Qo=Ir(function(t){var e=t.length,e=e>1?t[e-1]:G,e="function"==typeof e?(t.pop(),e):G;return _r(t,e)}),Ko=Ir(function(t){function e(e){return te(e,t)}t=ue(t,1);var n=t.length,r=n?t[0]:0,i=this.__wrapped__;return!(n>1||this.__actions__.length)&&i instanceof Ft&&Kn(r)?(i=i.slice(r,+r+(n?1:0)),i.__actions__.push({func:xr,args:[e],thisArg:G}),new Ut(i,this.__chain__).thru(function(t){return n&&!t.length&&t.push(G),t})):this.thru(e)}),ta=pn(function(t,e,n){Pi.call(t,n)?++t[n]:t[n]=1}),ea=wn(dr),na=wn(pr),ra=pn(function(t,e,n){Pi.call(t,n)?t[n].push(e):t[n]=[e]}),ia=Ir(function(t,e,r){var i=-1,o="function"==typeof e,a=er(e),s=Fr(t)?Array(t.length):[];return Mo(t,function(t){var c=o?e:a&&null!=t?t[e]:G;s[++i]=c?n(c,t,r):xe(t,e,r)}),s}),oa=pn(function(t,e,n){t[n]=e}),aa=pn(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),sa=Ir(function(t,e){if(null==t)return[];var n=e.length;return n>1&&tr(t,e[0],e[1])?e=[]:n>2&&tr(e[0],e[1],e[2])&&(e=[e[0]]),e=1==e.length&&ya(e[0])?e[0]:ue(e,1,Qn),Ne(t,e,[])}),ca=Ir(function(t,e,n){var r=1;if(n.length)var i=$(n,zn(ca)),r=32|r;return Dn(t,r,e,n,i)}),la=Ir(function(t,e,n){var r=3;if(n.length)var i=$(n,zn(la)),r=32|r;return Dn(e,r,t,n,i)}),ua=Ir(function(t,e){return oe(t,1,e)}),ha=Ir(function(t,e,n){return oe(t,ei(e)||0,n)});Nr.Cache=Ht;var da=Ir(function(t,e){e=1==e.length&&ya(e[0])?u(e[0],T(kn())):u(ue(e,1,Qn),T(kn()));var r=e.length;return Ir(function(i){for(var o=-1,a=to(i.length,r);++o<a;)i[o]=e[o].call(this,i[o]);return n(t,this,i)})}),pa=Ir(function(t,e){var n=$(e,zn(pa));return Dn(t,32,G,e,n)}),fa=Ir(function(t,e){var n=$(e,zn(fa));return Dn(t,64,G,e,n)}),ma=Ir(function(t,e){return Dn(t,256,G,G,G,ue(e,1))}),ga=Pn(ge),va=Pn(function(t,e){return t>=e}),ya=Array.isArray,_a=Fi?function(t){return t instanceof Fi}:_i,ba=Pn(Ae),xa=Pn(function(t,e){return e>=t}),wa=fn(function(t,e){if(fo||rr(e)||Fr(e))hn(e,ai(e),t);else for(var n in e)Pi.call(e,n)&&Jt(t,n,e[n])}),Ea=fn(function(t,e){if(fo||rr(e)||Fr(e))hn(e,si(e),t);else for(var n in e)Jt(t,n,e[n])}),Ma=fn(function(t,e,n,r){hn(e,si(e),t,r)}),Ta=fn(function(t,e,n,r){hn(e,ai(e),t,r)}),Sa=Ir(function(t,e){return te(t,ue(e,1))}),Aa=Ir(function(t){return t.push(G,Xt),n(Ma,G,t)}),La=Ir(function(t){return t.push(G,or),n(Na,G,t)}),Ra=Tn(function(t,e,n){t[e]=n},di(pi)),Ca=Tn(function(t,e,n){Pi.call(t,e)?t[e].push(n):t[e]=[n]},kn),Pa=Ir(xe),Oa=fn(function(t,e,n){Pe(t,e,n)}),Na=fn(function(t,e,n,r){Pe(t,e,n,r)}),Ia=Ir(function(t,e){return null==t?{}:(e=u(ue(e,1),sr),Ie(t,ae(me(t,si,Oo),e)))}),Da=Ir(function(t,e){return null==t?{}:Ie(t,u(ue(e,1),sr))}),Ua=In(ai),Fa=In(si),Ba=_n(function(t,e,n){return e=e.toLowerCase(),t+(n?li(e):e)}),za=_n(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),ka=_n(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),ja=yn("toLowerCase"),Ha=_n(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Ga=_n(function(t,e,n){return t+(n?" ":"")+Wa(e)}),Va=_n(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Wa=yn("toUpperCase"),Xa=Ir(function(t,e){try{return n(t,G,e)}catch(t){return zr(t)?t:new xi(t)}}),qa=Ir(function(t,e){return i(ue(e,1),function(e){e=sr(e),t[e]=ca(t[e],t)}),t}),Ya=En(),Za=En(!0),Ja=Ir(function(t,e){return function(n){return xe(n,t,e)}}),$a=Ir(function(t,e){return function(n){return xe(t,n,e)}}),Qa=An(u),Ka=An(a),ts=An(f),es=Cn(),ns=Cn(!0),rs=Sn(function(t,e){return t+e}),is=Nn("ceil"),os=Sn(function(t,e){return t/e}),as=Nn("floor"),ss=Sn(function(t,e){return t*e}),cs=Nn("round"),ls=Sn(function(t,e){return t-e});return Tt.after=function(t,e){if("function"!=typeof e)throw new Mi("Expected a function");return t=Kr(t),function(){return 1>--t?e.apply(this,arguments):void 0}},Tt.ary=Lr,Tt.assign=wa,Tt.assignIn=Ea,Tt.assignInWith=Ma,Tt.assignWith=Ta,Tt.at=Sa,Tt.before=Rr,Tt.bind=ca,Tt.bindAll=qa,Tt.bindKey=la,Tt.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return ya(t)?t:[t]},Tt.chain=br,Tt.chunk=function(t,e,n){if(e=(n?tr(t,e,n):e===G)?1:Ki(Kr(e),0),n=t?t.length:0,!n||1>e)return[];for(var r=0,i=0,o=Array(qi(n/e));n>r;)o[i++]=Ge(t,r,r+=e);return o},Tt.compact=function(t){for(var e=-1,n=t?t.length:0,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},Tt.concat=function(){for(var t=arguments.length,e=Array(t?t-1:0),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return t?h(ya(n)?un(n):[n],ue(e,1)):[]},Tt.cond=function(t){var e=t?t.length:0,r=kn();return t=e?u(t,function(t){if("function"!=typeof t[1])throw new Mi("Expected a function");return[r(t[0]),t[1]]}):[],Ir(function(r){for(var i=-1;++i<e;){var o=t[i];if(n(o[0],this,r))return n(o[1],this,r)}})},Tt.conforms=function(t){return re(ne(t,!0))},Tt.constant=di,Tt.countBy=ta,Tt.create=function(t,e){var n=ie(t);return e?Kt(n,e):n},Tt.curry=Cr,Tt.curryRight=Pr,Tt.debounce=Or,Tt.defaults=Aa,Tt.defaultsDeep=La,Tt.defer=ua,Tt.delay=ha,Tt.difference=Uo,Tt.differenceBy=Fo,Tt.differenceWith=Bo,Tt.drop=ur,Tt.dropRight=hr,Tt.dropRightWhile=function(t,e){return t&&t.length?$e(t,kn(e,3),!0,!0):[]},Tt.dropWhile=function(t,e){return t&&t.length?$e(t,kn(e,3),!0):[]},Tt.fill=function(t,e,n,r){var i=t?t.length:0;if(!i)return[];for(n&&"number"!=typeof n&&tr(t,e,n)&&(n=0,r=i),i=t.length,n=Kr(n),0>n&&(n=-n>i?0:i+n),r=r===G||r>i?i:Kr(r),0>r&&(r+=i),r=n>r?0:ti(r);r>n;)t[n++]=e;return t},Tt.filter=function(t,e){return(ya(t)?s:le)(t,kn(e,3))},Tt.flatMap=function(t,e){return ue(Tr(t,e),1)},Tt.flatMapDeep=function(t,e){return ue(Tr(t,e),V)},Tt.flatMapDepth=function(t,e,n){return n=n===G?1:Kr(n),ue(Tr(t,e),n)},Tt.flatten=function(t){return t&&t.length?ue(t,1):[]},Tt.flattenDeep=function(t){return t&&t.length?ue(t,V):[]},Tt.flattenDepth=function(t,e){return t&&t.length?(e=e===G?1:Kr(e),ue(t,e)):[]},Tt.flip=function(t){return Dn(t,512)},Tt.flow=Ya,Tt.flowRight=Za,Tt.fromPairs=function(t){for(var e=-1,n=t?t.length:0,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Tt.functions=function(t){return null==t?[]:pe(t,ai(t))},Tt.functionsIn=function(t){return null==t?[]:pe(t,si(t))},Tt.groupBy=ra,Tt.initial=function(t){return hr(t,1)},Tt.intersection=zo,Tt.intersectionBy=ko,Tt.intersectionWith=jo,Tt.invert=Ra,Tt.invertBy=Ca,Tt.invokeMap=ia,Tt.iteratee=fi,Tt.keyBy=oa,Tt.keys=ai,Tt.keysIn=si,Tt.map=Tr,Tt.mapKeys=function(t,e){var n={};return e=kn(e,3),he(t,function(t,r,i){n[e(t,r,i)]=t}),n},Tt.mapValues=function(t,e){var n={};return e=kn(e,3),he(t,function(t,r,i){n[r]=e(t,r,i)}),n},Tt.matches=function(t){return Re(ne(t,!0))},Tt.matchesProperty=function(t,e){return Ce(t,ne(e,!0))},Tt.memoize=Nr,Tt.merge=Oa,Tt.mergeWith=Na,Tt.method=Ja,Tt.methodOf=$a,Tt.mixin=mi,Tt.negate=function(t){if("function"!=typeof t)throw new Mi("Expected a function");return function(){return!t.apply(this,arguments)}},Tt.nthArg=function(t){return t=Kr(t),Ir(function(e){return Oe(e,t)})},Tt.omit=Ia,Tt.omitBy=function(t,e){return e=kn(e),De(t,function(t,n){return!e(t,n)})},Tt.once=function(t){return Rr(2,t)},Tt.orderBy=function(t,e,n,r){return null==t?[]:(ya(e)||(e=null==e?[]:[e]),n=r?G:n,ya(n)||(n=null==n?[]:[n]),Ne(t,e,n))},Tt.over=Qa,Tt.overArgs=da,Tt.overEvery=Ka,Tt.overSome=ts,Tt.partial=pa,Tt.partialRight=fa,Tt.partition=aa,Tt.pick=Da,Tt.pickBy=function(t,e){return null==t?{}:De(t,kn(e))},Tt.property=vi,Tt.propertyOf=function(t){return function(e){return null==t?G:fe(t,e)}},Tt.pull=Ho,Tt.pullAll=gr,Tt.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Be(t,e,kn(n)):t},Tt.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Be(t,e,G,n):t},Tt.pullAt=Go,Tt.range=es,Tt.rangeRight=ns,Tt.rearg=ma,Tt.reject=function(t,e){var n=ya(t)?s:le;return e=kn(e,3),n(t,function(t,n,r){return!e(t,n,r)})},Tt.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=kn(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return ze(t,i),n},Tt.rest=Ir,Tt.reverse=vr,Tt.sampleSize=Sr,Tt.set=function(t,e,n){return null==t?t:He(t,e,n)},Tt.setWith=function(t,e,n,r){return r="function"==typeof r?r:G,null==t?t:He(t,e,n,r)},Tt.shuffle=function(t){return Sr(t,4294967295)},Tt.slice=function(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&tr(t,e,n)?(e=0,n=r):(e=null==e?0:Kr(e),n=n===G?r:Kr(n)),Ge(t,e,n)):[]},Tt.sortBy=sa,Tt.sortedUniq=function(t){return t&&t.length?qe(t):[]},Tt.sortedUniqBy=function(t,e){return t&&t.length?qe(t,kn(e)):[]},Tt.split=function(t,e,n){return n&&"number"!=typeof n&&tr(t,e,n)&&(e=n=G),n=n===G?4294967295:n>>>0,n?(t=ri(t))&&("string"==typeof e||null!=e&&!qr(e))&&(e=Ze(e),""==e&&Pt.test(t))?rn(t.match(Rt),0,n):oo.call(t,e,n):[]},Tt.spread=function(t,e){if("function"!=typeof t)throw new Mi("Expected a function");return e=e===G?0:Ki(Kr(e),0),Ir(function(r){var i=r[e];return r=rn(r,0,e),i&&h(r,i),n(t,this,r)})},Tt.tail=function(t){return ur(t,1)},Tt.take=function(t,e,n){return t&&t.length?(e=n||e===G?1:Kr(e),Ge(t,0,0>e?0:e)):[]},Tt.takeRight=function(t,e,n){var r=t?t.length:0;return r?(e=n||e===G?1:Kr(e),e=r-e,Ge(t,0>e?0:e,r)):[]},Tt.takeRightWhile=function(t,e){return t&&t.length?$e(t,kn(e,3),!1,!0):[]},Tt.takeWhile=function(t,e){return t&&t.length?$e(t,kn(e,3)):[]},Tt.tap=function(t,e){return e(t),t},Tt.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Mi("Expected a function");return Gr(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Or(t,e,{leading:r,maxWait:e,trailing:i})},Tt.thru=xr,Tt.toArray=$r,Tt.toPairs=Ua,Tt.toPairsIn=Fa,Tt.toPath=function(t){return ya(t)?u(t,sr):Zr(t)?[t]:un(Do(t))},Tt.toPlainObject=ni,Tt.transform=function(t,e,n){var r=ya(t)||Jr(t);if(e=kn(e,4),null==n)if(r||Gr(t)){var o=t.constructor;n=r?ya(t)?new o:[]:kr(o)?ie(Zi(Object(t))):{}}else n={};return(r?i:he)(t,function(t,r,i){return e(n,t,r,i)}),n},Tt.unary=function(t){return Lr(t,1)},Tt.union=Vo,Tt.unionBy=Wo,Tt.unionWith=Xo,Tt.uniq=function(t){return t&&t.length?Je(t):[]},Tt.uniqBy=function(t,e){return t&&t.length?Je(t,kn(e)):[]},Tt.uniqWith=function(t,e){return t&&t.length?Je(t,G,e):[]},Tt.unset=function(t,e){var n;if(null==t)n=!0;else{n=t;var r=e,r=er(r,n)?[r]:nn(r);n=ar(n,r),r=sr(mr(r)),n=!(null!=n&&ve(n,r))||delete n[r]}return n},Tt.unzip=yr,Tt.unzipWith=_r,Tt.update=function(t,e,n){return null==t?t:He(t,e,("function"==typeof n?n:pi)(fe(t,e)),void 0)},Tt.updateWith=function(t,e,n,r){return r="function"==typeof r?r:G,null!=t&&(t=He(t,e,("function"==typeof n?n:pi)(fe(t,e)),r)),t},Tt.values=ci,Tt.valuesIn=function(t){return null==t?[]:S(t,si(t))},Tt.without=qo,Tt.words=hi,Tt.wrap=function(t,e){return e=null==e?pi:e,pa(e,t)},Tt.xor=Yo,Tt.xorBy=Zo,Tt.xorWith=Jo,Tt.zip=$o,Tt.zipObject=function(t,e){return tn(t||[],e||[],Jt)},Tt.zipObjectDeep=function(t,e){return tn(t||[],e||[],He)},Tt.zipWith=Qo,Tt.entries=Ua,Tt.entriesIn=Fa,Tt.extend=Ea,Tt.extendWith=Ma,mi(Tt,Tt),Tt.add=rs,Tt.attempt=Xa,Tt.camelCase=Ba,Tt.capitalize=li,Tt.ceil=is,Tt.clamp=function(t,e,n){return n===G&&(n=e,e=G),n!==G&&(n=ei(n),n=n===n?n:0),e!==G&&(e=ei(e),e=e===e?e:0),ee(ei(t),e,n)},Tt.clone=function(t){return ne(t,!1,!0)},Tt.cloneDeep=function(t){return ne(t,!0,!0)},Tt.cloneDeepWith=function(t,e){return ne(t,!0,!0,e)},Tt.cloneWith=function(t,e){return ne(t,!1,!0,e)},Tt.deburr=ui,Tt.divide=os,Tt.endsWith=function(t,e,n){t=ri(t),e=Ze(e);var r=t.length;return n=n===G?r:ee(Kr(n),0,r),n-=e.length,n>=0&&t.indexOf(e,n)==n},Tt.eq=Dr,Tt.escape=function(t){return(t=ri(t))&&K.test(t)?t.replace(J,O):t},Tt.escapeRegExp=function(t){return(t=ri(t))&&st.test(t)?t.replace(at,"\\$&"):t},Tt.every=function(t,e,n){var r=ya(t)?a:se;return n&&tr(t,e,n)&&(e=G),r(t,kn(e,3))},Tt.find=ea,Tt.findIndex=dr,Tt.findKey=function(t,e){return m(t,kn(e,3),he)},Tt.findLast=na,Tt.findLastIndex=pr,Tt.findLastKey=function(t,e){return m(t,kn(e,3),de)},Tt.floor=as,Tt.forEach=Er,Tt.forEachRight=Mr,Tt.forIn=function(t,e){return null==t?t:So(t,kn(e,3),si)},Tt.forInRight=function(t,e){return null==t?t:Ao(t,kn(e,3),si)},Tt.forOwn=function(t,e){return t&&he(t,kn(e,3))},Tt.forOwnRight=function(t,e){return t&&de(t,kn(e,3))},Tt.get=ii,Tt.gt=ga,Tt.gte=va,Tt.has=function(t,e){return null!=t&&Xn(t,e,ve)},Tt.hasIn=oi,Tt.head=fr,Tt.identity=pi,Tt.includes=function(t,e,n,r){return t=Fr(t)?t:ci(t),n=n&&!r?Kr(n):0,r=t.length,0>n&&(n=Ki(r+n,0)),Yr(t)?r>=n&&-1<t.indexOf(e,n):!!r&&-1<v(t,e,n)},Tt.indexOf=function(t,e,n){var r=t?t.length:0;return r?(n=null==n?0:Kr(n),0>n&&(n=Ki(r+n,0)),v(t,e,n)):-1},Tt.inRange=function(t,e,n){return e=ei(e)||0,n===G?(n=e,e=0):n=ei(n)||0,t=ei(t),t>=to(e,n)&&t<Ki(e,n)},Tt.invoke=Pa,Tt.isArguments=Ur,Tt.isArray=ya,Tt.isArrayBuffer=function(t){return Vr(t)&&"[object ArrayBuffer]"==Ii.call(t)},Tt.isArrayLike=Fr,Tt.isArrayLikeObject=Br,Tt.isBoolean=function(t){return!0===t||!1===t||Vr(t)&&"[object Boolean]"==Ii.call(t)},Tt.isBuffer=_a,Tt.isDate=function(t){return Vr(t)&&"[object Date]"==Ii.call(t)},Tt.isElement=function(t){return!!t&&1===t.nodeType&&Vr(t)&&!Xr(t)},Tt.isEmpty=function(t){if(Fr(t)&&(ya(t)||Yr(t)||kr(t.splice)||Ur(t)||_a(t)))return!t.length;if(Vr(t)){var e=Wn(t);if("[object Map]"==e||"[object Set]"==e)return!t.size}for(var n in t)if(Pi.call(t,n))return!1;return!(fo&&ai(t).length)},Tt.isEqual=function(t,e){return we(t,e)},Tt.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:G)?n(t,e):G;return r===G?we(t,e,n):!!r},Tt.isError=zr,Tt.isFinite=function(t){return"number"==typeof t&&Ji(t)},Tt.isFunction=kr,Tt.isInteger=jr,Tt.isLength=Hr,Tt.isMap=function(t){return Vr(t)&&"[object Map]"==Wn(t)},Tt.isMatch=function(t,e){return t===e||Ee(t,e,Hn(e))},Tt.isMatchWith=function(t,e,n){return n="function"==typeof n?n:G,Ee(t,e,Hn(e),n)},Tt.isNaN=function(t){return Wr(t)&&t!=+t},Tt.isNative=function(t){if(No(t))throw new xi("This method is not supported with `core-js`. Try https://github.com/es-shims.");return Me(t)},Tt.isNil=function(t){return null==t},Tt.isNull=function(t){return null===t},Tt.isNumber=Wr,Tt.isObject=Gr,Tt.isObjectLike=Vr,Tt.isPlainObject=Xr,Tt.isRegExp=qr,Tt.isSafeInteger=function(t){return jr(t)&&t>=-9007199254740991&&9007199254740991>=t},Tt.isSet=function(t){return Vr(t)&&"[object Set]"==Wn(t)},Tt.isString=Yr,Tt.isSymbol=Zr,Tt.isTypedArray=Jr,Tt.isUndefined=function(t){return t===G},Tt.isWeakMap=function(t){return Vr(t)&&"[object WeakMap]"==Wn(t)},Tt.isWeakSet=function(t){return Vr(t)&&"[object WeakSet]"==Ii.call(t)},Tt.join=function(t,e){return t?$i.call(t,e):""},Tt.kebabCase=za,Tt.last=mr,Tt.lastIndexOf=function(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if(n!==G&&(i=Kr(n),i=(0>i?Ki(r+i,0):to(i,r-1))+1),e!==e)return I(t,i-1,!0);for(;i--;)if(t[i]===e)return i;return-1},Tt.lowerCase=ka,Tt.lowerFirst=ja,Tt.lt=ba,Tt.lte=xa,Tt.max=function(t){return t&&t.length?ce(t,pi,ge):G},Tt.maxBy=function(t,e){return t&&t.length?ce(t,kn(e),ge):G},Tt.mean=function(t){return _(t,pi)},Tt.meanBy=function(t,e){return _(t,kn(e))},Tt.min=function(t){return t&&t.length?ce(t,pi,Ae):G},Tt.minBy=function(t,e){return t&&t.length?ce(t,kn(e),Ae):G},Tt.stubArray=yi,Tt.stubFalse=_i,Tt.stubObject=function(){return{}},Tt.stubString=function(){return""},Tt.stubTrue=function(){return!0},Tt.multiply=ss,Tt.nth=function(t,e){return t&&t.length?Oe(t,Kr(e)):G},Tt.noConflict=function(){return qt._===this&&(qt._=Di),this},Tt.noop=gi,Tt.now=Ar,Tt.pad=function(t,e,n){t=ri(t);var r=(e=Kr(e))?k(t):0;return!e||r>=e?t:(e=(e-r)/2,Ln(Yi(e),n)+t+Ln(qi(e),n))},Tt.padEnd=function(t,e,n){t=ri(t);var r=(e=Kr(e))?k(t):0;return e&&e>r?t+Ln(e-r,n):t},Tt.padStart=function(t,e,n){t=ri(t);var r=(e=Kr(e))?k(t):0;return e&&e>r?Ln(e-r,n)+t:t},Tt.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),t=ri(t).replace(ct,""),eo(t,e||(mt.test(t)?16:10))},Tt.random=function(t,e,n){if(n&&"boolean"!=typeof n&&tr(t,e,n)&&(e=n=G),n===G&&("boolean"==typeof e?(n=e,e=G):"boolean"==typeof t&&(n=t,t=G)),t===G&&e===G?(t=0,e=1):(t=ei(t)||0,e===G?(e=t,t=0):e=ei(e)||0),t>e){var r=t;t=e,e=r}return n||t%1||e%1?(n=no(),to(t+n*(e-t+kt("1e-"+((n+"").length-1))),e)):ke(t,e)},Tt.reduce=function(t,e,n){var r=ya(t)?d:b,i=3>arguments.length;return r(t,kn(e,4),n,i,Mo)},Tt.reduceRight=function(t,e,n){var r=ya(t)?p:b,i=3>arguments.length;return r(t,kn(e,4),n,i,To)},Tt.repeat=function(t,e,n){return e=(n?tr(t,e,n):e===G)?1:Kr(e),je(ri(t),e)},Tt.replace=function(){var t=arguments,e=ri(t[0]);return 3>t.length?e:ro.call(e,t[1],t[2])},Tt.result=function(t,e,n){e=er(e,t)?[e]:nn(e);var r=-1,i=e.length;for(i||(t=G,i=1);++r<i;){var o=null==t?G:t[sr(e[r])];o===G&&(r=i,o=n),t=kr(o)?o.call(t):o}return t},Tt.round=cs,Tt.runInContext=H,Tt.sample=function(t){t=Fr(t)?t:ci(t);var e=t.length;return e>0?t[ke(0,e-1)]:G},Tt.size=function(t){if(null==t)return 0;if(Fr(t)){var e=t.length;return e&&Yr(t)?k(t):e}return Vr(t)&&(e=Wn(t),"[object Map]"==e||"[object Set]"==e)?t.size:ai(t).length},Tt.snakeCase=Ha,Tt.some=function(t,e,n){var r=ya(t)?f:Ve;return n&&tr(t,e,n)&&(e=G),r(t,kn(e,3))},Tt.sortedIndex=function(t,e){return We(t,e)},Tt.sortedIndexBy=function(t,e,n){return Xe(t,e,kn(n))},Tt.sortedIndexOf=function(t,e){var n=t?t.length:0;if(n){var r=We(t,e);if(n>r&&Dr(t[r],e))return r}return-1},Tt.sortedLastIndex=function(t,e){return We(t,e,!0)},Tt.sortedLastIndexBy=function(t,e,n){return Xe(t,e,kn(n),!0)},Tt.sortedLastIndexOf=function(t,e){if(t&&t.length){var n=We(t,e,!0)-1;if(Dr(t[n],e))return n}return-1},Tt.startCase=Ga,Tt.startsWith=function(t,e,n){return t=ri(t),n=ee(Kr(n),0,t.length),t.lastIndexOf(Ze(e),n)==n},Tt.subtract=ls,Tt.sum=function(t){return t&&t.length?w(t,pi):0},Tt.sumBy=function(t,e){return t&&t.length?w(t,kn(e)):0},Tt.template=function(t,e,n){var r=Tt.templateSettings;n&&tr(t,e,n)&&(e=G),t=ri(t),e=Ma({},e,r,Xt),n=Ma({},e.imports,r.imports,Xt);var i,o,a=ai(n),s=S(n,a),c=0;n=e.interpolate||wt;var l="__p+='";n=Ei((e.escape||wt).source+"|"+n.source+"|"+(n===nt?pt:wt).source+"|"+(e.evaluate||wt).source+"|$","g");var u="sourceURL"in e?"//# sourceURL="+e.sourceURL+"\n":"";
if(t.replace(n,function(e,n,r,a,s,u){return r||(r=a),l+=t.slice(c,u).replace(Et,N),n&&(i=!0,l+="'+__e("+n+")+'"),s&&(o=!0,l+="';"+s+";\n__p+='"),r&&(l+="'+((__t=("+r+"))==null?'':__t)+'"),c=u+e.length,e}),l+="';",(e=e.variable)||(l="with(obj){"+l+"}"),l=(o?l.replace(X,""):l).replace(q,"$1").replace(Y,"$1;"),l="function("+(e||"obj")+"){"+(e?"":"obj||(obj={});")+"var __t,__p=''"+(i?",__e=_.escape":"")+(o?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+l+"return __p}",e=Xa(function(){return Function(a,u+"return "+l).apply(G,s)}),e.source=l,zr(e))throw e;return e},Tt.times=function(t,e){if(t=Kr(t),1>t||t>9007199254740991)return[];var n=4294967295,r=to(t,4294967295);for(e=kn(e),t-=4294967295,r=E(r,e);++n<t;)e(n);return r},Tt.toFinite=Qr,Tt.toInteger=Kr,Tt.toLength=ti,Tt.toLower=function(t){return ri(t).toLowerCase()},Tt.toNumber=ei,Tt.toSafeInteger=function(t){return ee(Kr(t),-9007199254740991,9007199254740991)},Tt.toString=ri,Tt.toUpper=function(t){return ri(t).toUpperCase()},Tt.trim=function(t,e,n){return(t=ri(t))&&(n||e===G)?t.replace(ct,""):t&&(e=Ze(e))?(t=t.match(Rt),e=e.match(Rt),rn(t,L(t,e),R(t,e)+1).join("")):t},Tt.trimEnd=function(t,e,n){return(t=ri(t))&&(n||e===G)?t.replace(ut,""):t&&(e=Ze(e))?(t=t.match(Rt),e=R(t,e.match(Rt))+1,rn(t,0,e).join("")):t},Tt.trimStart=function(t,e,n){return(t=ri(t))&&(n||e===G)?t.replace(lt,""):t&&(e=Ze(e))?(t=t.match(Rt),e=L(t,e.match(Rt)),rn(t,e).join("")):t},Tt.truncate=function(t,e){var n=30,r="...";if(Gr(e))var i="separator"in e?e.separator:i,n="length"in e?Kr(e.length):n,r="omission"in e?Ze(e.omission):r;t=ri(t);var o=t.length;if(Pt.test(t))var a=t.match(Rt),o=a.length;if(n>=o)return t;if(o=n-k(r),1>o)return r;if(n=a?rn(a,0,o).join(""):t.slice(0,o),i===G)return n+r;if(a&&(o+=n.length-o),qr(i)){if(t.slice(o).search(i)){var s=n;for(i.global||(i=Ei(i.source,ri(ft.exec(i))+"g")),i.lastIndex=0;a=i.exec(s);)var c=a.index;n=n.slice(0,c===G?o:c)}}else t.indexOf(Ze(i),o)!=o&&(i=n.lastIndexOf(i),i>-1&&(n=n.slice(0,i)));return n+r},Tt.unescape=function(t){return(t=ri(t))&&Q.test(t)?t.replace(Z,j):t},Tt.uniqueId=function(t){var e=++Oi;return ri(t)+e},Tt.upperCase=Va,Tt.upperFirst=Wa,Tt.each=Er,Tt.eachRight=Mr,Tt.first=fr,mi(Tt,function(){var t={};return he(Tt,function(e,n){Pi.call(Tt.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),Tt.VERSION="4.13.1",i("bind bindKey curry curryRight partial partialRight".split(" "),function(t){Tt[t].placeholder=Tt}),i(["drop","take"],function(t,e){Ft.prototype[t]=function(n){var r=this.__filtered__;if(r&&!e)return new Ft(this);n=n===G?1:Ki(Kr(n),0);var i=this.clone();return r?i.__takeCount__=to(n,i.__takeCount__):i.__views__.push({size:to(n,4294967295),type:t+(0>i.__dir__?"Right":"")}),i},Ft.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),i(["filter","map","takeWhile"],function(t,e){var n=e+1,r=1==n||3==n;Ft.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:kn(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),i(["head","last"],function(t,e){var n="take"+(e?"Right":"");Ft.prototype[t]=function(){return this[n](1).value()[0]}}),i(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");Ft.prototype[t]=function(){return this.__filtered__?new Ft(this):this[n](1)}}),Ft.prototype.compact=function(){return this.filter(pi)},Ft.prototype.find=function(t){return this.filter(t).head()},Ft.prototype.findLast=function(t){return this.reverse().find(t)},Ft.prototype.invokeMap=Ir(function(t,e){return"function"==typeof t?new Ft(this):this.map(function(n){return xe(n,t,e)})}),Ft.prototype.reject=function(t){return t=kn(t,3),this.filter(function(e){return!t(e)})},Ft.prototype.slice=function(t,e){t=Kr(t);var n=this;return n.__filtered__&&(t>0||0>e)?new Ft(n):(0>t?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==G&&(e=Kr(e),n=0>e?n.dropRight(-e):n.take(e-t)),n)},Ft.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ft.prototype.toArray=function(){return this.take(4294967295)},he(Ft.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=Tt[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(Tt.prototype[e]=function(){function e(t){return t=i.apply(Tt,h([t],s)),r&&d?t[0]:t}var a=this.__wrapped__,s=r?[1]:arguments,c=a instanceof Ft,l=s[0],u=c||ya(a);u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var d=this.__chain__,p=!!this.__actions__.length,l=o&&!d,c=c&&!p;return!o&&u?(a=c?a:new Ft(this),a=t.apply(a,s),a.__actions__.push({func:xr,args:[e],thisArg:G}),new Ut(a,d)):l&&c?t.apply(this,s):(a=this.thru(e),l?r?a.value()[0]:a.value():a)})}),i("pop push shift sort splice unshift".split(" "),function(t){var e=Ti[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Tt.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(ya(i)?i:[],t)}return this[n](function(n){return e.apply(ya(n)?n:[],t)})}}),he(Ft.prototype,function(t,e){var n=Tt[e];if(n){var r=n.name+"";(mo[r]||(mo[r]=[])).push({name:e,func:n})}}),mo[Mn(G,2).name]=[{name:"wrapper",func:G}],Ft.prototype.clone=function(){var t=new Ft(this.__wrapped__);return t.__actions__=un(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=un(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=un(this.__views__),t},Ft.prototype.reverse=function(){if(this.__filtered__){var t=new Ft(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t},Ft.prototype.value=function(){var t,e=this.__wrapped__.value(),n=this.__dir__,r=ya(e),i=0>n,o=r?e.length:0;t=o;for(var a=this.__views__,s=0,c=-1,l=a.length;++c<l;){var u=a[c],h=u.size;switch(u.type){case"drop":s+=h;break;case"dropRight":t-=h;break;case"take":t=to(t,s+h);break;case"takeRight":s=Ki(s,t-h)}}if(t={start:s,end:t},a=t.start,s=t.end,t=s-a,i=i?s:a-1,a=this.__iteratees__,s=a.length,c=0,l=to(t,this.__takeCount__),!r||200>o||o==t&&l==t)return Qe(e,this.__actions__);r=[];t:for(;t--&&l>c;){for(i+=n,o=-1,u=e[i];++o<s;){var d=a[o],h=d.type,d=(0,d.iteratee)(u);if(2==h)u=d;else if(!d){if(1==h)continue t;break t}}r[c++]=u}return r},Tt.prototype.at=Ko,Tt.prototype.chain=function(){return br(this)},Tt.prototype.commit=function(){return new Ut(this.value(),this.__chain__)},Tt.prototype.next=function(){this.__values__===G&&(this.__values__=$r(this.value()));var t=this.__index__>=this.__values__.length,e=t?G:this.__values__[this.__index__++];return{done:t,value:e}},Tt.prototype.plant=function(t){for(var e,n=this;n instanceof St;){var r=lr(n);r.__index__=0,r.__values__=G,e?i.__wrapped__=r:e=r;var i=r,n=n.__wrapped__}return i.__wrapped__=t,e},Tt.prototype.reverse=function(){var t=this.__wrapped__;return t instanceof Ft?(this.__actions__.length&&(t=new Ft(this)),t=t.reverse(),t.__actions__.push({func:xr,args:[vr],thisArg:G}),new Ut(t,this.__chain__)):this.thru(vr)},Tt.prototype.toJSON=Tt.prototype.valueOf=Tt.prototype.value=function(){return Qe(this.__wrapped__,this.__actions__)},Gi&&(Tt.prototype[Gi]=wr),Tt}var G,V=1/0,W=NaN,X=/\b__p\+='';/g,q=/\b(__p\+=)''\+/g,Y=/(__e\(.*?\)|\b__t\))\+'';/g,Z=/&(?:amp|lt|gt|quot|#39|#96);/g,J=/[&<>"'`]/g,Q=RegExp(Z.source),K=RegExp(J.source),tt=/<%-([\s\S]+?)%>/g,et=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,it=/^\w*$/,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(\.|\[\])(?:\4|$))/g,at=/[\\^$.*+?()[\]{}|]/g,st=RegExp(at.source),ct=/^\s+|\s+$/g,lt=/^\s+/,ut=/\s+$/,ht=/[a-zA-Z0-9]+/g,dt=/\\(\\)?/g,pt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ft=/\w*$/,mt=/^0x/i,gt=/^[-+]0x[0-9a-f]+$/i,vt=/^0b[01]+$/i,yt=/^\[object .+?Constructor\]$/,_t=/^0o[0-7]+$/i,bt=/^(?:0|[1-9]\d*)$/,xt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,wt=/($^)/,Et=/['\n\r\u2028\u2029\\]/g,Mt="[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?)*",Tt="(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])"+Mt,St="(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]?|[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])",At=RegExp("['â]","g"),Lt=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]","g"),Rt=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+St+Mt,"g"),Ct=RegExp(["[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?:['â](?:d|ll|m|re|s|t|ve))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['â](?:D|LL|M|RE|S|T|VE))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['â](?:d|ll|m|re|s|t|ve))?|[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?:['â](?:D|LL|M|RE|S|T|VE))?|\\d+",Tt].join("|"),"g"),Pt=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Ot=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Nt="Array Buffer DataView Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Promise Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ isFinite parseInt setTimeout".split(" "),It={};It["[object Float32Array]"]=It["[object Float64Array]"]=It["[object Int8Array]"]=It["[object Int16Array]"]=It["[object Int32Array]"]=It["[object Uint8Array]"]=It["[object Uint8ClampedArray]"]=It["[object Uint16Array]"]=It["[object Uint32Array]"]=!0,It["[object Arguments]"]=It["[object Array]"]=It["[object ArrayBuffer]"]=It["[object Boolean]"]=It["[object DataView]"]=It["[object Date]"]=It["[object Error]"]=It["[object Function]"]=It["[object Map]"]=It["[object Number]"]=It["[object Object]"]=It["[object RegExp]"]=It["[object Set]"]=It["[object String]"]=It["[object WeakMap]"]=!1;var Dt={};Dt["[object Arguments]"]=Dt["[object Array]"]=Dt["[object ArrayBuffer]"]=Dt["[object DataView]"]=Dt["[object Boolean]"]=Dt["[object Date]"]=Dt["[object Float32Array]"]=Dt["[object Float64Array]"]=Dt["[object Int8Array]"]=Dt["[object Int16Array]"]=Dt["[object Int32Array]"]=Dt["[object Map]"]=Dt["[object Number]"]=Dt["[object Object]"]=Dt["[object RegExp]"]=Dt["[object Set]"]=Dt["[object String]"]=Dt["[object Symbol]"]=Dt["[object Uint8Array]"]=Dt["[object Uint8ClampedArray]"]=Dt["[object Uint16Array]"]=Dt["[object Uint32Array]"]=!0,Dt["[object Error]"]=Dt["[object Function]"]=Dt["[object WeakMap]"]=!1;var Ut={"Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã":"C","Ã§":"c","Ã":"D","Ã°":"d","Ã":"E","Ã":"E","Ã":"E","Ã":"E","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã":"I","Ã":"I","Ã":"I","Ã":"I","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã":"N","Ã±":"n","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã":"U","Ã":"U","Ã":"U","Ã":"U","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã":"Y","Ã½":"y","Ã¿":"y","Ã":"Ae","Ã¦":"ae","Ã":"Th","Ã¾":"th","Ã":"ss"},Ft={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Bt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},zt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kt=parseFloat,jt=parseInt,Ht="object"==typeof exports&&exports,Gt=Ht&&"object"==typeof module&&module,Vt=Gt&&Gt.exports===Ht,Wt=C("object"==typeof self&&self),Xt=C("object"==typeof this&&this),qt=C("object"==typeof global&&global)||Wt||Xt||Function("return this")(),Yt=H();(Wt||{})._=Yt,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return Yt}):Gt?((Gt.exports=Yt)._=Yt,Ht._=Yt):qt._=Yt}.call(this),!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dat=e():t.dat=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n(1),o=r(i);t.exports=o.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(2),o=r(i),a=n(6),s=r(a),c=n(3),l=r(c),u=n(7),h=r(u),d=n(8),p=r(d),f=n(10),m=r(f),g=n(11),v=r(g),y=n(12),_=r(y),b=n(13),x=r(b),w=n(14),E=r(w),M=n(15),T=r(M),S=n(16),A=r(S),L=n(9),R=r(L),C=n(17),P=r(C);e.default={color:{Color:o.default,math:s.default,interpret:l.default},controllers:{Controller:h.default,BooleanController:p.default,OptionController:m.default,StringController:v.default,NumberController:_.default,NumberControllerBox:x.default,NumberControllerSlider:E.default,FunctionController:T.default,ColorController:A.default},dom:{dom:R.default},gui:{GUI:P.default},GUI:P.default}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(m.recalculateRGB(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(m.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function a(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(m.recalculateHSV(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(m.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}e.__esModule=!0;var s=n(3),c=r(s),l=n(6),u=r(l),h=n(4),d=r(h),p=n(5),f=r(p),m=function(){function t(){if(i(this,t),this.__state=c.default.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return t.prototype.toString=function(){return(0,d.default)(this)},t.prototype.toHexString=function(){return(0,d.default)(this,!0)},t.prototype.toOriginal=function(){return this.__state.conversion.write(this)},t}();m.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=u.default.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");f.default.extend(t.__state,u.default.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},m.recalculateHSV=function(t){var e=u.default.rgb_to_hsv(t.r,t.g,t.b);f.default.extend(t.__state,{s:e.s,v:e.v}),f.default.isNaN(e.h)?f.default.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},m.COMPONENTS=["r","g","b","h","s","v","hex","a"],o(m.prototype,"r",2),o(m.prototype,"g",1),o(m.prototype,"b",0),a(m.prototype,"h"),a(m.prototype,"s"),a(m.prototype,"v"),Object.defineProperty(m.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(m.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=u.default.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),e.default=m},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(4),o=r(i),a=n(5),s=r(a),c=[{litmus:s.default.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:o.default},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:o.default},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:o.default},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:o.default}}},{litmus:s.default.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:s.default.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:s.default.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(s.default.isNumber(t.r)&&s.default.isNumber(t.g)&&s.default.isNumber(t.b)&&s.default.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(s.default.isNumber(t.r)&&s.default.isNumber(t.g)&&s.default.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(s.default.isNumber(t.h)&&s.default.isNumber(t.s)&&s.default.isNumber(t.v)&&s.default.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(s.default.isNumber(t.h)&&s.default.isNumber(t.s)&&s.default.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],l=void 0,u=void 0,h=function(){u=!1;var t=arguments.length>1?s.default.toArray(arguments):arguments[0];return s.default.each(c,function(e){if(e.litmus(t))return s.default.each(e.conversions,function(e,n){if(l=e.read(t),u===!1&&l!==!1)return u=l,l.conversionName=n,l.conversion=e,s.default.BREAK}),s.default.BREAK}),u};e.default=h},function(t,e){"use strict";e.__esModule=!0,e.default=function(t,e){var n=t.__state.conversionName.toString(),r=Math.round(t.r),i=Math.round(t.g),o=Math.round(t.b),a=t.a,s=Math.round(t.h),c=t.s.toFixed(1),l=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var u=t.hex.toString(16);u.length<6;)u="0"+u;return"#"+u}return"CSS_RGB"===n?"rgb("+r+","+i+","+o+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+o+","+a+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+o+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+o+","+a+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+c+",v:"+l+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+c+",v:"+l+",a:"+a+"}":"unknown format"}},function(t,e){"use strict";e.__esModule=!0;var n=Array.prototype.forEach,r=Array.prototype.slice,i={BREAK:{},extend:function(t){return this.each(r.call(arguments,1),function(e){var n=this.isObject(e)?Object.keys(e):[];n.forEach(function(n){this.isUndefined(e[n])||(t[n]=e[n])}.bind(this))},this),t},defaults:function(t){return this.each(r.call(arguments,1),function(e){var n=this.isObject(e)?Object.keys(e):[];n.forEach(function(n){this.isUndefined(t[n])&&(t[n]=e[n])}.bind(this))},this),t},compose:function(){var t=r.call(arguments);return function(){for(var e=r.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,r){if(t)if(n&&t.forEach&&t.forEach===n)t.forEach(e,r);else if(t.length===t.length+0){var i=void 0,o=void 0;for(i=0,o=t.length;i<o;i++)if(i in t&&e.call(r,t[i],i)===this.BREAK)return}else for(var a in t)if(e.call(r,t[a],a)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e){var n=void 0;return function(){function r(){n=null}var i=this,o=arguments,a=!n;clearTimeout(n),n=setTimeout(r,e),a&&t.apply(i,o)}},toArray:function(t){return t.toArray?t.toArray():r.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}};e.default=i},function(t,e){"use strict";e.__esModule=!0;var n=void 0,r={hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),c=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(t,e,n){var r=Math.min(t,e,n),i=Math.max(t,e,n),o=i-r,a=void 0,s=void 0;return 0===i?{h:NaN,s:0,v:0}:(s=o/i,a=t===i?(e-n)/o:e===i?2+(n-t)/o:4+(t-e)/o,a/=6,a<0&&(a+=1),{h:360*a,s:s,v:i/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,r){return r<<(n=8*e)|t&~(255<<n)}};e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=function(){function t(e,r){n(this,t),this.initialValue=e[r],this.domElement=document.createElement("div"),this.object=e,this.property=r,this.__onChange=void 0,this.__onFinishChange=void 0}return t.prototype.onChange=function(t){return this.__onChange=t,this},t.prototype.onFinishChange=function(t){return this.__onFinishChange=t,this},t.prototype.setValue=function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},t.prototype.getValue=function(){return this.object[this.property]},t.prototype.updateDisplay=function(){return this},t.prototype.isModified=function(){return this.initialValue!==this.getValue()},t}();e.default=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s=n(7),c=r(s),l=n(9),u=r(l),h=function(t){function e(n,r){function a(){c.setValue(!c.__prev)}i(this,e);var s=o(this,t.call(this,n,r)),c=s;return s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox"),u.default.bind(s.__checkbox,"change",a,!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return a(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n},e.prototype.updateDisplay=function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,t.prototype.updateDisplay.call(this)},e}(c.default);e.default=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if("0"===t||a.default.isUndefined(t))return 0;var e=t.match(l);return a.default.isNull(e)?0:parseFloat(e[1])}e.__esModule=!0;var o=n(5),a=r(o),s={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},c={};a.default.each(s,function(t,e){a.default.each(t,function(t){c[t]=e})});var l=/(\d+(\.\d+)?)px/,u={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var r=n,i=e;a.default.isUndefined(i)&&(i=!0),a.default.isUndefined(r)&&(r=!0),t.style.position="absolute",i&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,r){var i=n||{},o=c[e];if(!o)throw new Error("Event type "+e+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var l=i.x||i.clientX||0,u=i.y||i.clientY||0;s.initMouseEvent(e,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,l,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var h=s.initKeyboardEvent||s.initKeyEvent;a.default.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),h(e,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(e,i.bubbles||!1,i.cancelable||!0)}a.default.defaults(s,r),t.dispatchEvent(s)},bind:function(t,e,n,r){var i=r||!1;return t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n),u},unbind:function(t,e,n,r){var i=r||!1;return t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n),u},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);n.indexOf(e)===-1&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return u},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);r!==-1&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return u},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return i(e["border-left-width"])+i(e["border-right-width"])+i(e["padding-left"])+i(e["padding-right"])+i(e.width)},getHeight:function(t){var e=getComputedStyle(t);return i(e["border-top-width"])+i(e["border-bottom-width"])+i(e["padding-top"])+i(e["padding-bottom"])+i(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent;while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s=n(7),c=r(s),l=n(9),u=r(l),h=n(5),d=r(h),p=function(t){function e(n,r,a){i(this,e);var s=o(this,t.call(this,n,r)),c=a,l=s;return s.__select=document.createElement("select"),d.default.isArray(c)&&!function(){var t={};d.default.each(c,function(e){t[e]=e}),c=t}(),d.default.each(c,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),l.__select.appendChild(n)}),s.updateDisplay(),u.default.bind(s.__select,"change",function(){var t=this.options[this.selectedIndex].value;l.setValue(t)}),s.domElement.appendChild(s.__select),s}return a(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n},e.prototype.updateDisplay=function(){return u.default.isActive(this.__select)?this:(this.__select.value=this.getValue(),t.prototype.updateDisplay.call(this))},e}(c.default);e.default=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s=n(7),c=r(s),l=n(9),u=r(l),h=function(t){function e(n,r){function a(){l.setValue(l.__input.value)}function s(){l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}i(this,e);var c=o(this,t.call(this,n,r)),l=c;return c.__input=document.createElement("input"),c.__input.setAttribute("type","text"),u.default.bind(c.__input,"keyup",a),u.default.bind(c.__input,"change",a),u.default.bind(c.__input,"blur",s),u.default.bind(c.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),c.updateDisplay(),c.domElement.appendChild(c.__input),c}return a(e,t),e.prototype.updateDisplay=function(){return u.default.isActive(this.__input)||(this.__input.value=this.getValue()),t.prototype.updateDisplay.call(this)},e}(c.default);e.default=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}e.__esModule=!0;var c=n(7),l=r(c),u=n(5),h=r(u),d=function(t){function e(n,r,a){i(this,e);var c=o(this,t.call(this,n,r)),l=a||{};return c.__min=l.min,c.__max=l.max,c.__step=l.step,h.default.isUndefined(c.__step)?0===c.initialValue?c.__impliedStep=1:c.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(c.initialValue))/Math.LN10))/10:c.__impliedStep=c.__step,c.__precision=s(c.__impliedStep),c}return a(e,t),e.prototype.setValue=function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),
void 0!==this.__step&&n%this.__step!==0&&(n=Math.round(n/this.__step)*this.__step),t.prototype.setValue.call(this,n)},e.prototype.min=function(t){return this.__min=t,this},e.prototype.max=function(t){return this.__max=t,this},e.prototype.step=function(t){return this.__step=t,this.__impliedStep=t,this.__precision=s(t),this},e}(l.default);e.default=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}e.__esModule=!0;var c=n(12),l=r(c),u=n(9),h=r(u),d=n(5),p=r(d),f=function(t){function e(n,r,a){function s(){var t=parseFloat(g.__input.value);p.default.isNaN(t)||g.setValue(t)}function c(){g.__onFinishChange&&g.__onFinishChange.call(g,g.getValue())}function l(){c()}function u(t){var e=v-t.clientY;g.setValue(g.getValue()+e*g.__impliedStep),v=t.clientY}function d(){h.default.unbind(window,"mousemove",u),h.default.unbind(window,"mouseup",d),c()}function f(t){h.default.bind(window,"mousemove",u),h.default.bind(window,"mouseup",d),v=t.clientY}i(this,e);var m=o(this,t.call(this,n,r,a));m.__truncationSuspended=!1;var g=m,v=void 0;return m.__input=document.createElement("input"),m.__input.setAttribute("type","text"),h.default.bind(m.__input,"change",s),h.default.bind(m.__input,"blur",l),h.default.bind(m.__input,"mousedown",f),h.default.bind(m.__input,"keydown",function(t){13===t.keyCode&&(g.__truncationSuspended=!0,this.blur(),g.__truncationSuspended=!1,c())}),m.updateDisplay(),m.domElement.appendChild(m.__input),m}return a(e,t),e.prototype.updateDisplay=function(){return this.__input.value=this.__truncationSuspended?this.getValue():s(this.getValue(),this.__precision),t.prototype.updateDisplay.call(this)},e}(l.default);e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e,n,r,i){return r+(i-r)*((t-e)/(n-e))}e.__esModule=!0;var c=n(12),l=r(c),u=n(9),h=r(u),d=function(t){function e(n,r,a,c,l){function u(t){document.activeElement.blur(),h.default.bind(window,"mousemove",d),h.default.bind(window,"mouseup",p),d(t)}function d(t){t.preventDefault();var e=m.__background.getBoundingClientRect();return m.setValue(s(t.clientX,e.left,e.right,m.__min,m.__max)),!1}function p(){h.default.unbind(window,"mousemove",d),h.default.unbind(window,"mouseup",p),m.__onFinishChange&&m.__onFinishChange.call(m,m.getValue())}i(this,e);var f=o(this,t.call(this,n,r,{min:a,max:c,step:l})),m=f;return f.__background=document.createElement("div"),f.__foreground=document.createElement("div"),h.default.bind(f.__background,"mousedown",u),h.default.addClass(f.__background,"slider"),h.default.addClass(f.__foreground,"slider-fg"),f.updateDisplay(),f.__background.appendChild(f.__foreground),f.domElement.appendChild(f.__background),f}return a(e,t),e.prototype.updateDisplay=function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",t.prototype.updateDisplay.call(this)},e}(l.default);e.default=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s=n(7),c=r(s),l=n(9),u=r(l),h=function(t){function e(n,r,a){i(this,e);var s=o(this,t.call(this,n,r)),c=s;return s.__button=document.createElement("div"),s.__button.innerHTML=void 0===a?"Fire":a,u.default.bind(s.__button,"click",function(t){return t.preventDefault(),c.fire(),!1}),u.default.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return a(e,t),e.prototype.fire=function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},e}(c.default);e.default=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e,n,r){t.style.background="",y.default.each(b,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "})}function c(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}e.__esModule=!0;var l=n(7),u=r(l),h=n(9),d=r(h),p=n(2),f=r(p),m=n(3),g=r(m),v=n(5),y=r(v),_=function(t){function e(n,r){function a(t){m(t),d.default.bind(window,"mousemove",m),d.default.bind(window,"mouseup",l)}function l(){d.default.unbind(window,"mousemove",m),d.default.unbind(window,"mouseup",l),p()}function u(){var t=(0,g.default)(this.value);t!==!1?(b.__color.__state=t,b.setValue(b.__color.toOriginal())):this.value=b.__color.toString()}function h(){d.default.unbind(window,"mousemove",v),d.default.unbind(window,"mouseup",h),p()}function p(){b.__onFinishChange&&b.__onFinishChange.call(b,b.__color.toOriginal())}function m(t){t.preventDefault();var e=b.__saturation_field.getBoundingClientRect(),n=(t.clientX-e.left)/(e.right-e.left),r=1-(t.clientY-e.top)/(e.bottom-e.top);return r>1?r=1:r<0&&(r=0),n>1?n=1:n<0&&(n=0),b.__color.v=r,b.__color.s=n,b.setValue(b.__color.toOriginal()),!1}function v(t){t.preventDefault();var e=b.__hue_field.getBoundingClientRect(),n=1-(t.clientY-e.top)/(e.bottom-e.top);return n>1?n=1:n<0&&(n=0),b.__color.h=360*n,b.setValue(b.__color.toOriginal()),!1}i(this,e);var _=o(this,t.call(this,n,r));_.__color=new f.default(_.getValue()),_.__temp=new f.default(0);var b=_;_.domElement=document.createElement("div"),d.default.makeSelectable(_.domElement,!1),_.__selector=document.createElement("div"),_.__selector.className="selector",_.__saturation_field=document.createElement("div"),_.__saturation_field.className="saturation-field",_.__field_knob=document.createElement("div"),_.__field_knob.className="field-knob",_.__field_knob_border="2px solid ",_.__hue_knob=document.createElement("div"),_.__hue_knob.className="hue-knob",_.__hue_field=document.createElement("div"),_.__hue_field.className="hue-field",_.__input=document.createElement("input"),_.__input.type="text",_.__input_textShadow="0 1px 1px ",d.default.bind(_.__input,"keydown",function(t){13===t.keyCode&&u.call(this)}),d.default.bind(_.__input,"blur",u),d.default.bind(_.__selector,"mousedown",function(){d.default.addClass(this,"drag").bind(window,"mouseup",function(){d.default.removeClass(b.__selector,"drag")})});var x=document.createElement("div");return y.default.extend(_.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),y.default.extend(_.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:_.__field_knob_border+(_.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),y.default.extend(_.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),y.default.extend(_.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),y.default.extend(x.style,{width:"100%",height:"100%",background:"none"}),s(x,"top","rgba(0,0,0,0)","#000"),y.default.extend(_.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),c(_.__hue_field),y.default.extend(_.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:_.__input_textShadow+"rgba(0,0,0,0.7)"}),d.default.bind(_.__saturation_field,"mousedown",a),d.default.bind(_.__field_knob,"mousedown",a),d.default.bind(_.__hue_field,"mousedown",function(t){v(t),d.default.bind(window,"mousemove",v),d.default.bind(window,"mouseup",h)}),_.__saturation_field.appendChild(x),_.__selector.appendChild(_.__field_knob),_.__selector.appendChild(_.__saturation_field),_.__selector.appendChild(_.__hue_field),_.__hue_field.appendChild(_.__hue_knob),_.domElement.appendChild(_.__input),_.domElement.appendChild(_.__selector),_.updateDisplay(),_}return a(e,t),e.prototype.updateDisplay=function(){var t=(0,g.default)(this.getValue());if(t!==!1){var e=!1;y.default.each(f.default.COMPONENTS,function(n){if(!y.default.isUndefined(t[n])&&!y.default.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&y.default.extend(this.__color.__state,t)}y.default.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;y.default.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,s(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),y.default.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})},e}(u.default),b=["-moz-","-o-","-webkit-","-ms-",""];e.default=_},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,n):t.__ul.appendChild(r),t.onResize(),r}function o(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];e?n.innerHTML=n.value+"*":n.innerHTML=n.value}function a(t,e,n){if(n.__li=e,n.__gui=t,V.default.extend(n,{options:function(e){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),c(t,n.object,n.property,{before:r,factoryArgs:[V.default.toArray(arguments)]})}if(V.default.isArray(e)||V.default.isObject(e)){var i=n.__li.nextElementSibling;return n.remove(),c(t,n.object,n.property,{before:i,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof I.default)!function(){var t=new O.default(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});V.default.each(["updateDisplay","onChange","onFinishChange","step"],function(e){var r=n[e],i=t[e];n[e]=t[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(t,e),r.apply(n,e)}}),H.default.addClass(e,"has-slider"),n.domElement.insertBefore(t.domElement,n.domElement.firstElementChild)}();else if(n instanceof O.default){var r=function(e){if(V.default.isNumber(n.__min)&&V.default.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=c(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(r),i&&o.listen(),o}return e};n.min=V.default.compose(r,n.min),n.max=V.default.compose(r,n.max)}else n instanceof L.default?(H.default.bind(e,"click",function(){H.default.fakeEvent(n.__checkbox,"click")}),H.default.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof C.default?(H.default.bind(e,"click",function(){H.default.fakeEvent(n.__button,"click")}),H.default.bind(e,"mouseover",function(){H.default.addClass(n.__button,"hover")}),H.default.bind(e,"mouseout",function(){H.default.removeClass(n.__button,"hover")})):n instanceof U.default&&(H.default.addClass(e,"color"),n.updateDisplay=V.default.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=V.default.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&o(t.getRoot(),!0),e},n.setValue)}function s(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(r!==-1){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[t.preset])a=o[t.preset];else{if(!o[J])return;a=o[J]}if(a[r]&&void 0!==a[r][e.property]){var s=a[r][e.property];e.initialValue=s,e.setValue(s)}}}}function c(t,e,n,r){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var o=void 0;if(r.color)o=new U.default(e,n);else{var c=[e,n].concat(r.factoryArgs);o=M.default.apply(t,c)}r.before instanceof S.default&&(r.before=r.before.__li),s(t,o),H.default.addClass(o.domElement,"c");var l=document.createElement("span");H.default.addClass(l,"property-name"),l.innerHTML=o.property;var u=document.createElement("div");u.appendChild(l),u.appendChild(o.domElement);var h=i(t,u,r.before);return H.default.addClass(h,rt.CLASS_CONTROLLER_ROW),o instanceof U.default?H.default.addClass(h,"color"):H.default.addClass(h,y(o.getValue())),a(t,h,o),t.__controllers.push(o),o}function l(t,e){return document.location.href+"."+e}function u(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function h(t,e){e.style.display=t.useLocalStorage?"block":"none"}function d(t){var e=t.__save_row=document.createElement("li");H.default.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),H.default.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",H.default.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",H.default.addClass(r,"button"),H.default.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",H.default.addClass(i,"button"),H.default.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",H.default.addClass(o,"button"),H.default.addClass(o,"revert");var a=t.__preset_select=document.createElement("select");t.load&&t.load.remembered?V.default.each(t.load.remembered,function(e,n){u(t,n,n===t.preset)}):u(t,J,!1),H.default.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(a),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),Q&&!function(){var e=document.getElementById("dg-local-explain"),n=document.getElementById("dg-local-storage"),r=document.getElementById("dg-save-locally");r.style.display="block","true"===localStorage.getItem(l(t,"isLocal"))&&n.setAttribute("checked","checked"),h(t,e),H.default.bind(n,"change",function(){t.useLocalStorage=!t.useLocalStorage,h(t,e)})}();var s=document.getElementById("dg-new-constructor");H.default.bind(s,"keydown",function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||K.hide()}),H.default.bind(n,"click",function(){s.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),K.show(),s.focus(),s.select()}),H.default.bind(r,"click",function(){t.save()}),H.default.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),H.default.bind(o,"click",function(){t.revert()})}function p(t){function e(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function n(){H.default.removeClass(t.__closeButton,rt.CLASS_DRAG),H.default.unbind(window,"mousemove",e),H.default.unbind(window,"mouseup",n)}function r(r){return r.preventDefault(),i=r.clientX,H.default.addClass(t.__closeButton,rt.CLASS_DRAG),H.default.bind(window,"mousemove",e),H.default.bind(window,"mouseup",n),!1}var i=void 0;t.__resize_handle=document.createElement("div"),V.default.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),H.default.bind(t.__resize_handle,"mousedown",r),H.default.bind(t.__closeButton,"mousedown",r),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function f(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function m(t,e){var n={};return V.default.each(t.__rememberedObjects,function(r,i){var o={},a=t.__rememberedObjectIndecesToControllers[i];V.default.each(a,function(t,n){o[n]=e?t.initialValue:t.getValue()}),n[i]=o}),n}function g(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}function v(t){0!==t.length&&B.default.call(window,function(){v(t)}),V.default.each(t,function(t){t.updateDisplay()})}var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},_=n(18),b=r(_),x=n(19),w=r(x),E=n(20),M=r(E),T=n(7),S=r(T),A=n(8),L=r(A),R=n(15),C=r(R),P=n(13),O=r(P),N=n(14),I=r(N),D=n(16),U=r(D),F=n(21),B=r(F),z=n(22),k=r(z),j=n(9),H=r(j),G=n(5),V=r(G),W=n(23),X=r(W);b.default.inject(X.default);var q="dg",Y=72,Z=20,J="Default",Q=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),K=void 0,$=!0,tt=void 0,et=!1,nt=[],rt=function t(e){function n(){var t=r.getRoot();t.width+=1,V.default.defer(function(){t.width-=1})}var r=this,o=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),H.default.addClass(this.domElement,q),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=V.default.defaults(o,{autoPlace:!0,width:t.DEFAULT_WIDTH}),o=V.default.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),V.default.isUndefined(o.load)?o.load={preset:J}:o.preset&&(o.load.preset=o.preset),V.default.isUndefined(o.parent)&&o.hideable&&nt.push(this),o.resizable=V.default.isUndefined(o.parent)&&o.resizable,o.autoPlace&&V.default.isUndefined(o.scrollable)&&(o.scrollable=!0);var a=Q&&"true"===localStorage.getItem(l(this,"isLocal")),s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:o.load.preset},set:function(t){r.parent?r.getRoot().preset=t:o.load.preset=t,g(this),r.revert()}},width:{get:function(){return o.width},set:function(t){o.width=t,f(r,t)}},name:{get:function(){return o.name},set:function(t){o.name=t,titleRowName&&(titleRowName.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(e){o.closed=e,o.closed?H.default.addClass(r.__ul,t.CLASS_CLOSED):H.default.removeClass(r.__ul,t.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return a},set:function(t){Q&&(a=t,t?H.default.bind(window,"unload",s):H.default.unbind(window,"unload",s),localStorage.setItem(l(r,"isLocal"),t))}}}),V.default.isUndefined(o.parent)){if(o.closed=!1,H.default.addClass(this.domElement,t.CLASS_MAIN),H.default.makeSelectable(this.domElement,!1),Q&&a){r.useLocalStorage=!0;var c=localStorage.getItem(l(this,"gui"));c&&(o.load=JSON.parse(c))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,H.default.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),H.default.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===o.closed&&(o.closed=!0);var u=document.createTextNode(o.name);H.default.addClass(u,"controller-name");var h=i(r,u),d=function(t){return t.preventDefault(),r.closed=!r.closed,!1};H.default.addClass(this.__ul,t.CLASS_CLOSED),H.default.addClass(h,"title"),H.default.bind(h,"click",d),o.closed||(this.closed=!1)}o.autoPlace&&(V.default.isUndefined(o.parent)&&($&&(tt=document.createElement("div"),H.default.addClass(tt,q),H.default.addClass(tt,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(tt),$=!1),tt.appendChild(this.domElement),H.default.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||f(r,o.width)),this.__resizeHandler=function(){r.onResizeDebounced()},H.default.bind(window,"resize",this.__resizeHandler),H.default.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),H.default.bind(this.__ul,"transitionend",this.__resizeHandler),H.default.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&p(this),s=function(){Q&&"true"===localStorage.getItem(l(r,"isLocal"))&&localStorage.setItem(l(r,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=s,o.parent||n()};rt.toggleHide=function(){et=!et,V.default.each(nt,function(t){t.domElement.style.display=et?"none":""})},rt.CLASS_AUTO_PLACE="a",rt.CLASS_AUTO_PLACE_CONTAINER="ac",rt.CLASS_MAIN="main",rt.CLASS_CONTROLLER_ROW="cr",rt.CLASS_TOO_TALL="taller-than-window",rt.CLASS_CLOSED="closed",rt.CLASS_CLOSE_BUTTON="close-button",rt.CLASS_DRAG="drag",rt.DEFAULT_WIDTH=245,rt.TEXT_CLOSED="Close Controls",rt.TEXT_OPEN="Open Controls",rt._keydownHandler=function(t){"text"===document.activeElement.type||t.which!==Y&&t.keyCode!==Y||rt.toggleHide()},H.default.bind(window,"keydown",rt._keydownHandler,!1),V.default.extend(rt.prototype,{add:function(t,e){return c(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return c(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;V.default.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&tt.removeChild(this.domElement),H.default.unbind(window,"keydown",rt._keydownHandler,!1),H.default.unbind(window,"resize",this.__resizeHandler),this.saveToLocalStorageIfPossible&&H.default.unbind(window,"unload",this.saveToLocalStorageIfPossible)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new rt(e);this.__folders[t]=n;var r=i(this,n.domElement);return H.default.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=H.default.getOffset(t.__ul).top,n=0;V.default.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=H.default.getHeight(e))}),window.innerHeight-e-Z<n?(H.default.addClass(t.domElement,rt.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-Z+"px"):(H.default.removeClass(t.domElement,rt.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&V.default.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:V.default.debounce(function(){this.onResize()},200),remember:function(){if(V.default.isUndefined(K)&&(K=new k.default,K.domElement.innerHTML=w.default),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;V.default.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&d(t),t.__rememberedObjects.indexOf(e)===-1&&t.__rememberedObjects.push(e)}),this.autoPlace&&f(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=m(this)),t.folders={},V.default.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=m(this),o(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[J]=m(this,!0)),this.load.remembered[t]=m(this),this.preset=t,u(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){V.default.each(this.__controllers,function(e){this.getRoot().load.remembered?s(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),V.default.each(this.__folders,function(t){t.revert(t)}),t||o(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&v(this.__listening)},updateDisplay:function(){V.default.each(this.__controllers,function(t){t.updateDisplay()}),V.default.each(this.__folders,function(t){t.updateDisplay()})}}),t.exports=rt},function(t,e){"use strict";t.exports={load:function(t,e){var n=e||document,r=n.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=t,n.getElementsByTagName("head")[0].appendChild(r)},inject:function(t,e){var n=e||document,r=document.createElement("style");r.type="text/css",r.innerHTML=t;var i=n.getElementsByTagName("head")[0];try{i.appendChild(r)}catch(t){}}}},function(t,e){t.exports="<div id=dg-save class=\"dg dialogue\"> Here's the new load parameter for your <code>GUI</code>'s constructor: <textarea id=dg-new-constructor></textarea> <div id=dg-save-locally> <input id=dg-local-storage type=checkbox /> Automatically save values to <code>localStorage</code> on exit. <div id=dg-local-explain>The values saved to <code>localStorage</code> will override those passed to <code>dat.GUI</code>'s constructor. This makes it easier to work incrementally, but <code>localStorage</code> is fragile, and your friends may not see the same values you do. </div> </div> </div>"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(10),o=r(i),a=n(13),s=r(a),c=n(14),l=r(c),u=n(11),h=r(u),d=n(15),p=r(d),f=n(8),m=r(f),g=n(5),v=r(g),y=function(t,e){var n=t[e];return v.default.isArray(arguments[2])||v.default.isObject(arguments[2])?new o.default(t,e,arguments[2]):v.default.isNumber(n)?v.default.isNumber(arguments[2])&&v.default.isNumber(arguments[3])?v.default.isNumber(arguments[4])?new l.default(t,e,arguments[2],arguments[3],arguments[4]):new l.default(t,e,arguments[2],arguments[3]):v.default.isNumber(arguments[4])?new s.default(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new s.default(t,e,{min:arguments[2],max:arguments[3]}):v.default.isString(n)?new h.default(t,e):v.default.isFunction(n)?new p.default(t,e,""):v.default.isBoolean(n)?new m.default(t,e):null};e.default=y},function(t,e){"use strict";function n(t){setTimeout(t,1e3/60)}e.__esModule=!0,e.default=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var o=n(9),a=r(o),s=n(5),c=r(s),l=function(){function t(){i(this,t),this.backgroundElement=document.createElement("div"),c.default.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),a.default.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),c.default.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;a.default.bind(this.backgroundElement,"click",function(){e.hide()})}return t.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),c.default.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},t.prototype.hide=function t(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",a.default.unbind(e.domElement,"webkitTransitionEnd",t),a.default.unbind(e.domElement,"transitionend",t),a.default.unbind(e.domElement,"oTransitionEnd",t)};a.default.bind(this.domElement,"webkitTransitionEnd",t),a.default.bind(this.domElement,"transitionend",t),a.default.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},t.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-a.default.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-a.default.getHeight(this.domElement)/2+"px"},t}();e.default=l},function(t,e,n){e=t.exports=n(24)(),e.push([t.id,".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1!important}.dg.main .close-button.drag,.dg.main:hover .close-button{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;transition:opacity .1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save>ul{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height .1s ease-out;transition:height .1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.boolean,.dg .cr.boolean *,.dg .cr.function,.dg .cr.function *,.dg .cr.function .property-name{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco,monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px Lucida Grande,sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.boolean:hover,.dg .cr.function:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}",""]);
},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}}])}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.THREE=t.THREE||{})}(this,function(t){function e(){}function n(t,e){this.x=t||0,this.y=e||0}function r(t,e,i,o,a,s,c,l,u,h){Object.defineProperty(this,"id",{value:ii++}),this.uuid=ri.generateUUID(),this.name="",this.image=void 0!==t?t:r.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:r.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==o?o:1001,this.magFilter=void 0!==a?a:1006,this.minFilter=void 0!==s?s:1008,this.anisotropy=void 0!==u?u:1,this.format=void 0!==c?c:1023,this.type=void 0!==l?l:1009,this.offset=new n(0,0),this.repeat=new n(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:3e3,this.version=0,this.onUpdate=null}function i(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function o(t,e,n){this.uuid=ri.generateUUID(),this.width=t,this.height=e,this.scissor=new i(0,0,t,e),this.scissorTest=!1,this.viewport=new i(0,0,t,e),n=n||{},void 0===n.minFilter&&(n.minFilter=1006),this.texture=new r(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function a(t,e,n){o.call(this,t,e,n),this.activeMipMapLevel=this.activeCubeFace=0}function s(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function c(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function l(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function u(t,e,n,i,o,a,s,c,l,u){t=void 0!==t?t:[],r.call(this,t,void 0!==e?e:301,n,i,o,a,s,c,l,u),this.flipY=!1}function h(t,e,n){var r=t[0];if(0>=r||0<r)return t;var i=e*n,o=si[i];if(void 0===o&&(o=new Float32Array(i),si[i]=o),0!==e)for(r.toArray(o,0),r=1,i=0;r!==e;++r)i+=n,t[r].toArray(o,i);return o}function d(t,e){var n=ci[e];void 0===n&&(n=new Int32Array(e),ci[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function p(t,e){t.uniform1f(this.addr,e)}function f(t,e){t.uniform1i(this.addr,e)}function m(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function g(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function v(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function y(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function _(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)}function b(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)}function x(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||oi,r)}function w(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||ai,r)}function E(t,e){t.uniform2iv(this.addr,e)}function M(t,e){t.uniform3iv(this.addr,e)}function T(t,e){t.uniform4iv(this.addr,e)}function S(t){switch(t){case 5126:return p;case 35664:return m;case 35665:return g;case 35666:return v;case 35674:return y;case 35675:return _;case 35676:return b;case 35678:return x;case 35680:return w;case 5124:case 35670:return f;case 35667:case 35671:return E;case 35668:case 35672:return M;case 35669:case 35673:return T}}function A(t,e){t.uniform1fv(this.addr,e)}function L(t,e){t.uniform1iv(this.addr,e)}function R(t,e){t.uniform2fv(this.addr,h(e,this.size,2))}function C(t,e){t.uniform3fv(this.addr,h(e,this.size,3))}function P(t,e){t.uniform4fv(this.addr,h(e,this.size,4))}function O(t,e){t.uniformMatrix2fv(this.addr,!1,h(e,this.size,4))}function N(t,e){t.uniformMatrix3fv(this.addr,!1,h(e,this.size,9))}function I(t,e){t.uniformMatrix4fv(this.addr,!1,h(e,this.size,16))}function D(t,e,n){var r=e.length,i=d(n,r);for(t.uniform1iv(this.addr,i),t=0;t!==r;++t)n.setTexture2D(e[t]||oi,i[t])}function U(t,e,n){var r=e.length,i=d(n,r);for(t.uniform1iv(this.addr,i),t=0;t!==r;++t)n.setTextureCube(e[t]||ai,i[t])}function F(t){switch(t){case 5126:return A;case 35664:return R;case 35665:return C;case 35666:return P;case 35674:return O;case 35675:return N;case 35676:return I;case 35678:return D;case 35680:return U;case 5124:case 35670:return L;case 35667:case 35671:return E;case 35668:case 35672:return M;case 35669:case 35673:return T}}function B(t,e,n){this.id=t,this.addr=n,this.setValue=S(e.type)}function z(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=F(e.type)}function k(t){this.id=t,this.seq=[],this.map={}}function j(t,e,n){this.seq=[],this.map={},this.renderer=n,n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(var r=0;r!==n;++r){var i=t.getActiveUniform(e,r),o=t.getUniformLocation(e,i.name),a=this,s=i.name,c=s.length;for(li.lastIndex=0;;){var l=li.exec(s),u=li.lastIndex,h=l[1],d=l[3];if("]"===l[2]&&(h|=0),void 0===d||"["===d&&u+2===c){s=a,i=void 0===d?new B(h,i,o):new z(h,i,o),s.seq.push(i),s.map[i.id]=i;break}d=a.map[h],void 0===d&&(d=new k(h),h=a,a=d,h.seq.push(a),h.map[a.id]=a),a=d}}}function H(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function G(t,e,n,i,o,a,s,c,l,u,h,d){r.call(this,null,a,s,c,l,u,i,o,h,d),this.image={data:t,width:e,height:n},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==u?u:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function V(t,e){this.min=void 0!==t?t:new n(1/0,1/0),this.max=void 0!==e?e:new n(-(1/0),-(1/0))}function W(t,e){var r,i,o,a,s,l,u,h,d,p,f=t.context,m=t.state,g,v,y,_,b,x;this.render=function(w,E,M){if(0!==e.length){w=new c;var T=M.w/M.z,S=.5*M.z,A=.5*M.w,L=16/M.w,R=new n(L*T,L),C=new c(1,1,0),P=new n(1,1),O=new V;if(O.min.set(M.x,M.y),O.max.set(M.x+(M.z-16),M.y+(M.w-16)),void 0===_){var L=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),N=new Uint16Array([0,1,2,0,2,3]);g=f.createBuffer(),v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,g),f.bufferData(f.ARRAY_BUFFER,L,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,v),f.bufferData(f.ELEMENT_ARRAY_BUFFER,N,f.STATIC_DRAW),b=f.createTexture(),x=f.createTexture(),m.bindTexture(f.TEXTURE_2D,b),f.texImage2D(f.TEXTURE_2D,0,f.RGB,16,16,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),m.bindTexture(f.TEXTURE_2D,x),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,16,16,0,f.RGBA,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);var L=y={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},N=f.createProgram(),I=f.createShader(f.FRAGMENT_SHADER),D=f.createShader(f.VERTEX_SHADER),U="precision "+t.getPrecision()+" float;\n";f.shaderSource(I,U+L.fragmentShader),f.shaderSource(D,U+L.vertexShader),f.compileShader(I),f.compileShader(D),f.attachShader(N,I),f.attachShader(N,D),f.linkProgram(N),_=N,d=f.getAttribLocation(_,"position"),p=f.getAttribLocation(_,"uv"),r=f.getUniformLocation(_,"renderType"),i=f.getUniformLocation(_,"map"),o=f.getUniformLocation(_,"occlusionMap"),a=f.getUniformLocation(_,"opacity"),s=f.getUniformLocation(_,"color"),l=f.getUniformLocation(_,"scale"),u=f.getUniformLocation(_,"rotation"),h=f.getUniformLocation(_,"screenPosition")}for(f.useProgram(_),m.initAttributes(),m.enableAttribute(d),m.enableAttribute(p),m.disableUnusedAttributes(),f.uniform1i(o,0),f.uniform1i(i,1),f.bindBuffer(f.ARRAY_BUFFER,g),f.vertexAttribPointer(d,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(p,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,v),m.disable(f.CULL_FACE),m.setDepthWrite(!1),N=0,I=e.length;N<I;N++)if(L=16/M.w,R.set(L*T,L),D=e[N],w.set(D.matrixWorld.elements[12],D.matrixWorld.elements[13],D.matrixWorld.elements[14]),w.applyMatrix4(E.matrixWorldInverse),w.applyProjection(E.projectionMatrix),C.copy(w),P.x=M.x+C.x*S+S-8,P.y=M.y+C.y*A+A-8,!0===O.containsPoint(P)){m.activeTexture(f.TEXTURE0),m.bindTexture(f.TEXTURE_2D,null),m.activeTexture(f.TEXTURE1),m.bindTexture(f.TEXTURE_2D,b),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGB,P.x,P.y,16,16,0),f.uniform1i(r,0),f.uniform2f(l,R.x,R.y),f.uniform3f(h,C.x,C.y,C.z),m.disable(f.BLEND),m.enable(f.DEPTH_TEST),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),m.activeTexture(f.TEXTURE0),m.bindTexture(f.TEXTURE_2D,x),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,P.x,P.y,16,16,0),f.uniform1i(r,1),m.disable(f.DEPTH_TEST),m.activeTexture(f.TEXTURE1),m.bindTexture(f.TEXTURE_2D,b),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),D.positionScreen.copy(C),D.customUpdateCallback?D.customUpdateCallback(D):D.updateLensFlares(),f.uniform1i(r,2),m.enable(f.BLEND);for(var U=0,F=D.lensFlares.length;U<F;U++){var B=D.lensFlares[U];.001<B.opacity&&.001<B.scale&&(C.x=B.x,C.y=B.y,C.z=B.z,L=B.size*B.scale/M.w,R.x=L*T,R.y=L,f.uniform3f(h,C.x,C.y,C.z),f.uniform2f(l,R.x,R.y),f.uniform1f(u,B.rotation),f.uniform1f(a,B.opacity),f.uniform3f(s,B.color.r,B.color.g,B.color.b),m.setBlending(B.blending,B.blendEquation,B.blendSrc,B.blendDst),t.setTexture2D(B.texture,1),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0))}}m.enable(f.CULL_FACE),m.enable(f.DEPTH_TEST),m.setDepthWrite(!0),t.resetGLState()}}}function X(t,e){function n(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var i,o,a,l,u,h,d,p,f,m,g,v,y,_,b,x,w,E=t.context,M=t.state,T,S,A,L,R=new c,C=new s,P=new c;this.render=function(s,c){if(0!==e.length){if(void 0===A){var O=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),N=new Uint16Array([0,1,2,0,2,3]);T=E.createBuffer(),S=E.createBuffer(),E.bindBuffer(E.ARRAY_BUFFER,T),E.bufferData(E.ARRAY_BUFFER,O,E.STATIC_DRAW),E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,S),E.bufferData(E.ELEMENT_ARRAY_BUFFER,N,E.STATIC_DRAW);var O=E.createProgram(),N=E.createShader(E.VERTEX_SHADER),I=E.createShader(E.FRAGMENT_SHADER);E.shaderSource(N,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),E.shaderSource(I,["precision "+t.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),E.compileShader(N),E.compileShader(I),E.attachShader(O,N),E.attachShader(O,I),E.linkProgram(O),A=O,x=E.getAttribLocation(A,"position"),w=E.getAttribLocation(A,"uv"),i=E.getUniformLocation(A,"uvOffset"),o=E.getUniformLocation(A,"uvScale"),a=E.getUniformLocation(A,"rotation"),l=E.getUniformLocation(A,"scale"),u=E.getUniformLocation(A,"color"),h=E.getUniformLocation(A,"map"),d=E.getUniformLocation(A,"opacity"),p=E.getUniformLocation(A,"modelViewMatrix"),f=E.getUniformLocation(A,"projectionMatrix"),m=E.getUniformLocation(A,"fogType"),g=E.getUniformLocation(A,"fogDensity"),v=E.getUniformLocation(A,"fogNear"),y=E.getUniformLocation(A,"fogFar"),_=E.getUniformLocation(A,"fogColor"),b=E.getUniformLocation(A,"alphaTest"),O=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),O.width=8,O.height=8,N=O.getContext("2d"),N.fillStyle="white",N.fillRect(0,0,8,8),L=new r(O),L.needsUpdate=!0}E.useProgram(A),M.initAttributes(),M.enableAttribute(x),M.enableAttribute(w),M.disableUnusedAttributes(),M.disable(E.CULL_FACE),M.enable(E.BLEND),E.bindBuffer(E.ARRAY_BUFFER,T),E.vertexAttribPointer(x,2,E.FLOAT,!1,16,0),E.vertexAttribPointer(w,2,E.FLOAT,!1,16,8),E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,S),E.uniformMatrix4fv(f,!1,c.projectionMatrix.elements),M.activeTexture(E.TEXTURE0),E.uniform1i(h,0),N=O=0,(I=s.fog)?(E.uniform3f(_,I.color.r,I.color.g,I.color.b),I.isFog?(E.uniform1f(v,I.near),E.uniform1f(y,I.far),E.uniform1i(m,1),N=O=1):I.isFogExp2&&(E.uniform1f(g,I.density),E.uniform1i(m,2),N=O=2)):(E.uniform1i(m,0),N=O=0);for(var I=0,D=e.length;I<D;I++){var U=e[I];U.modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,U.matrixWorld),U.z=-U.modelViewMatrix.elements[14]}e.sort(n);for(var F=[],I=0,D=e.length;I<D;I++){var U=e[I],B=U.material;!1!==B.visible&&(E.uniform1f(b,B.alphaTest),E.uniformMatrix4fv(p,!1,U.modelViewMatrix.elements),U.matrixWorld.decompose(R,C,P),F[0]=P.x,F[1]=P.y,U=0,s.fog&&B.fog&&(U=N),O!==U&&(E.uniform1i(m,U),O=U),null!==B.map?(E.uniform2f(i,B.map.offset.x,B.map.offset.y),E.uniform2f(o,B.map.repeat.x,B.map.repeat.y)):(E.uniform2f(i,0,0),E.uniform2f(o,1,1)),E.uniform1f(d,B.opacity),E.uniform3f(u,B.color.r,B.color.g,B.color.b),E.uniform1f(a,B.rotation),E.uniform2fv(l,F),M.setBlending(B.blending,B.blendEquation,B.blendSrc,B.blendDst),M.setDepthTest(B.depthTest),M.setDepthWrite(B.depthWrite),B.map?t.setTexture2D(B.map,0):t.setTexture2D(L,0),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0))}M.enable(E.CULL_FACE),t.resetGLState()}}}function q(){Object.defineProperty(this,"id",{value:mi++}),this.uuid=ri.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.shading=2,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.premultipliedAlpha=!1,this.overdraw=0,this._needsUpdate=this.visible=!0}function Y(t){q.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Z(t){q.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(t)}function J(t,e){this.min=void 0!==t?t:new c(1/0,1/0,1/0),this.max=void 0!==e?e:new c(-(1/0),-(1/0),-(1/0))}function Q(t,e){this.center=void 0!==t?t:new c,this.radius=void 0!==e?e:0}function K(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function tt(t,e){this.normal=void 0!==t?t:new c(1,0,0),this.constant=void 0!==e?e:0}function et(t,e,n,r,i,o){this.planes=[void 0!==t?t:new tt,void 0!==e?e:new tt,void 0!==n?n:new tt,void 0!==r?r:new tt,void 0!==i?i:new tt,void 0!==o?o:new tt]}function nt(t,e,r,a){function s(e,n,r,i){var o=e.geometry,a;a=x;var s=e.customDepthMaterial;return r&&(a=w,s=e.customDistanceMaterial),s?a=s:(s=!1,n.morphTargets&&(o&&o.isBufferGeometry?s=o.morphAttributes&&o.morphAttributes.position&&0<o.morphAttributes.position.length:o&&o.isGeometry&&(s=o.morphTargets&&0<o.morphTargets.length)),e=e.isSkinnedMesh&&n.skinning,o=0,s&&(o|=1),e&&(o|=2),a=a[o]),t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length&&(o=a.uuid,s=n.uuid,e=E[o],void 0===e&&(e={},E[o]=e),o=e[s],void 0===o&&(o=a.clone(),e[s]=o),a=o),a.visible=n.visible,a.wireframe=n.wireframe,s=n.side,O.renderSingleSided&&2==s&&(s=0),O.renderReverseSided&&(0===s?s=1:1===s&&(s=0)),a.side=s,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,r&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(i),a}function u(t,e,n){if(!1!==t.visible){0!==(t.layers.mask&e.layers.mask)&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(!1===t.frustumCulled||!0===p.intersectsObject(t))&&!0===t.material.visible&&(t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),b.push(t)),t=t.children;for(var r=0,i=t.length;r<i;r++)u(t[r],e,n)}}var h=t.context,d=t.state,p=new et,f=new l,m=e.shadows,g=new n,v=new n(a.maxTextureSize,a.maxTextureSize),y=new c,_=new c,b=[],x=Array(4),w=Array(4),E={},M=[new c(1,0,0),new c(-1,0,0),new c(0,0,1),new c(0,0,-1),new c(0,1,0),new c(0,-1,0)],T=[new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,0,1),new c(0,0,-1)],S=[new i,new i,new i,new i,new i,new i];e=new Z,e.depthPacking=3201,e.clipping=!0,a=fi.distanceRGBA;for(var A=ui.clone(a.uniforms),L=0;4!==L;++L){var R=0!==(1&L),C=0!==(2&L),P=e.clone();P.morphTargets=R,P.skinning=C,x[L]=P,R=new Y({defines:{USE_SHADOWMAP:""},uniforms:A,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,morphTargets:R,skinning:C,clipping:!0}),w[L]=R}var O=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderSingleSided=this.renderReverseSided=!0,this.render=function(e,n){if(!1!==O.enabled&&(!1!==O.autoUpdate||!1!==O.needsUpdate)&&0!==m.length){d.buffers.color.setClear(1,1,1,1),d.disable(h.BLEND),d.setDepthTest(!0),d.setScissorTest(!1);for(var i,a,c=0,l=m.length;c<l;c++){var x=m[c],w=x.shadow;if(void 0===w)console.warn("THREE.WebGLShadowMap:",x,"has no shadow.");else{var E=w.camera;if(g.copy(w.mapSize),g.min(v),x&&x.isPointLight){i=6,a=!0;var A=g.x,L=g.y;S[0].set(2*A,L,A,L),S[1].set(0,L,A,L),S[2].set(3*A,L,A,L),S[3].set(A,L,A,L),S[4].set(3*A,0,A,L),S[5].set(A,0,A,L),g.x*=4,g.y*=2}else i=1,a=!1;for(null===w.map&&(w.map=new o(g.x,g.y,{minFilter:1003,magFilter:1003,format:1023}),E.updateProjectionMatrix()),w.isSpotLightShadow&&w.update(x),w&&w.isRectAreaLightShadow&&w.update(x),A=w.map,w=w.matrix,_.setFromMatrixPosition(x.matrixWorld),E.position.copy(_),t.setRenderTarget(A),t.clear(),A=0;A<i;A++){a?(y.copy(E.position),y.add(M[A]),E.up.copy(T[A]),E.lookAt(y),d.viewport(S[A])):(y.setFromMatrixPosition(x.target.matrixWorld),E.lookAt(y)),E.updateMatrixWorld(),E.matrixWorldInverse.getInverse(E.matrixWorld),w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),w.multiply(E.projectionMatrix),w.multiply(E.matrixWorldInverse),f.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse),p.setFromMatrix(f),b.length=0,u(e,n,E);for(var L=0,R=b.length;L<R;L++){var C=b[L],P=r.update(C),N=C.material;if(N&&N.isMultiMaterial)for(var I=P.groups,N=N.materials,D=0,U=I.length;D<U;D++){var F=I[D],B=N[F.materialIndex];!0===B.visible&&(B=s(C,B,a,_),t.renderBufferDirect(E,null,P,B,C,F))}else B=s(C,N,a,_),t.renderBufferDirect(E,null,P,B,C,null)}}}}i=t.getClearColor(),a=t.getClearAlpha(),t.setClearColor(i,a),O.needsUpdate=!1}}}function rt(t,e){this.origin=void 0!==t?t:new c,this.direction=void 0!==e?e:new c}function it(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||it.DefaultOrder}function ot(){this.mask=1}function at(){Object.defineProperty(this,"id",{value:gi++}),this.uuid=ri.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=at.DefaultUp.clone();var t=new c,e=new it,n=new s,r=new c(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new l},normalMatrix:{value:new K}}),this.matrix=new l,this.matrixWorld=new l,this.matrixAutoUpdate=at.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ot,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=function(){},this.onAfterRender=function(){}}function st(t,e){this.start=void 0!==t?t:new c,this.end=void 0!==e?e:new c}function ct(t,e,n){this.a=void 0!==t?t:new c,this.b=void 0!==e?e:new c,this.c=void 0!==n?n:new c}function lt(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new c,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new H,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function ut(t){q.call(this),this.type="MeshBasicMaterial",this.color=new H(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(t)}function ht(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=ri.generateUUID(),this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function dt(t,e){ht.call(this,new Int8Array(t),e)}function pt(t,e){ht.call(this,new Uint8Array(t),e)}function ft(t,e){ht.call(this,new Uint8ClampedArray(t),e)}function mt(t,e){ht.call(this,new Int16Array(t),e)}function gt(t,e){ht.call(this,new Uint16Array(t),e)}function vt(t,e){ht.call(this,new Int32Array(t),e)}function yt(t,e){ht.call(this,new Uint32Array(t),e)}function _t(t,e){ht.call(this,new Float32Array(t),e)}function bt(t,e){ht.call(this,new Float64Array(t),e)}function xt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function wt(){Object.defineProperty(this,"id",{value:vi++}),this.uuid=ri.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function Et(){Object.defineProperty(this,"id",{value:vi++}),this.uuid=ri.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}}function Mt(t,e){at.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Et,this.material=void 0!==e?e:new ut({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function Tt(t,e,n,r,i,o){function a(t,e,n,r,i,o,a,l,u,b,x){var w=o/u,E=a/b,M=o/2,T=a/2,S=l/2;a=u+1;for(var A=b+1,L=o=0,R=new c,C=0;C<A;C++)for(var P=C*E-T,O=0;O<a;O++)R[t]=(O*w-M)*r,R[e]=P*i,R[n]=S,d[m]=R.x,d[m+1]=R.y,d[m+2]=R.z,R[t]=0,R[e]=0,R[n]=0<l?1:-1,p[m]=R.x,p[m+1]=R.y,p[m+2]=R.z,f[g]=O/u,f[g+1]=1-C/b,m+=3,g+=2,o+=1;for(C=0;C<b;C++)for(O=0;O<u;O++)t=y+O+a*(C+1),e=y+(O+1)+a*(C+1),n=y+(O+1)+a*C,h[v]=y+O+a*C,h[v+1]=t,h[v+2]=n,h[v+3]=t,h[v+4]=e,h[v+5]=n,v+=6,L+=6;s.addGroup(_,L,x),_+=L,y+=o}Et.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var s=this;r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var l=function(t,e,n){return t=0+(t+1)*(e+1)*2+(t+1)*(n+1)*2+(n+1)*(e+1)*2}(r,i,o),u=function(t,e,n){return t=0+t*e*2+t*n*2+n*e*2,6*t}(r,i,o),h=new(65535<u?Uint32Array:Uint16Array)(u),d=new Float32Array(3*l),p=new Float32Array(3*l),f=new Float32Array(2*l),m=0,g=0,v=0,y=0,_=0;a("z","y","x",-1,-1,n,e,t,o,i,0),a("z","y","x",1,-1,n,e,-t,o,i,1),a("x","z","y",1,1,t,n,e,r,o,2),a("x","z","y",1,-1,t,n,-e,r,o,3),a("x","y","z",1,-1,t,e,n,r,i,4),a("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(new ht(h,1)),this.addAttribute("position",new ht(d,3)),this.addAttribute("normal",new ht(p,3)),this.addAttribute("uv",new ht(f,2))}function St(t,e,n,r){Et.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i=t/2,o=e/2;n=Math.floor(n)||1,r=Math.floor(r)||1;var a=n+1,s=r+1,c=t/n,l=e/r;e=new Float32Array(a*s*3),t=new Float32Array(a*s*3);for(var u=new Float32Array(a*s*2),h=0,d=0,p=0;p<s;p++)for(var f=p*l-o,m=0;m<a;m++)e[h]=m*c-i,e[h+1]=-f,t[h+2]=1,u[d]=m/n,u[d+1]=1-p/r,h+=3,d+=2;for(h=0,i=new(65535<e.length/3?Uint32Array:Uint16Array)(n*r*6),p=0;p<r;p++)for(m=0;m<n;m++)o=m+a*(p+1),s=m+1+a*(p+1),c=m+1+a*p,i[h]=m+a*p,i[h+1]=o,i[h+2]=c,i[h+3]=o,i[h+4]=s,i[h+5]=c,h+=6;this.setIndex(new ht(i,1)),this.addAttribute("position",new ht(e,3)),this.addAttribute("normal",new ht(t,3)),this.addAttribute("uv",new ht(u,2))}function At(){at.call(this),this.type="Camera",this.matrixWorldInverse=new l,this.projectionMatrix=new l}function Lt(t,e,n,r){At.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Rt(t,e,n,r,i,o){At.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Ct(t,e,n){var r,i,o;return{setMode:function(t){r=t},setIndex:function(n){n.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(i=t.UNSIGNED_INT,o=4):n.array instanceof Uint16Array?(i=t.UNSIGNED_SHORT,o=2):(i=t.UNSIGNED_BYTE,o=1)},render:function(e,a){t.drawElements(r,a,i,e*o),n.calls++,n.vertices+=a,r===t.TRIANGLES&&(n.faces+=a/3)},renderInstances:function(a,s,c){var l=e.get("ANGLE_instanced_arrays");null===l?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(l.drawElementsInstancedANGLE(r,c,i,s*o,a.maxInstancedCount),n.calls++,n.vertices+=c*a.maxInstancedCount,r===t.TRIANGLES&&(n.faces+=a.maxInstancedCount*c/3))}}}function Pt(t,e,n){var r;return{setMode:function(t){r=t},render:function(e,i){t.drawArrays(r,e,i),n.calls++,n.vertices+=i,r===t.TRIANGLES&&(n.faces+=i/3)},renderInstances:function(i){var o=e.get("ANGLE_instanced_arrays");if(null===o)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var a=i.attributes.position,a=a.isInterleavedBufferAttribute?a.data.count:a.count;o.drawArraysInstancedANGLE(r,0,a,i.maxInstancedCount),n.calls++,n.vertices+=a*i.maxInstancedCount,r===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*a/3)}}}}function Ot(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var r;switch(e.type){case"DirectionalLight":r={direction:new c,color:new H,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"SpotLight":r={position:new c,direction:new c,color:new H,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"PointLight":r={position:new c,color:new H,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"HemisphereLight":r={direction:new c,skyColor:new H,groundColor:new H};break;case"RectAreaLight":r={color:new H,position:new c,halfWidth:new c,halfHeight:new c}}return t[e.id]=r}}}function Nt(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}function It(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),Nt(n)),r}function Dt(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:
return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+t)}}function Ut(t,e){var n=Dt(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Ft(t,e){var n=Dt(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Bt(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function zt(t,e,n){return t=t||{},[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jt).join("\n")}function kt(t){var e=[],n;for(n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}function jt(t){return""!==t}function Ht(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Gt(t){return t.replace(/#include +<([\w\d.]+)>/g,function(t,e){var n=hi[e];if(void 0===n)throw Error("Can not resolve #include <"+e+">");return Gt(n)})}function Vt(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,r){for(t="",e=parseInt(e);e<parseInt(n);e++)t+=r.replace(/\[ i \]/g,"[ "+e+" ]");return t})}function Wt(t,e,n,r){var i=t.context,o=n.extensions,a=n.defines,s=n.__webglShader.vertexShader,c=n.__webglShader.fragmentShader,l="SHADOWMAP_TYPE_BASIC";1===r.shadowMapType?l="SHADOWMAP_TYPE_PCF":2===r.shadowMapType&&(l="SHADOWMAP_TYPE_PCF_SOFT");var u="ENVMAP_TYPE_CUBE",h="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(r.envMap){switch(n.envMap.mapping){case 301:case 302:u="ENVMAP_TYPE_CUBE";break;case 306:case 307:u="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:u="ENVMAP_TYPE_EQUIREC";break;case 305:u="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case 302:case 304:h="ENVMAP_MODE_REFRACTION"}switch(n.combine){case 0:d="ENVMAP_BLENDING_MULTIPLY";break;case 1:d="ENVMAP_BLENDING_MIX";break;case 2:d="ENVMAP_BLENDING_ADD"}}var p=0<t.gammaFactor?t.gammaFactor:1,o=zt(o,r,t.extensions),f=kt(a),m=i.createProgram();n.isRawShaderMaterial?(a=[f,"\n"].filter(jt).join("\n"),l=[o,f,"\n"].filter(jt).join("\n")):(a=["precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,f,r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+r.maxBones,r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+h:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(jt).join("\n"),l=[o,"precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,f,r.alphaTest?"#define ALPHATEST "+r.alphaTest:"","#define GAMMA_FACTOR "+p,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.envMap?"#define "+h:"",r.envMap?"#define "+d:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(r.numClippingPlanes-r.numClipIntersection),r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",r.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?hi.tonemapping_pars_fragment:"",0!==r.toneMapping?Bt("toneMapping",r.toneMapping):"",r.outputEncoding||r.mapEncoding||r.envMapEncoding||r.emissiveMapEncoding?hi.encodings_pars_fragment:"",r.mapEncoding?Ut("mapTexelToLinear",r.mapEncoding):"",r.envMapEncoding?Ut("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMapEncoding?Ut("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.outputEncoding?Ft("linearToOutputTexel",r.outputEncoding):"",r.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(jt).join("\n")),s=Gt(s,r),s=Ht(s,r),c=Gt(c,r),c=Ht(c,r),n.isShaderMaterial||(s=Vt(s),c=Vt(c)),c=l+c,s=It(i,i.VERTEX_SHADER,a+s),c=It(i,i.FRAGMENT_SHADER,c),i.attachShader(m,s),i.attachShader(m,c),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===r.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),r=i.getProgramInfoLog(m),u=i.getShaderInfoLog(s),h=i.getShaderInfoLog(c),p=d=!0,!1===i.getProgramParameter(m,i.LINK_STATUS)?(d=!1,console.error("THREE.WebGLProgram: shader error: ",i.getError(),"gl.VALIDATE_STATUS",i.getProgramParameter(m,i.VALIDATE_STATUS),"gl.getProgramInfoLog",r,u,h)):""!==r?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",r):""!==u&&""!==h||(p=!1),p&&(this.diagnostics={runnable:d,material:n,programLog:r,vertexShader:{log:u,prefix:a},fragmentShader:{log:h,prefix:l}}),i.deleteShader(s),i.deleteShader(c);var g;this.getUniforms=function(){return void 0===g&&(g=new j(i,m,t)),g};var v;return this.getAttributes=function(){if(void 0===v){for(var t={},e=i.getProgramParameter(m,i.ACTIVE_ATTRIBUTES),n=0;n<e;n++){var r=i.getActiveAttrib(m,n).name;t[r]=i.getAttribLocation(m,r)}v=t}return v},this.destroy=function(){i.deleteProgram(m),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=yi++,this.code=e,this.usedTimes=1,this.program=m,this.vertexShader=s,this.fragmentShader=c,this}function Xt(t,e){function n(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=3e3,3e3===n&&e&&(n=3007),n}var r=[],i={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},o="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking".split(" ");this.getParameters=function(r,o,a,s,c,l){var u=i[r.type],h;e.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture?h=1024:(h=Math.floor((e.maxVertexUniforms-20)/4),void 0!==l&&l&&l.isSkinnedMesh&&(h=Math.min(l.skeleton.bones.length,h),h<l.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+l.skeleton.bones.length+", this GPU supports just "+h+" (try OpenGL instead of ANGLE)")));var d=t.getPrecision();null!==r.precision&&(d=e.getMaxPrecision(r.precision),d!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",d,"instead."));var p=t.getCurrentRenderTarget();return{shaderID:u,precision:d,supportsVertexTextures:e.vertexTextures,outputEncoding:n(p?p.texture:null,t.gammaOutput),map:!!r.map,mapEncoding:n(r.map,t.gammaInput),envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,envMapEncoding:n(r.envMap,t.gammaInput),envMapCubeUV:!!r.envMap&&(306===r.envMap.mapping||307===r.envMap.mapping),lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:n(r.emissiveMap,t.gammaInput),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,combine:r.combine,vertexColors:r.vertexColors,fog:!!a,useFog:r.fog,fogExp:a&&a.isFogExp2,flatShading:1===r.shading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:r.skinning,maxBones:h,useVertexTexture:e.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numClippingPlanes:s,numClipIntersection:c,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&0<o.shadows.length,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking}},this.getProgramCode=function(t,e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);for(r=0;r<o.length;r++)n.push(e[o[r]]);return n.join()},this.acquireProgram=function(e,n,i){for(var o,a=0,s=r.length;a<s;a++){var c=r[a];if(c.code===i){o=c,++o.usedTimes;break}}return void 0===o&&(o=new Wt(t,i,e,n),r.push(o)),o},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function qt(t,e,n){function r(t){var a=t.target;t=o[a.id],null!==t.index&&i(t.index);var s=t.attributes,c;for(c in s)i(s[c]);a.removeEventListener("dispose",r),delete o[a.id],c=e.get(a),c.wireframe&&i(c.wireframe),e.delete(a),a=e.get(t),a.wireframe&&i(a.wireframe),e.delete(t),n.memory.geometries--}function i(n){var r;r=n.isInterleavedBufferAttribute?e.get(n.data).__webglBuffer:e.get(n).__webglBuffer,void 0!==r&&(t.deleteBuffer(r),n.isInterleavedBufferAttribute?e.delete(n.data):e.delete(n))}var o={};return{get:function(t){var e=t.geometry;if(void 0!==o[e.id])return o[e.id];e.addEventListener("dispose",r);var i;return e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Et).setFromObject(t)),i=e._bufferGeometry),o[e.id]=i,n.memory.geometries++,i}}}function Yt(t,e,n){function r(n,r){var i=n.isInterleavedBufferAttribute?n.data:n,o=e.get(i);if(void 0===o.__webglBuffer){o.__webglBuffer=t.createBuffer(),t.bindBuffer(r,o.__webglBuffer),t.bufferData(r,i.array,i.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW);var a=t.FLOAT,s=i.array;s instanceof Float32Array?a=t.FLOAT:s instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):s instanceof Uint16Array?a=t.UNSIGNED_SHORT:s instanceof Int16Array?a=t.SHORT:s instanceof Uint32Array?a=t.UNSIGNED_INT:s instanceof Int32Array?a=t.INT:s instanceof Int8Array?a=t.BYTE:s instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),o.bytesPerElement=s.BYTES_PER_ELEMENT,o.type=a,o.version=i.version,i.onUploadCallback()}else o.version!==i.version&&(t.bindBuffer(r,o.__webglBuffer),!1===i.dynamic?t.bufferData(r,i.array,t.STATIC_DRAW):-1===i.updateRange.count?t.bufferSubData(r,0,i.array):0===i.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),o.version=i.version)}var i=new qt(t,e,n);return{getAttributeBuffer:function(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer},getAttributeProperties:function(t){return t.isInterleavedBufferAttribute?e.get(t.data):e.get(t)},getWireframeAttribute:function(n){var i=e.get(n);if(void 0!==i.wireframe)return i.wireframe;var o=[],a=n.index,s=n.attributes;if(n=s.position,null!==a)for(var a=a.array,s=0,c=a.length;s<c;s+=3){var l=a[s+0],u=a[s+1],h=a[s+2];o.push(l,u,u,h,h,l)}else for(a=s.position.array,s=0,c=a.length/3-1;s<c;s+=3)l=s+0,u=s+1,h=s+2,o.push(l,u,u,h,h,l);return o=new ht(new(65535<n.count?Uint32Array:Uint16Array)(o),1),r(o,t.ELEMENT_ARRAY_BUFFER),i.wireframe=o},update:function(e){var n=i.get(e);e.geometry.isGeometry&&n.updateFromObject(e),e=n.index;var o=n.attributes;null!==e&&r(e,t.ELEMENT_ARRAY_BUFFER);for(var a in o)r(o[a],t.ARRAY_BUFFER);e=n.morphAttributes;for(a in e)for(var o=e[a],s=0,c=o.length;s<c;s++)r(o[s],t.ARRAY_BUFFER);return n}}}function Zt(t,e,n,r,i,o,a){function s(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function c(t){return ri.isPowerOfTwo(t.width)&&ri.isPowerOfTwo(t.height)}function l(e){return 1003===e||1004===e||1005===e?t.NEAREST:t.LINEAR}function u(e){e=e.target,e.removeEventListener("dispose",u);t:{var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)break t;t.deleteTexture(n.__webglTexture)}r.delete(e)}g.textures--}function h(e){e=e.target,e.removeEventListener("dispose",h);var n=r.get(e),i=r.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(i=0;6>i;i++)t.deleteFramebuffer(n.__webglFramebuffer[i]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[i]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.delete(e.texture),r.delete(e)}g.textures--}function d(e,a){var l=r.get(e);if(0<e.version&&l.__version!==e.version){var h=e.image;if(void 0===h)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==h.complete){void 0===l.__webglInit&&(l.__webglInit=!0,e.addEventListener("dispose",u),l.__webglTexture=t.createTexture(),g.textures++),n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_2D,l.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,e.unpackAlignment);var d=s(e.image,i.maxTextureSize);if((1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)&&!1===c(d))if(h=d,h instanceof HTMLImageElement||h instanceof HTMLCanvasElement){var f=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");f.width=ri.nearestPowerOfTwo(h.width),f.height=ri.nearestPowerOfTwo(h.height),f.getContext("2d").drawImage(h,0,0,f.width,f.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+h.width+"x"+h.height+"). Resized to "+f.width+"x"+f.height,h),d=f}else d=h;var h=c(d),f=o(e.format),m=o(e.type);p(t.TEXTURE_2D,e,h);var y=e.mipmaps;if(e.isDepthTexture){if(y=t.DEPTH_COMPONENT,1015===e.type){if(!v)throw Error("Float Depth Texture only supported in WebGL2.0");y=t.DEPTH_COMPONENT32F}else v&&(y=t.DEPTH_COMPONENT16);1026===e.format&&y===t.DEPTH_COMPONENT&&1012!==e.type&&1014!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=1012,m=o(e.type)),1027===e.format&&(y=t.DEPTH_STENCIL,1020!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=1020,m=o(e.type))),n.texImage2D(t.TEXTURE_2D,0,y,d.width,d.height,0,f,m,null)}else if(e.isDataTexture)if(0<y.length&&h){for(var _=0,b=y.length;_<b;_++)d=y[_],n.texImage2D(t.TEXTURE_2D,_,f,d.width,d.height,0,f,m,d.data);e.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,f,d.width,d.height,0,f,m,d.data);else if(e.isCompressedTexture)for(_=0,b=y.length;_<b;_++)d=y[_],1023!==e.format&&1022!==e.format?-1<n.getCompressedTextureFormats().indexOf(f)?n.compressedTexImage2D(t.TEXTURE_2D,_,f,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,_,f,d.width,d.height,0,f,m,d.data);else if(0<y.length&&h){for(_=0,b=y.length;_<b;_++)d=y[_],n.texImage2D(t.TEXTURE_2D,_,f,f,m,d);e.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,f,f,m,d);return e.generateMipmaps&&h&&t.generateMipmap(t.TEXTURE_2D),l.__version=e.version,void(e.onUpdate&&e.onUpdate(e))}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_2D,l.__webglTexture)}function p(n,a,s){s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,l(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,l(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),!(s=e.get("EXT_texture_filter_anisotropic"))||1015===a.type&&null===e.get("OES_texture_float_linear")||1016===a.type&&null===e.get("OES_texture_half_float_linear")||!(1<a.anisotropy||r.get(a).__currentAnisotropy)||(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}function f(e,i,a,s){var c=o(i.texture.format),l=o(i.texture.type);n.texImage2D(s,0,c,i.width,i.height,0,c,l,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function m(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}var g=a.memory,v="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext;this.setTexture2D=d,this.setTextureCube=function(e,a){var l=r.get(e);if(6===e.image.length)if(0<e.version&&l.__version!==e.version){l.__image__webglTextureCube||(e.addEventListener("dispose",u),l.__image__webglTextureCube=t.createTexture(),g.textures++),n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_CUBE_MAP,l.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var h=e&&e.isCompressedTexture,d=e.image[0]&&e.image[0].isDataTexture,f=[],m=0;6>m;m++)f[m]=h||d?d?e.image[m].image:e.image[m]:s(e.image[m],i.maxCubemapSize);var v=c(f[0]),y=o(e.format),_=o(e.type);for(p(t.TEXTURE_CUBE_MAP,e,v),m=0;6>m;m++)if(h)for(var b,x=f[m].mipmaps,w=0,E=x.length;w<E;w++)b=x[w],1023!==e.format&&1022!==e.format?-1<n.getCompressedTextureFormats().indexOf(y)?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+m,w,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+m,w,y,b.width,b.height,0,y,_,b.data);else d?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,y,f[m].width,f[m].height,0,y,_,f[m].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,y,y,_,f[m]);e.generateMipmaps&&v&&t.generateMipmap(t.TEXTURE_CUBE_MAP),l.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_CUBE_MAP,l.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)},this.setupRenderTarget=function(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",h),o.__webglTexture=t.createTexture(),g.textures++;var a=!0===e.isWebGLRenderTargetCube,s=c(e);if(a){i.__webglFramebuffer=[];for(var l=0;6>l;l++)i.__webglFramebuffer[l]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(a){for(n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),p(t.TEXTURE_CUBE_MAP,e.texture,s),l=0;6>l;l++)f(i.__webglFramebuffer[l],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+l);e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_CUBE_MAP),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),p(t.TEXTURE_2D,e.texture,s),f(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_2D),n.bindTexture(t.TEXTURE_2D,null);if(e.depthBuffer){if(i=r.get(e),o=!0===e.isWebGLRenderTargetCube,e.depthTexture){if(o)throw Error("target.depthTexture not supported in Cube render targets");if(e&&e.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported!");if(t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),!e.depthTexture||!e.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(r.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),d(e.depthTexture,0),i=r.get(e.depthTexture).__webglTexture,1026===e.depthTexture.format)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(1027!==e.depthTexture.format)throw Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}else if(o)for(i.__webglDepthbuffer=[],o=0;6>o;o++)t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=t.createRenderbuffer(),m(i.__webglDepthbuffer[o],e);else t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),m(i.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(e){var i=e.texture;i.generateMipmaps&&c(e)&&1003!==i.minFilter&&1006!==i.minFilter&&(e=e&&e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,i=r.get(i).__webglTexture,n.bindTexture(e,i),t.generateMipmap(e),n.bindTexture(e,null))}}function Jt(){var t={};return{get:function(e){e=e.uuid;var n=t[e];return void 0===n&&(n={},t[e]=n),n},delete:function(e){delete t[e.uuid]},clear:function(){t={}}}}function $t(t,e,n){function r(e,n,r){var i=new Uint8Array(4),o=t.createTexture();for(t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST),e=0;e<r;e++)t.texImage2D(n+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}function o(e){!0!==_[e]&&(t.enable(e),_[e]=!0)}function a(e){!1!==_[e]&&(t.disable(e),_[e]=!1)}function s(e,r,i,s,c,l,u,h){0!==e?o(t.BLEND):a(t.BLEND),e===x&&h===L||(2===e?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):3===e?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):4===e?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),x=e,L=h),5===e?(c=c||r,l=l||i,u=u||s,r===w&&c===T||(t.blendEquationSeparate(n(r),n(c)),w=r,T=c),i===E&&s===M&&l===S&&u===A||(t.blendFuncSeparate(n(i),n(s),n(l),n(u)),E=i,M=s,S=l,A=u)):A=S=T=M=E=w=null}function c(t){p.setFunc(t)}function l(e){R!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),R=e)}function u(e){0!==e?(o(t.CULL_FACE),e!==C&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):a(t.CULL_FACE),C=e}function h(e){void 0===e&&(e=t.TEXTURE0+D-1),F!==e&&(t.activeTexture(e),F=e)}var d=new function(){var e=!1,n=new i,r=null,o=new i;return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,i,a,s){!0===s&&(e*=a,r*=a,i*=a),n.set(e,r,i,a),!1===o.equals(n)&&(t.clearColor(e,r,i,a),o.copy(n))},reset:function(){e=!1,r=null,o.set(0,0,0,1)}}},p=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(e){e?o(t.DEPTH_TEST):a(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,i=r=n=null}}},f=new function(){var e=!1,n=null,r=null,i=null,s=null,c=null,l=null,u=null,h=null;return{setTest:function(e){e?o(t.STENCIL_TEST):a(t.STENCIL_TEST)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,o){r===e&&i===n&&s===o||(t.stencilFunc(e,n,o),r=e,i=n,s=o)},setOp:function(e,n,r){c===e&&l===n&&u===r||(t.stencilOp(e,n,r),c=e,l=n,u=r)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,h=u=l=c=s=i=r=n=null}}},m=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=new Uint8Array(m),v=new Uint8Array(m),y=new Uint8Array(m),_={},b=null,x=null,w=null,E=null,M=null,T=null,S=null,A=null,L=!1,R=null,C=null,P=null,O=null,N=null,I=null,D=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),m=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),U=1<=parseFloat(m),F=null,B={},z=new i,k=new i,j={};return j[t.TEXTURE_2D]=r(t.TEXTURE_2D,t.TEXTURE_2D,1),j[t.TEXTURE_CUBE_MAP]=r(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:d,depth:p,stencil:f},init:function(){d.setClear(0,0,0,1),p.setClear(1),f.setClear(0),o(t.DEPTH_TEST),c(3),l(!1),u(1),o(t.CULL_FACE),o(t.BLEND),s(1)},initAttributes:function(){for(var t=0,e=g.length;t<e;t++)g[t]=0},enableAttribute:function(n){g[n]=1,0===v[n]&&(t.enableVertexAttribArray(n),v[n]=1),0!==y[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),y[n]=0)},enableAttributeAndDivisor:function(e,n,r){g[e]=1,0===v[e]&&(t.enableVertexAttribArray(e),v[e]=1),y[e]!==n&&(r.vertexAttribDivisorANGLE(e,n),y[e]=n)},disableUnusedAttributes:function(){for(var e=0,n=v.length;e!==n;++e)v[e]!==g[e]&&(t.disableVertexAttribArray(e),v[e]=0)},enable:o,disable:a,getCompressedTextureFormats:function(){if(null===b&&(b=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)b.push(n[r]);return b},setBlending:s,setColorWrite:function(t){d.setMask(t)},setDepthTest:function(t){p.setTest(t)},setDepthWrite:function(t){p.setMask(t)},setDepthFunc:c,setStencilTest:function(t){f.setTest(t)},setStencilWrite:function(t){f.setMask(t)},setStencilFunc:function(t,e,n){f.setFunc(t,e,n)},setStencilOp:function(t,e,n){f.setOp(t,e,n)},setFlipSided:l,setCullFace:u,setLineWidth:function(e){e!==P&&(U&&t.lineWidth(e),P=e)},setPolygonOffset:function(e,n,r){e?(o(t.POLYGON_OFFSET_FILL),(O!==n||N!==r)&&(t.polygonOffset(n,r),O=n,N=r)):a(t.POLYGON_OFFSET_FILL)},getScissorTest:function(){return I},setScissorTest:function(e){(I=e)?o(t.SCISSOR_TEST):a(t.SCISSOR_TEST)},activeTexture:h,bindTexture:function(e,n){null===F&&h();var r=B[F];void 0===r&&(r={
type:void 0,texture:void 0},B[F]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||j[e]),r.type=e,r.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}},scissor:function(e){!1===z.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),z.copy(e))},viewport:function(e){!1===k.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),k.copy(e))},reset:function(){for(var e=0;e<v.length;e++)1===v[e]&&(t.disableVertexAttribArray(e),v[e]=0);_={},F=b=null,B={},C=R=x=null,d.reset(),p.reset(),f.reset()}}}function Qt(t,e,n){function r(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var i,o=void 0!==n.precision?n.precision:"highp",a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a),n=!0===n.logarithmicDepthBuffer&&!!e.get("EXT_frag_depth");var a=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),s=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),l=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),u=t.getParameter(t.MAX_VERTEX_ATTRIBS),h=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),d=t.getParameter(t.MAX_VARYING_VECTORS),p=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),f=0<s,m=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==i)return i;var n=e.get("EXT_texture_filter_anisotropic");return i=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:n,maxTextures:a,maxVertexTextures:s,maxTextureSize:c,maxCubemapSize:l,maxAttributes:u,maxVertexUniforms:h,maxVaryings:d,maxFragmentUniforms:p,vertexTextures:f,floatFragmentTextures:m,floatVertexTextures:f&&m}}function Kt(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=t.getExtension("WEBGL_compressed_texture_etc1");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r}}}function te(){function t(){l.value!==r&&(l.value=r,l.needsUpdate=0<i),n.numPlanes=i,n.numIntersection=0}function e(t,e,r,i){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=l.value,!0!==i||null===a)for(i=r+4*o,e=e.matrixWorldInverse,c.getNormalMatrix(e),(null===a||a.length<i)&&(a=new Float32Array(i)),i=0;i!==o;++i,r+=4)s.copy(t[i]).applyMatrix4(e,c),s.normal.toArray(a,r),a[r+3]=s.constant;l.value=a,l.needsUpdate=!0}return n.numPlanes=o,a}var n=this,r=null,i=0,o=!1,a=!1,s=new tt,c=new K,l={value:null,needsUpdate:!1};this.uniform=l,this.numIntersection=this.numPlanes=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==i||o;return o=n,r=e(t,a,0),i=t.length,s},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(n,s,c,u,h,d){if(!o||null===n||0===n.length||a&&!c)a?e(null):t();else{c=a?0:i;var p=4*c,f=h.clippingState||null;for(l.value=f,f=e(n,u,p,d),n=0;n!==p;++n)f[n]=r[n];h.clippingState=f,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=c}}}function ee(t){function e(){Dt.init(),Dt.scissor(Z.copy(ct).multiplyScalar(st)),Dt.viewport(K.copy(ht).multiplyScalar(st)),Dt.buffers.color.setClear(rt.r,rt.g,rt.b,it,A)}function n(){q=B=null,V="",G=-1,Dt.reset()}function r(t){t.preventDefault(),n(),e(),Ut.clear()}function o(t){t=t.target,t.removeEventListener("dispose",o),a(t),Ut.delete(t)}function a(t){var e=Ut.get(t).program;t.program=void 0,void 0!==e&&zt.releaseProgram(e)}function s(t,e){return Math.abs(e[0])-Math.abs(t[0])}function u(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.program&&e.material.program&&t.material.program!==e.material.program?t.material.program.id-e.material.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function h(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function d(t,e,n,r,i){var o;n.transparent?(r=O,o=++N):(r=C,o=++P),o=r[o],void 0!==o?(o.id=t.id,o.object=t,o.geometry=e,o.material=n,o.z=yt.z,o.group=i):(o={id:t.id,object:t,geometry:e,material:n,z:yt.z,group:i},r.push(o))}function p(t){if(!dt.intersectsSphere(t))return!1;var e=pt.numPlanes;if(0===e)return!0;var n=F.clippingPlanes,r=t.center;t=-t.radius;var i=0;do if(n[i].distanceToPoint(r)<t)return!1;while(++i!==e);return!0}function f(t,e){if(!1!==t.visible){if(0!==(t.layers.mask&e.layers.mask))if(t.isLight)R.push(t);else if(t.isSprite){var n;(n=!1===t.frustumCulled)||(gt.center.set(0,0,0),gt.radius=.7071067811865476,gt.applyMatrix4(t.matrixWorld),n=!0===p(gt)),n&&D.push(t)}else if(t.isLensFlare)U.push(t);else if(t.isImmediateRenderObject)!0===F.sortObjects&&(yt.setFromMatrixPosition(t.matrixWorld),yt.applyProjection(vt)),d(t,null,t.material,yt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),(n=!1===t.frustumCulled)||(n=t.geometry,null===n.boundingSphere&&n.computeBoundingSphere(),gt.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),n=!0===p(gt)),n)){var r=t.material;if(!0===r.visible)if(!0===F.sortObjects&&(yt.setFromMatrixPosition(t.matrixWorld),yt.applyProjection(vt)),n=Bt.update(t),r.isMultiMaterial)for(var i=n.groups,o=r.materials,r=0,a=i.length;r<a;r++){var s=i[r],c=o[s.materialIndex];!0===c.visible&&d(t,n,c,yt.z,s)}else d(t,n,r,yt.z,null)}for(n=t.children,r=0,a=n.length;r<a;r++)f(n[r],e)}}function m(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,c=a.geometry,l=void 0===r?a.material:r,a=a.group;if(s.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s.onBeforeRender(F,e,n,c,l,a),s.isImmediateRenderObject){g(l);var u=v(n,e.fog,l,s);V="",s.render(function(t){F.renderBufferImmediate(t,u,l)})}else F.renderBufferDirect(n,e.fog,c,l,s,a);s.onAfterRender(F,e,n,c,l,a)}}function g(t){2===t.side?Dt.disable(At.CULL_FACE):Dt.enable(At.CULL_FACE),Dt.setFlipSided(1===t.side),!0===t.transparent?Dt.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):Dt.setBlending(0),Dt.setDepthFunc(t.depthFunc),Dt.setDepthTest(t.depthTest),Dt.setDepthWrite(t.depthWrite),Dt.setColorWrite(t.colorWrite),Dt.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function v(t,e,n,r){tt=0;var i=Ut.get(n);if(ft&&(mt||t!==q)&&pt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,t===q&&n.id===G),!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==xt.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===pt.numPlanes&&i.numIntersection===pt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate){t:{var s=Ut.get(n),c=zt.getParameters(n,xt,e,pt.numPlanes,pt.numIntersection,r),l=zt.getProgramCode(n,c),u=s.program,h=!0;if(void 0===u)n.addEventListener("dispose",o);else if(u.code!==l)a(n);else{if(void 0!==c.shaderID)break t;h=!1}if(h&&(c.shaderID?(u=fi[c.shaderID],s.__webglShader={name:n.type,uniforms:ui.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}):s.__webglShader={name:n.type,uniforms:n.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader},n.__webglShader=s.__webglShader,u=zt.acquireProgram(n,c,l),s.program=u,n.program=u),c=u.getAttributes(),n.morphTargets)for(l=n.numSupportedMorphTargets=0;l<F.maxMorphTargets;l++)0<=c["morphTarget"+l]&&n.numSupportedMorphTargets++;if(n.morphNormals)for(l=n.numSupportedMorphNormals=0;l<F.maxMorphNormals;l++)0<=c["morphNormal"+l]&&n.numSupportedMorphNormals++;c=s.__webglShader.uniforms,(n.isShaderMaterial||n.isRawShaderMaterial)&&!0!==n.clipping||(s.numClippingPlanes=pt.numPlanes,s.numIntersection=pt.numIntersection,c.clippingPlanes=pt.uniform),s.fog=e,s.lightsHash=xt.hash,n.lights&&(c.ambientLightColor.value=xt.ambient,c.directionalLights.value=xt.directional,c.spotLights.value=xt.spot,c.rectAreaLights.value=xt.rectArea,c.pointLights.value=xt.point,c.hemisphereLights.value=xt.hemi,c.directionalShadowMap.value=xt.directionalShadowMap,c.directionalShadowMatrix.value=xt.directionalShadowMatrix,c.spotShadowMap.value=xt.spotShadowMap,c.spotShadowMatrix.value=xt.spotShadowMatrix,c.pointShadowMap.value=xt.pointShadowMap,c.pointShadowMatrix.value=xt.pointShadowMatrix),l=s.program.getUniforms(),c=j.seqWithValue(l.seq,c),s.uniformsList=c}n.needsUpdate=!1}var d=!1,h=u=!1,s=i.program,c=s.getUniforms(),l=i.__webglShader.uniforms;if(s.id!==B&&(At.useProgram(s.program),B=s.id,h=u=d=!0),n.id!==G&&(G=n.id,u=!0),(d||t!==q)&&(c.set(At,t,"projectionMatrix"),It.logarithmicDepthBuffer&&c.setValue(At,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),t!==q&&(q=t,h=u=!0),(n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap)&&(d=c.map.cameraPosition,void 0!==d&&d.setValue(At,yt.setFromMatrixPosition(t.matrixWorld))),(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&c.setValue(At,"viewMatrix",t.matrixWorldInverse),c.set(At,F,"toneMappingExposure"),c.set(At,F,"toneMappingWhitePoint")),n.skinning&&(c.setOptional(At,r,"bindMatrix"),c.setOptional(At,r,"bindMatrixInverse"),t=r.skeleton)&&(It.floatVertexTextures&&t.useVertexTexture?(c.set(At,t,"boneTexture"),c.set(At,t,"boneTextureWidth"),c.set(At,t,"boneTextureHeight")):c.setOptional(At,t,"boneMatrices")),u){if(n.lights&&(t=h,l.ambientLightColor.needsUpdate=t,l.directionalLights.needsUpdate=t,l.pointLights.needsUpdate=t,l.spotLights.needsUpdate=t,l.rectAreaLights.needsUpdate=t,l.hemisphereLights.needsUpdate=t),e&&n.fog&&(l.fogColor.value=e.color,e.isFog?(l.fogNear.value=e.near,l.fogFar.value=e.far):e.isFogExp2&&(l.fogDensity.value=e.density)),n.isMeshBasicMaterial||n.isMeshLambertMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.isMeshNormalMaterial||n.isMeshDepthMaterial){l.opacity.value=n.opacity,l.diffuse.value=n.color,n.emissive&&l.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),l.map.value=n.map,l.specularMap.value=n.specularMap,l.alphaMap.value=n.alphaMap,n.lightMap&&(l.lightMap.value=n.lightMap,l.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(l.aoMap.value=n.aoMap,l.aoMapIntensity.value=n.aoMapIntensity);var p;n.map?p=n.map:n.specularMap?p=n.specularMap:n.displacementMap?p=n.displacementMap:n.normalMap?p=n.normalMap:n.bumpMap?p=n.bumpMap:n.roughnessMap?p=n.roughnessMap:n.metalnessMap?p=n.metalnessMap:n.alphaMap?p=n.alphaMap:n.emissiveMap&&(p=n.emissiveMap),void 0!==p&&(p.isWebGLRenderTarget&&(p=p.texture),e=p.offset,p=p.repeat,l.offsetRepeat.value.set(e.x,e.y,p.x,p.y)),l.envMap.value=n.envMap,l.flipEnvMap.value=n.envMap&&n.envMap.isCubeTexture?-1:1,l.reflectivity.value=n.reflectivity,l.refractionRatio.value=n.refractionRatio}n.isLineBasicMaterial?(l.diffuse.value=n.color,l.opacity.value=n.opacity):n.isLineDashedMaterial?(l.diffuse.value=n.color,l.opacity.value=n.opacity,l.dashSize.value=n.dashSize,l.totalSize.value=n.dashSize+n.gapSize,l.scale.value=n.scale):n.isPointsMaterial?(l.diffuse.value=n.color,l.opacity.value=n.opacity,l.size.value=n.size*st,l.scale.value=.5*at,l.map.value=n.map,null!==n.map&&(p=n.map.offset,n=n.map.repeat,l.offsetRepeat.value.set(p.x,p.y,n.x,n.y))):n.isMeshLambertMaterial?n.emissiveMap&&(l.emissiveMap.value=n.emissiveMap):n.isMeshToonMaterial?(y(l,n),n.gradientMap&&(l.gradientMap.value=n.gradientMap)):n.isMeshPhongMaterial?y(l,n):n.isMeshPhysicalMaterial?(l.clearCoat.value=n.clearCoat,l.clearCoatRoughness.value=n.clearCoatRoughness,_(l,n)):n.isMeshStandardMaterial?_(l,n):n.isMeshDepthMaterial?n.displacementMap&&(l.displacementMap.value=n.displacementMap,l.displacementScale.value=n.displacementScale,l.displacementBias.value=n.displacementBias):n.isMeshNormalMaterial&&(n.bumpMap&&(l.bumpMap.value=n.bumpMap,l.bumpScale.value=n.bumpScale),n.normalMap&&(l.normalMap.value=n.normalMap,l.normalScale.value.copy(n.normalScale)),n.displacementMap&&(l.displacementMap.value=n.displacementMap,l.displacementScale.value=n.displacementScale,l.displacementBias.value=n.displacementBias)),void 0!==l.ltcMat&&(l.ltcMat.value=THREE.UniformsLib.LTC_MAT_TEXTURE),void 0!==l.ltcMag&&(l.ltcMag.value=THREE.UniformsLib.LTC_MAG_TEXTURE),j.upload(At,i.uniformsList,l,F)}return c.set(At,r,"modelViewMatrix"),c.set(At,r,"normalMatrix"),c.setValue(At,"modelMatrix",r.matrixWorld),s}function y(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function _(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function b(t){var e;if(1e3===t)return At.REPEAT;if(1001===t)return At.CLAMP_TO_EDGE;if(1002===t)return At.MIRRORED_REPEAT;if(1003===t)return At.NEAREST;if(1004===t)return At.NEAREST_MIPMAP_NEAREST;if(1005===t)return At.NEAREST_MIPMAP_LINEAR;if(1006===t)return At.LINEAR;if(1007===t)return At.LINEAR_MIPMAP_NEAREST;if(1008===t)return At.LINEAR_MIPMAP_LINEAR;if(1009===t)return At.UNSIGNED_BYTE;if(1017===t)return At.UNSIGNED_SHORT_4_4_4_4;if(1018===t)return At.UNSIGNED_SHORT_5_5_5_1;if(1019===t)return At.UNSIGNED_SHORT_5_6_5;if(1010===t)return At.BYTE;if(1011===t)return At.SHORT;if(1012===t)return At.UNSIGNED_SHORT;if(1013===t)return At.INT;if(1014===t)return At.UNSIGNED_INT;if(1015===t)return At.FLOAT;if(1016===t&&(e=Nt.get("OES_texture_half_float"),null!==e))return e.HALF_FLOAT_OES;if(1021===t)return At.ALPHA;if(1022===t)return At.RGB;if(1023===t)return At.RGBA;if(1024===t)return At.LUMINANCE;if(1025===t)return At.LUMINANCE_ALPHA;if(1026===t)return At.DEPTH_COMPONENT;if(1027===t)return At.DEPTH_STENCIL;if(100===t)return At.FUNC_ADD;if(101===t)return At.FUNC_SUBTRACT;if(102===t)return At.FUNC_REVERSE_SUBTRACT;if(200===t)return At.ZERO;if(201===t)return At.ONE;if(202===t)return At.SRC_COLOR;if(203===t)return At.ONE_MINUS_SRC_COLOR;if(204===t)return At.SRC_ALPHA;if(205===t)return At.ONE_MINUS_SRC_ALPHA;if(206===t)return At.DST_ALPHA;if(207===t)return At.ONE_MINUS_DST_ALPHA;if(208===t)return At.DST_COLOR;if(209===t)return At.ONE_MINUS_DST_COLOR;if(210===t)return At.SRC_ALPHA_SATURATE;if((2001===t||2002===t||2003===t||2004===t)&&(e=Nt.get("WEBGL_compressed_texture_s3tc"),null!==e)){if(2001===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((2100===t||2101===t||2102===t||2103===t)&&(e=Nt.get("WEBGL_compressed_texture_pvrtc"),null!==e)){if(2100===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(2151===t&&(e=Nt.get("WEBGL_compressed_texture_etc1"),null!==e))return e.COMPRESSED_RGB_ETC1_WEBGL;if((103===t||104===t)&&(e=Nt.get("EXT_blend_minmax"),null!==e)){if(103===t)return e.MIN_EXT;if(104===t)return e.MAX_EXT}return 1020===t&&(e=Nt.get("WEBGL_depth_texture"),null!==e)?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer","83"),t=t||{};var x=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),w=void 0!==t.context?t.context:null,E=void 0!==t.alpha&&t.alpha,M=void 0===t.depth||t.depth,T=void 0===t.stencil||t.stencil,S=void 0!==t.antialias&&t.antialias,A=void 0===t.premultipliedAlpha||t.premultipliedAlpha,L=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,R=[],C=[],P=-1,O=[],N=-1,I=new Float32Array(8),D=[],U=[];this.domElement=x,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var F=this,B=null,z=null,k=null,G=-1,V="",q=null,Z=new i,J=null,K=new i,tt=0,rt=new H(0),it=0,ot=x.width,at=x.height,st=1,ct=new i(0,0,ot,at),lt=!1,ht=new i(0,0,ot,at),dt=new et,pt=new te,ft=!1,mt=!1,gt=new Q,vt=new l,yt=new c,_t=new l,bt=new l,xt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},wt={calls:0,vertices:0,faces:0,points:0};this.info={render:wt,memory:{geometries:0,textures:0},programs:null};var At;try{if(E={alpha:E,depth:M,stencil:T,antialias:S,premultipliedAlpha:A,preserveDrawingBuffer:L},At=w||x.getContext("webgl",E)||x.getContext("experimental-webgl",E),null===At){if(null!==x.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}void 0===At.getShaderPrecisionFormat&&(At.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),x.addEventListener("webglcontextlost",r,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var Nt=new Kt(At);Nt.get("WEBGL_depth_texture"),Nt.get("OES_texture_float"),Nt.get("OES_texture_float_linear"),Nt.get("OES_texture_half_float"),Nt.get("OES_texture_half_float_linear"),Nt.get("OES_standard_derivatives"),Nt.get("ANGLE_instanced_arrays"),Nt.get("OES_element_index_uint")&&(Et.MaxIndex=4294967296);var It=new Qt(At,Nt,t),Dt=new $t(At,Nt,b),Ut=new Jt,Ft=new Zt(At,Nt,Dt,Ut,It,b,this.info),Bt=new Yt(At,Ut,this.info),zt=new Xt(this,It),kt=new Ot;this.info.programs=zt.programs;var jt=new Pt(At,Nt,wt),Ht=new Ct(At,Nt,wt),Gt=new Rt(-1,1,1,-1,0,1),Vt=new Lt,Wt=new Mt(new St(2,2),new ut({depthTest:!1,depthWrite:!1,fog:!1}));t=fi.cube;var qt=new Mt(new Tt(5,5,5),new Y({uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}));e(),this.context=At,this.capabilities=It,this.extensions=Nt,this.properties=Ut,this.state=Dt;var ee=new nt(this,xt,Bt,It);this.shadowMap=ee;var ne=new X(this,D),re=new W(this,U);this.getContext=function(){return At},this.getContextAttributes=function(){return At.getContextAttributes()},this.forceContextLoss=function(){Nt.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return It.getMaxAnisotropy()},this.getPrecision=function(){return It.precision},this.getPixelRatio=function(){return st},this.setPixelRatio=function(t){void 0!==t&&(st=t,this.setSize(ht.z,ht.w,!1))},this.getSize=function(){return{width:ot,height:at}},this.setSize=function(t,e,n){ot=t,at=e,x.width=t*st,x.height=e*st,!1!==n&&(x.style.width=t+"px",x.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,r){Dt.viewport(ht.set(t,e,n,r))},this.setScissor=function(t,e,n,r){Dt.scissor(ct.set(t,e,n,r))},this.setScissorTest=function(t){Dt.setScissorTest(lt=t)},this.getClearColor=function(){return rt},this.setClearColor=function(t,e){rt.set(t),it=void 0!==e?e:1,Dt.buffers.color.setClear(rt.r,rt.g,rt.b,it,A)},this.getClearAlpha=function(){return it},this.setClearAlpha=function(t){it=t,Dt.buffers.color.setClear(rt.r,rt.g,rt.b,it,A)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=At.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=At.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=At.STENCIL_BUFFER_BIT),At.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.resetGLState=n,this.dispose=function(){O=[],N=-1,C=[],P=-1,x.removeEventListener("webglcontextlost",r,!1)},this.renderBufferImmediate=function(t,e,n){Dt.initAttributes();var r=Ut.get(t);if(t.hasPositions&&!r.position&&(r.position=At.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=At.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=At.createBuffer()),t.hasColors&&!r.color&&(r.color=At.createBuffer()),e=e.getAttributes(),t.hasPositions&&(At.bindBuffer(At.ARRAY_BUFFER,r.position),At.bufferData(At.ARRAY_BUFFER,t.positionArray,At.DYNAMIC_DRAW),Dt.enableAttribute(e.position),At.vertexAttribPointer(e.position,3,At.FLOAT,!1,0,0)),t.hasNormals){if(At.bindBuffer(At.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&1===n.shading)for(var i=0,o=3*t.count;i<o;i+=9){var a=t.normalArray,s=(a[i+0]+a[i+3]+a[i+6])/3,c=(a[i+1]+a[i+4]+a[i+7])/3,l=(a[i+2]+a[i+5]+a[i+8])/3;a[i+0]=s,a[i+1]=c,a[i+2]=l,a[i+3]=s,a[i+4]=c,a[i+5]=l,a[i+6]=s,a[i+7]=c,a[i+8]=l}At.bufferData(At.ARRAY_BUFFER,t.normalArray,At.DYNAMIC_DRAW),Dt.enableAttribute(e.normal),At.vertexAttribPointer(e.normal,3,At.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(At.bindBuffer(At.ARRAY_BUFFER,r.uv),At.bufferData(At.ARRAY_BUFFER,t.uvArray,At.DYNAMIC_DRAW),Dt.enableAttribute(e.uv),At.vertexAttribPointer(e.uv,2,At.FLOAT,!1,0,0)),t.hasColors&&0!==n.vertexColors&&(At.bindBuffer(At.ARRAY_BUFFER,r.color),At.bufferData(At.ARRAY_BUFFER,t.colorArray,At.DYNAMIC_DRAW),Dt.enableAttribute(e.color),At.vertexAttribPointer(e.color,3,At.FLOAT,!1,0,0)),Dt.disableUnusedAttributes(),At.drawArrays(At.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){g(r);var a=v(t,e,r,i),c=!1;if(t=n.id+"_"+a.id+"_"+r.wireframe,t!==V&&(V=t,c=!0),e=i.morphTargetInfluences,void 0!==e){var l=[];t=0;for(var u=e.length;t<u;t++)c=e[t],l.push([c,t]);l.sort(s),8<l.length&&(l.length=8);var h=n.morphAttributes;for(t=0,u=l.length;t<u;t++)c=l[t],I[t]=c[0],0!==c[0]?(e=c[1],!0===r.morphTargets&&h.position&&n.addAttribute("morphTarget"+t,h.position[e]),!0===r.morphNormals&&h.normal&&n.addAttribute("morphNormal"+t,h.normal[e])):(!0===r.morphTargets&&n.removeAttribute("morphTarget"+t),!0===r.morphNormals&&n.removeAttribute("morphNormal"+t));for(t=l.length,e=I.length;t<e;t++)I[t]=0;a.getUniforms().setValue(At,"morphTargetInfluences",I),c=!0}if(e=n.index,u=n.attributes.position,l=1,!0===r.wireframe&&(e=Bt.getWireframeAttribute(n),l=2),null!==e?(t=Ht,t.setIndex(e)):t=jt,c){var c=void 0,d;if(n&&n.isInstancedBufferGeometry&&(d=Nt.get("ANGLE_instanced_arrays"),null===d))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===c&&(c=0),Dt.initAttributes();var h=n.attributes,a=a.getAttributes(),p=r.defaultAttributeValues,f;for(f in a){var m=a[f];if(0<=m){var y=h[f];if(void 0!==y){var _=y.normalized,b=y.itemSize,x=Bt.getAttributeProperties(y),w=x.__webglBuffer,E=x.type,x=x.bytesPerElement;if(y.isInterleavedBufferAttribute){var M=y.data,T=M.stride,y=y.offset;M&&M.isInstancedInterleavedBuffer?(Dt.enableAttributeAndDivisor(m,M.meshPerAttribute,d),void 0===n.maxInstancedCount&&(n.maxInstancedCount=M.meshPerAttribute*M.count)):Dt.enableAttribute(m),At.bindBuffer(At.ARRAY_BUFFER,w),At.vertexAttribPointer(m,b,E,_,T*x,(c*T+y)*x)}else y.isInstancedBufferAttribute?(Dt.enableAttributeAndDivisor(m,y.meshPerAttribute,d),void 0===n.maxInstancedCount&&(n.maxInstancedCount=y.meshPerAttribute*y.count)):Dt.enableAttribute(m),At.bindBuffer(At.ARRAY_BUFFER,w),At.vertexAttribPointer(m,b,E,_,0,c*b*x)}else if(void 0!==p&&(_=p[f],void 0!==_))switch(_.length){case 2:At.vertexAttrib2fv(m,_);break;case 3:At.vertexAttrib3fv(m,_);break;case 4:At.vertexAttrib4fv(m,_);break;default:At.vertexAttrib1fv(m,_)}}}Dt.disableUnusedAttributes()}null!==e&&At.bindBuffer(At.ELEMENT_ARRAY_BUFFER,Bt.getAttributeBuffer(e))}if(d=0,null!==e?d=e.count:void 0!==u&&(d=u.count),e=n.drawRange.start*l,u=null!==o?o.start*l:0,f=Math.max(e,u),o=Math.max(0,Math.min(d,e+n.drawRange.count*l,u+(null!==o?o.count*l:1/0))-1-f+1),0!==o){if(i.isMesh)if(!0===r.wireframe)Dt.setLineWidth(r.wireframeLinewidth*(null===z?st:1)),t.setMode(At.LINES);else switch(i.drawMode){case 0:t.setMode(At.TRIANGLES);break;case 1:t.setMode(At.TRIANGLE_STRIP);break;case 2:t.setMode(At.TRIANGLE_FAN)}else i.isLine?(r=r.linewidth,void 0===r&&(r=1),Dt.setLineWidth(r*(null===z?st:1)),i.isLineSegments?t.setMode(At.LINES):t.setMode(At.LINE_STRIP)):i.isPoints&&t.setMode(At.POINTS);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&t.renderInstances(n,f,o):t.render(f,o)}},this.render=function(t,e,n,r){if(void 0!==e&&!0!==e.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{V="",G=-1,q=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),vt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),dt.setFromMatrix(vt),R.length=0,N=P=-1,D.length=0,U.length=0,mt=this.localClippingEnabled,ft=pt.init(this.clippingPlanes,mt,e),f(t,e),C.length=P+1,O.length=N+1,!0===F.sortObjects&&(C.sort(u),O.sort(h)),ft&&pt.beginShadows();for(var i=R,o=0,a=0,s=i.length;a<s;a++){var c=i[a];c.castShadow&&(xt.shadows[o++]=c)}xt.shadows.length=o,ee.render(t,e);for(var i=R,d=c=0,p=0,g,v,y,_,b=e.matrixWorldInverse,x=0,w=0,E=0,M=0,T=0,o=0,a=i.length;o<a;o++)if(s=i[o],g=s.color,v=s.intensity,y=s.distance,_=s.shadow&&s.shadow.map?s.shadow.map.texture:null,s.isAmbientLight)c+=g.r*v,d+=g.g*v,p+=g.b*v;else if(s.isDirectionalLight){var S=kt.get(s);S.color.copy(s.color).multiplyScalar(s.intensity),S.direction.setFromMatrixPosition(s.matrixWorld),yt.setFromMatrixPosition(s.target.matrixWorld),S.direction.sub(yt),S.direction.transformDirection(b),(S.shadow=s.castShadow)&&(S.shadowBias=s.shadow.bias,S.shadowRadius=s.shadow.radius,S.shadowMapSize=s.shadow.mapSize),xt.directionalShadowMap[x]=_,xt.directionalShadowMatrix[x]=s.shadow.matrix,xt.directional[x++]=S}else s.isSpotLight?(S=kt.get(s),S.position.setFromMatrixPosition(s.matrixWorld),S.position.applyMatrix4(b),S.color.copy(g).multiplyScalar(v),S.distance=y,S.direction.setFromMatrixPosition(s.matrixWorld),yt.setFromMatrixPosition(s.target.matrixWorld),S.direction.sub(yt),S.direction.transformDirection(b),S.coneCos=Math.cos(s.angle),S.penumbraCos=Math.cos(s.angle*(1-s.penumbra)),S.decay=0===s.distance?0:s.decay,(S.shadow=s.castShadow)&&(S.shadowBias=s.shadow.bias,S.shadowRadius=s.shadow.radius,S.shadowMapSize=s.shadow.mapSize),xt.spotShadowMap[E]=_,xt.spotShadowMatrix[E]=s.shadow.matrix,xt.spot[E++]=S):s.isRectAreaLight?(S=kt.get(s),S.color.copy(g).multiplyScalar(v/(s.width*s.height)),S.position.setFromMatrixPosition(s.matrixWorld),S.position.applyMatrix4(b),bt.identity(),_t.copy(s.matrixWorld),_t.premultiply(b),bt.extractRotation(_t),S.halfWidth.set(.5*s.width,0,0),S.halfHeight.set(0,.5*s.height,0),S.halfWidth.applyMatrix4(bt),S.halfHeight.applyMatrix4(bt),xt.rectArea[M++]=S):s.isPointLight?(S=kt.get(s),S.position.setFromMatrixPosition(s.matrixWorld),S.position.applyMatrix4(b),S.color.copy(s.color).multiplyScalar(s.intensity),S.distance=s.distance,S.decay=0===s.distance?0:s.decay,(S.shadow=s.castShadow)&&(S.shadowBias=s.shadow.bias,S.shadowRadius=s.shadow.radius,S.shadowMapSize=s.shadow.mapSize),xt.pointShadowMap[w]=_,void 0===xt.pointShadowMatrix[w]&&(xt.pointShadowMatrix[w]=new l),yt.setFromMatrixPosition(s.matrixWorld).negate(),xt.pointShadowMatrix[w].identity().setPosition(yt),xt.point[w++]=S):s.isHemisphereLight&&(S=kt.get(s),S.direction.setFromMatrixPosition(s.matrixWorld),S.direction.transformDirection(b),S.direction.normalize(),S.skyColor.copy(s.color).multiplyScalar(v),S.groundColor.copy(s.groundColor).multiplyScalar(v),xt.hemi[T++]=S);xt.ambient[0]=c,xt.ambient[1]=d,xt.ambient[2]=p,xt.directional.length=x,xt.spot.length=E,xt.rectArea.length=M,xt.point.length=w,xt.hemi.length=T,xt.hash=x+","+w+","+E+","+M+","+T+","+xt.shadows.length,ft&&pt.endShadows(),wt.calls=0,wt.vertices=0,wt.faces=0,wt.points=0,void 0===n&&(n=null),this.setRenderTarget(n),i=t.background,null===i?Dt.buffers.color.setClear(rt.r,rt.g,rt.b,it,A):i&&i.isColor&&(Dt.buffers.color.setClear(i.r,i.g,i.b,1,A),r=!0),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),i&&i.isCubeTexture?(Vt.projectionMatrix.copy(e.projectionMatrix),Vt.matrixWorld.extractRotation(e.matrixWorld),Vt.matrixWorldInverse.getInverse(Vt.matrixWorld),qt.material.uniforms.tCube.value=i,qt.modelViewMatrix.multiplyMatrices(Vt.matrixWorldInverse,qt.matrixWorld),Bt.update(qt),F.renderBufferDirect(Vt,null,qt.geometry,qt.material,qt,null)):i&&i.isTexture&&(Wt.material.map=i,Bt.update(Wt),F.renderBufferDirect(Gt,null,Wt.geometry,Wt.material,Wt,null)),t.overrideMaterial?(r=t.overrideMaterial,m(C,t,e,r),m(O,t,e,r)):(Dt.setBlending(0),m(C,t,e),m(O,t,e)),ne.render(t,e),re.render(t,e,K),n&&Ft.updateRenderTargetMipmap(n),Dt.setDepthTest(!0),Dt.setDepthWrite(!0),Dt.setColorWrite(!0)}},this.setFaceCulling=function(t,e){Dt.setCullFace(t),Dt.setFlipSided(0===e)},this.allocTextureUnit=function(){var t=tt;return t>=It.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+It.maxTextures),tt+=1,t},this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),Ft.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),Ft.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?Ft.setTextureCube(e,n):Ft.setTextureCubeDynamic(e,n)}}(),this.getCurrentRenderTarget=function(){return z},this.setRenderTarget=function(t){(z=t)&&void 0===Ut.get(t).__webglFramebuffer&&Ft.setupRenderTarget(t);var e=t&&t.isWebGLRenderTargetCube,n;t?(n=Ut.get(t),n=e?n.__webglFramebuffer[t.activeCubeFace]:n.__webglFramebuffer,Z.copy(t.scissor),J=t.scissorTest,K.copy(t.viewport)):(n=null,Z.copy(ct).multiplyScalar(st),J=lt,K.copy(ht).multiplyScalar(st)),k!==n&&(At.bindFramebuffer(At.FRAMEBUFFER,n),k=n),Dt.scissor(Z),Dt.setScissorTest(J),Dt.viewport(K),e&&(e=Ut.get(t.texture),At.framebufferTexture2D(At.FRAMEBUFFER,At.COLOR_ATTACHMENT0,At.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,e.__webglTexture,t.activeMipMapLevel));
},this.readRenderTargetPixels=function(t,e,n,r,i,o){if(!1===(t&&t.isWebGLRenderTarget))console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var a=Ut.get(t).__webglFramebuffer;if(a){var s=!1;a!==k&&(At.bindFramebuffer(At.FRAMEBUFFER,a),s=!0);try{var c=t.texture,l=c.format,u=c.type;1023!==l&&b(l)!==At.getParameter(At.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===u||b(u)===At.getParameter(At.IMPLEMENTATION_COLOR_READ_TYPE)||1015===u&&(Nt.get("OES_texture_float")||Nt.get("WEBGL_color_buffer_float"))||1016===u&&Nt.get("EXT_color_buffer_half_float")?At.checkFramebufferStatus(At.FRAMEBUFFER)===At.FRAMEBUFFER_COMPLETE?0<=e&&e<=t.width-r&&0<=n&&n<=t.height-i&&At.readPixels(e,n,r,i,b(l),b(u),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&At.bindFramebuffer(At.FRAMEBUFFER,k)}}}}}function ne(t,e){this.name="",this.color=new H(t),this.density=void 0!==e?e:25e-5}function re(t,e,n){this.name="",this.color=new H(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function ie(){at.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function oe(t,e,n,r,i){at.call(this),this.lensFlares=[],this.positionScreen=new c,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,r,i)}function ae(t){q.call(this),this.type="SpriteMaterial",this.color=new H(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(t)}function se(t){at.call(this),this.type="Sprite",this.material=void 0!==t?t:new ae}function ce(){at.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function le(t,e,n){if(this.useVertexTexture=void 0===n||n,this.identityMatrix=new l,t=t||[],this.bones=t.slice(0),this.useVertexTexture?(t=Math.sqrt(4*this.bones.length),t=ri.nextPowerOfTwo(Math.ceil(t)),this.boneTextureHeight=this.boneTextureWidth=t=Math.max(t,4),this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new G(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,1023,1015)):this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new l)}function ue(){at.call(this),this.type="Bone"}function he(t,e,n){if(Mt.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new l,this.bindMatrixInverse=new l,t=[],this.geometry&&void 0!==this.geometry.bones){for(var r,i=0,o=this.geometry.bones.length;i<o;++i)r=this.geometry.bones[i],e=new ue,t.push(e),e.name=r.name,e.position.fromArray(r.pos),e.quaternion.fromArray(r.rotq),void 0!==r.scl&&e.scale.fromArray(r.scl);for(i=0,o=this.geometry.bones.length;i<o;++i)r=this.geometry.bones[i],-1!==r.parent&&null!==r.parent&&void 0!==t[r.parent]?t[r.parent].add(t[i]):this.add(t[i])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new le(t,void 0,n),this.matrixWorld)}function de(t){q.call(this),this.type="LineBasicMaterial",this.color=new H(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(t)}function pe(t,e,n){return 1===n?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new fe(t,e)):(at.call(this),this.type="Line",this.geometry=void 0!==t?t:new Et,void(this.material=void 0!==e?e:new de({color:16777215*Math.random()})))}function fe(t,e){pe.call(this,t,e),this.type="LineSegments"}function me(t){q.call(this),this.type="PointsMaterial",this.color=new H(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function ge(t,e){at.call(this),this.type="Points",this.geometry=void 0!==t?t:new Et,this.material=void 0!==e?e:new me({color:16777215*Math.random()})}function ve(){at.call(this),this.type="Group"}function ye(t,e,n,i,o,a,s,c,l){function u(){requestAnimationFrame(u),t.readyState>=t.HAVE_CURRENT_DATA&&(h.needsUpdate=!0)}r.call(this,t,e,n,i,o,a,s,c,l),this.generateMipmaps=!1;var h=this;u()}function _e(t,e,n,i,o,a,s,c,l,u,h,d){r.call(this,null,a,s,c,l,u,i,o,h,d),this.image={width:e,height:n},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function be(t,e,n,i,o,a,s,c,l){r.call(this,t,e,n,i,o,a,s,c,l),this.needsUpdate=!0}function xe(t,e,n,i,o,a,s,c,l,u){if(u=void 0!==u?u:1026,1026!==u&&1027!==u)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===u&&(n=1012),void 0===n&&1027===u&&(n=1020),r.call(this,null,i,o,a,s,c,u,n,l),this.image={width:t,height:e},this.magFilter=void 0!==s?s:1003,this.minFilter=void 0!==c?c:1003,this.generateMipmaps=this.flipY=!1}function we(t){function e(t,e){return t-e}Et.call(this);var n=[0,0],r={},i=["a","b","c"];if(t&&t.isGeometry){var o=t.vertices,a=t.faces,s=0,c=new Uint32Array(6*a.length);t=0;for(var l=a.length;t<l;t++)for(var u=a[t],h=0;3>h;h++){n[0]=u[i[h]],n[1]=u[i[(h+1)%3]],n.sort(e);var d=n.toString();void 0===r[d]&&(c[2*s]=n[0],c[2*s+1]=n[1],r[d]=!0,s++)}for(n=new Float32Array(6*s),t=0,l=s;t<l;t++)for(h=0;2>h;h++)r=o[c[2*t+h]],s=6*t+3*h,n[s+0]=r.x,n[s+1]=r.y,n[s+2]=r.z;this.addAttribute("position",new ht(n,3))}else if(t&&t.isBufferGeometry){if(null!==t.index){for(l=t.index.array,o=t.attributes.position,i=t.groups,s=0,0===i.length&&t.addGroup(0,l.length),c=new Uint32Array(2*l.length),a=0,u=i.length;a<u;++a){t=i[a],h=t.start,d=t.count,t=h;for(var p=h+d;t<p;t+=3)for(h=0;3>h;h++)n[0]=l[t+h],n[1]=l[t+(h+1)%3],n.sort(e),d=n.toString(),void 0===r[d]&&(c[2*s]=n[0],c[2*s+1]=n[1],r[d]=!0,s++)}for(n=new Float32Array(6*s),t=0,l=s;t<l;t++)for(h=0;2>h;h++)s=6*t+3*h,r=c[2*t+h],n[s+0]=o.getX(r),n[s+1]=o.getY(r),n[s+2]=o.getZ(r)}else for(o=t.attributes.position.array,s=o.length/3,c=s/3,n=new Float32Array(6*s),t=0,l=c;t<l;t++)for(h=0;3>h;h++)s=18*t+6*h,c=9*t+3*h,n[s+0]=o[c],n[s+1]=o[c+1],n[s+2]=o[c+2],r=9*t+(h+1)%3*3,n[s+3]=o[r],n[s+4]=o[r+1],n[s+5]=o[r+2];this.addAttribute("position",new ht(n,3))}}function Ee(t,e,n){Et.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r=[],i=[],o,a,s,c,l,u=e+1;for(o=0;o<=n;o++)for(l=o/n,a=0;a<=e;a++)c=a/e,s=t(c,l),r.push(s.x,s.y,s.z),i.push(c,l);t=[];var h;for(o=0;o<n;o++)for(a=0;a<e;a++)s=o*u+a,c=o*u+a+1,l=(o+1)*u+a+1,h=(o+1)*u+a,t.push(s,c,h),t.push(c,l,h);this.setIndex(new(65535<t.length?yt:gt)(t,1)),this.addAttribute("position",new _t(r,3)),this.addAttribute("uv",new _t(i,2)),this.computeVertexNormals()}function Me(t,e,n){wt.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Ee(t,e,n)),this.mergeVertices()}function Te(t,e,r,i){function o(t){l.push(t.x,t.y,t.z)}function a(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function s(t,e,n,r){0>r&&1===t.x&&(u[e]=t.x-1),0===n.x&&0===n.z&&(u[e]=r/2/Math.PI+.5)}Et.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:i},r=r||1;var l=[],u=[];!function(t){for(var n=new c,r=new c,i=new c,s=0;s<e.length;s+=3){a(e[s+0],n),a(e[s+1],r),a(e[s+2],i);var l=n,u=r,h=i,d=Math.pow(2,t),p=[],f,m;for(f=0;f<=d;f++){p[f]=[];var g=l.clone().lerp(h,f/d),v=u.clone().lerp(h,f/d),y=d-f;for(m=0;m<=y;m++)p[f][m]=0===m&&f===d?g:g.clone().lerp(v,m/y)}for(f=0;f<d;f++)for(m=0;m<2*(d-f)-1;m++)l=Math.floor(m/2),0===m%2?(o(p[f][l+1]),o(p[f+1][l]),o(p[f][l])):(o(p[f][l+1]),o(p[f+1][l+1]),o(p[f+1][l]))}}(i||0),function(t){for(var e=new c,n=0;n<l.length;n+=3)e.x=l[n+0],e.y=l[n+1],e.z=l[n+2],e.normalize().multiplyScalar(t),l[n+0]=e.x,l[n+1]=e.y,l[n+2]=e.z}(r),function(){for(var t=new c,e=0;e<l.length;e+=3)t.x=l[e+0],t.y=l[e+1],t.z=l[e+2],u.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));for(var t=new c,e=new c,r=new c,i=new c,o=new n,a=new n,h=new n,d=0,p=0;d<l.length;d+=9,p+=6){t.set(l[d+0],l[d+1],l[d+2]),e.set(l[d+3],l[d+4],l[d+5]),r.set(l[d+6],l[d+7],l[d+8]),o.set(u[p+0],u[p+1]),a.set(u[p+2],u[p+3]),h.set(u[p+4],u[p+5]),i.copy(t).add(e).add(r).divideScalar(3);var f=Math.atan2(i.z,-i.x);s(o,p+0,t,f),s(a,p+2,e,f),s(h,p+4,r,f)}for(t=0;t<u.length;t+=6)e=u[t+0],r=u[t+2],i=u[t+4],o=Math.min(e,r,i),.9<Math.max(e,r,i)&&.1>o&&(.2>e&&(u[t+0]+=1),.2>r&&(u[t+2]+=1),.2>i&&(u[t+4]+=1))}(),this.addAttribute("position",new _t(l,3)),this.addAttribute("normal",new _t(l.slice(),3)),this.addAttribute("uv",new _t(u,2)),this.normalizeNormals(),this.boundingSphere=new Q(new c,r)}function Se(t,e){Te.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ae(t,e){wt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Se(t,e)),this.mergeVertices()}function Le(t,e){Te.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Re(t,e){wt.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Le(t,e)),this.mergeVertices()}function Ce(t,e){var n=(1+Math.sqrt(5))/2;Te.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Pe(t,e){wt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ce(t,e)),this.mergeVertices()}function Oe(t,e){var n=(1+Math.sqrt(5))/2,r=1/n;Te.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ne(t,e){wt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Oe(t,e)),this.mergeVertices()}function Ie(t,e,n,r){wt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Te(t,e,n,r)),this.mergeVertices()}function De(t,e,r,i,o){function a(n){var o=t.getPointAt(n/e),a=s.normals[n];for(n=s.binormals[n],p=0;p<=i;p++){var c=p/i*Math.PI*2,h=Math.sin(c),c=-Math.cos(c);u.x=c*a.x+h*n.x,u.y=c*a.y+h*n.y,u.z=c*a.z+h*n.z,u.normalize(),m.push(u.x,u.y,u.z),l.x=o.x+r*u.x,l.y=o.y+r*u.y,l.z=o.z+r*u.z,f.push(l.x,l.y,l.z)}}Et.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:i,closed:o},e=e||64,r=r||1,i=i||8,o=o||!1;var s=t.computeFrenetFrames(e,o);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;var l=new c,u=new c,h=new n,d,p,f=[],m=[],g=[],v=[];for(d=0;d<e;d++)a(d);for(a(!1===o?e:0),d=0;d<=e;d++)for(p=0;p<=i;p++)h.x=d/e,h.y=p/i,g.push(h.x,h.y);!function(){for(p=1;p<=e;p++)for(d=1;d<=i;d++){var t=(i+1)*p+(d-1),n=(i+1)*p+d,r=(i+1)*(p-1)+d;v.push((i+1)*(p-1)+(d-1),t,r),v.push(t,n,r)}}(),this.setIndex(new(65535<v.length?yt:gt)(v,1)),this.addAttribute("position",new _t(f,3)),this.addAttribute("normal",new _t(m,3)),this.addAttribute("uv",new _t(g,2))}function Ue(t,e,n,r,i,o){wt.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new De(t,e,n,r,i),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Fe(t,e,r,i,o,a){function s(t,e,n,r,i){var o=Math.sin(t);e=n/e*t,n=Math.cos(e),i.x=r*(2+n)*.5*Math.cos(t),i.y=r*(2+n)*o*.5,i.z=r*Math.sin(e)*.5}Et.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:i,p:o,q:a},t=t||100,e=e||40,r=Math.floor(r)||64,i=Math.floor(i)||8,o=o||2,a=a||3;var l=(i+1)*(r+1),u=i*r*6,u=new ht(new(65535<u?Uint32Array:Uint16Array)(u),1),h=new ht(new Float32Array(3*l),3),d=new ht(new Float32Array(3*l),3),l=new ht(new Float32Array(2*l),2),p,f,m=0,g=0,v=new c,y=new c,_=new n,b=new c,x=new c,w=new c,E=new c,M=new c;for(p=0;p<=r;++p)for(f=p/r*o*Math.PI*2,s(f,o,a,t,b),s(f+.01,o,a,t,x),E.subVectors(x,b),M.addVectors(x,b),w.crossVectors(E,M),M.crossVectors(w,E),w.normalize(),M.normalize(),f=0;f<=i;++f){var T=f/i*Math.PI*2,S=-e*Math.cos(T),T=e*Math.sin(T);v.x=b.x+(S*M.x+T*w.x),v.y=b.y+(S*M.y+T*w.y),v.z=b.z+(S*M.z+T*w.z),h.setXYZ(m,v.x,v.y,v.z),y.subVectors(v,b).normalize(),d.setXYZ(m,y.x,y.y,y.z),_.x=p/r,_.y=f/i,l.setXY(m,_.x,_.y),m++}for(f=1;f<=r;f++)for(p=1;p<=i;p++)t=(i+1)*f+(p-1),e=(i+1)*f+p,o=(i+1)*(f-1)+p,u.setX(g,(i+1)*(f-1)+(p-1)),g++,u.setX(g,t),g++,u.setX(g,o),g++,u.setX(g,t),g++,u.setX(g,e),g++,u.setX(g,o),g++;this.setIndex(u),this.addAttribute("position",h),this.addAttribute("normal",d),this.addAttribute("uv",l)}function Be(t,e,n,r,i,o,a){wt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Fe(t,e,n,r,i,o)),this.mergeVertices()}function ze(t,e,n,r,i){Et.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||100,e=e||40,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o=(n+1)*(r+1),a=n*r*6,a=new(65535<a?Uint32Array:Uint16Array)(a),s=new Float32Array(3*o),l=new Float32Array(3*o),o=new Float32Array(2*o),u=0,h=0,d=0,p=new c,f=new c,m=new c,g,v;for(g=0;g<=n;g++)for(v=0;v<=r;v++){var y=v/r*i,_=g/n*Math.PI*2;f.x=(t+e*Math.cos(_))*Math.cos(y),f.y=(t+e*Math.cos(_))*Math.sin(y),f.z=e*Math.sin(_),s[u]=f.x,s[u+1]=f.y,s[u+2]=f.z,p.x=t*Math.cos(y),p.y=t*Math.sin(y),m.subVectors(f,p).normalize(),l[u]=m.x,l[u+1]=m.y,l[u+2]=m.z,o[h]=v/r,o[h+1]=g/n,u+=3,h+=2}for(g=1;g<=n;g++)for(v=1;v<=r;v++)t=(r+1)*(g-1)+v-1,e=(r+1)*(g-1)+v,i=(r+1)*g+v,a[d]=(r+1)*g+v-1,a[d+1]=t,a[d+2]=i,a[d+3]=t,a[d+4]=e,a[d+5]=i,d+=6;this.setIndex(new ht(a,1)),this.addAttribute("position",new ht(s,3)),this.addAttribute("normal",new ht(l,3)),this.addAttribute("uv",new ht(o,2))}function ke(t,e,n,r,i){wt.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new ze(t,e,n,r,i))}function je(t,e){"undefined"!=typeof t&&(wt.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeFaceNormals())}function He(t,e){e=e||{};var n=e.font;return!1===(n&&n.isFont)?(console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new wt):(n=n.generateShapes(t,e.size,e.curveSegments),e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),je.call(this,n,e),void(this.type="TextGeometry"))}function Ge(t,e,n,r,i,o,a){Et.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;for(var s=o+a,l=(e+1)*(n+1),u=new ht(new Float32Array(3*l),3),h=new ht(new Float32Array(3*l),3),l=new ht(new Float32Array(2*l),2),d=0,p=[],f=new c,m=0;m<=n;m++){for(var g=[],v=m/n,y=0;y<=e;y++){var _=y/e,b=-t*Math.cos(r+_*i)*Math.sin(o+v*a),x=t*Math.cos(o+v*a),w=t*Math.sin(r+_*i)*Math.sin(o+v*a);f.set(b,x,w).normalize(),u.setXYZ(d,b,x,w),h.setXYZ(d,f.x,f.y,f.z),l.setXY(d,_,1-v),g.push(d),d++}p.push(g)}for(r=[],m=0;m<n;m++)for(y=0;y<e;y++)i=p[m][y+1],a=p[m][y],d=p[m+1][y],f=p[m+1][y+1],(0!==m||0<o)&&r.push(i,a,f),(m!==n-1||s<Math.PI)&&r.push(a,d,f);this.setIndex(new(65535<u.count?yt:gt)(r,1)),this.addAttribute("position",u),this.addAttribute("normal",h),this.addAttribute("uv",l),this.boundingSphere=new Q(new c,t)}function Ve(t,e,n,r,i,o,a){wt.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Ge(t,e,n,r,i,o,a))}function We(t,e,r,i,o,a){Et.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:i,thetaStart:o,thetaLength:a},t=t||20,e=e||50,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,r=void 0!==r?Math.max(3,r):8,i=void 0!==i?Math.max(1,i):1;var s=(r+1)*(i+1),l=r*i*6,l=new ht(new(65535<l?Uint32Array:Uint16Array)(l),1),u=new ht(new Float32Array(3*s),3),h=new ht(new Float32Array(3*s),3),s=new ht(new Float32Array(2*s),2),d=0,p=0,f,m=t,g=(e-t)/i,v=new c,y=new n,_;for(t=0;t<=i;t++){for(_=0;_<=r;_++)f=o+_/r*a,v.x=m*Math.cos(f),v.y=m*Math.sin(f),u.setXYZ(d,v.x,v.y,v.z),h.setXYZ(d,0,0,1),y.x=(v.x/e+1)/2,y.y=(v.y/e+1)/2,s.setXY(d,y.x,y.y),d++;m+=g}for(t=0;t<i;t++)for(e=t*(r+1),_=0;_<r;_++)o=f=_+e,a=f+r+1,d=f+r+2,f+=1,l.setX(p,o),p++,l.setX(p,a),p++,l.setX(p,d),p++,l.setX(p,o),p++,l.setX(p,d),p++,l.setX(p,f),p++;this.setIndex(l),this.addAttribute("position",u),this.addAttribute("normal",h),this.addAttribute("uv",s)}function Xe(t,e,n,r,i,o){wt.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new We(t,e,n,r,i,o))}function qe(t,e,n,r){wt.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new St(t,e,n,r))}function Ye(t,e,r,i){Et.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:i},e=Math.floor(e)||12,r=r||0,i=i||2*Math.PI,i=ri.clamp(i,0,2*Math.PI);for(var o=(e+1)*t.length,a=e*t.length*6,s=new ht(new(65535<a?Uint32Array:Uint16Array)(a),1),l=new ht(new Float32Array(3*o),3),u=new ht(new Float32Array(2*o),2),h=0,d=0,p=1/e,f=new c,m=new n,o=0;o<=e;o++)for(var a=r+o*p*i,g=Math.sin(a),v=Math.cos(a),a=0;a<=t.length-1;a++)f.x=t[a].x*g,f.y=t[a].y,f.z=t[a].x*v,l.setXYZ(h,f.x,f.y,f.z),m.x=o/e,m.y=a/(t.length-1),u.setXY(h,m.x,m.y),h++;for(o=0;o<e;o++)for(a=0;a<t.length-1;a++)r=a+o*t.length,h=r+t.length,p=r+t.length+1,f=r+1,s.setX(d,r),d++,s.setX(d,h),d++,s.setX(d,f),d++,s.setX(d,h),d++,s.setX(d,p),d++,s.setX(d,f),d++;if(this.setIndex(s),this.addAttribute("position",l),this.addAttribute("uv",u),this.computeVertexNormals(),i===2*Math.PI)for(i=this.attributes.normal.array,s=new c,l=new c,u=new c,r=e*t.length*3,a=o=0;o<t.length;o++,a+=3)s.x=i[a+0],s.y=i[a+1],s.z=i[a+2],l.x=i[r+a+0],l.y=i[r+a+1],l.z=i[r+a+2],u.addVectors(s,l).normalize(),i[a+0]=i[r+a+0]=u.x,i[a+1]=i[r+a+1]=u.y,i[a+2]=i[r+a+2]=u.z}function Ze(t,e,n,r){wt.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Ye(t,e,n,r)),this.mergeVertices()}function Je(t,e){function n(t){var n,s,l=r.length/3;t=t.extractPoints(e);var u=t.shape,h=t.holes;if(!1===_i.isClockWise(u))for(u=u.reverse(),t=0,n=h.length;t<n;t++)s=h[t],!0===_i.isClockWise(s)&&(h[t]=s.reverse());var d=_i.triangulateShape(u,h);for(t=0,n=h.length;t<n;t++)s=h[t],u=u.concat(s);for(t=0,n=u.length;t<n;t++)s=u[t],r.push(s.x,s.y,0),i.push(0,0,1),o.push(s.x,s.y);for(t=0,n=d.length;t<n;t++)u=d[t],a.push(u[0]+l,u[1]+l,u[2]+l),c+=3}Et.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var r=[],i=[],o=[],a=[],s=0,c=0;if(!1===Array.isArray(t))n(t);else for(var l=0;l<t.length;l++)n(t[l]),this.addGroup(s,c,l),s+=c,c=0;this.setIndex(new(65535<a.length?yt:gt)(a,1)),this.addAttribute("position",new _t(r,3)),this.addAttribute("normal",new _t(i,3)),this.addAttribute("uv",new _t(o,2))}function $e(t,e){wt.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Je(t,e)),this.mergeVertices()}function Qe(t,e){function n(t,e){return t-e}Et.call(this);var r=Math.cos(ri.DEG2RAD*(void 0!==e?e:1)),i=[0,0],o={},a=["a","b","c"],s;t.isBufferGeometry?(s=new wt,s.fromBufferGeometry(t)):s=t.clone(),s.mergeVertices(),s.computeFaceNormals();var c=s.vertices;s=s.faces;for(var l=0,u=s.length;l<u;l++)for(var h=s[l],d=0;3>d;d++){i[0]=h[a[d]],i[1]=h[a[(d+1)%3]],i.sort(n);var p=i.toString();void 0===o[p]?o[p]={vert1:i[0],vert2:i[1],face1:l,face2:void 0}:o[p].face2=l}i=[];for(p in o)a=o[p],(void 0===a.face2||s[a.face1].normal.dot(s[a.face2].normal)<=r)&&(l=c[a.vert1],i.push(l.x),i.push(l.y),i.push(l.z),l=c[a.vert2],i.push(l.x),i.push(l.y),i.push(l.z));this.addAttribute("position",new _t(i,3))}function Ke(t,e,r,i,o,a,s,l){function u(r){var o,a,u,d=new n,p=new c,f=0,x=!0===r?t:e,M=!0===r?1:-1;for(a=_,o=1;o<=i;o++)g.setXYZ(_,0,w*M,0),v.setXYZ(_,0,M,0),d.x=.5,d.y=.5,y.setXY(_,d.x,d.y),_++;for(u=_,o=0;o<=i;o++){var T=o/i*l+s,S=Math.cos(T),T=Math.sin(T);p.x=x*T,p.y=w*M,p.z=x*S,g.setXYZ(_,p.x,p.y,p.z),v.setXYZ(_,0,M,0),d.x=.5*S+.5,d.y=.5*T*M+.5,y.setXY(_,d.x,d.y),_++}for(o=0;o<i;o++)d=a+o,p=u+o,!0===r?(m.setX(b,p),b++,m.setX(b,p+1)):(m.setX(b,p+1),b++,m.setX(b,p)),b++,m.setX(b,d),b++,f+=3;h.addGroup(E,f,!0===r?1:2),E+=f}Et.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l};var h=this;t=void 0!==t?t:20,e=void 0!==e?e:20,r=void 0!==r?r:100,i=Math.floor(i)||8,o=Math.floor(o)||1,a=void 0!==a&&a,s=void 0!==s?s:0,l=void 0!==l?l:2*Math.PI;var d=0;!1===a&&(0<t&&d++,0<e&&d++);var p=function(){var t=(i+1)*(o+1);return!1===a&&(t+=(i+1)*d+i*d),t}(),f=function(){var t=i*o*6;return!1===a&&(t+=i*d*3),t}(),m=new ht(new(65535<f?Uint32Array:Uint16Array)(f),1),g=new ht(new Float32Array(3*p),3),v=new ht(new Float32Array(3*p),3),y=new ht(new Float32Array(2*p),2),_=0,b=0,x=[],w=r/2,E=0;!function(){var n,a,u=new c,d=new c,p=0,f=(e-t)/r;for(a=0;a<=o;a++){var M=[],T=a/o,S=T*(e-t)+t;for(n=0;n<=i;n++){var A=n/i,L=A*l+s,R=Math.sin(L),L=Math.cos(L);d.x=S*R,d.y=-T*r+w,d.z=S*L,g.setXYZ(_,d.x,d.y,d.z),u.set(R,f,L).normalize(),v.setXYZ(_,u.x,u.y,u.z),y.setXY(_,A,1-T),M.push(_),_++}x.push(M)}for(n=0;n<i;n++)for(a=0;a<o;a++)u=x[a+1][n],d=x[a+1][n+1],f=x[a][n+1],m.setX(b,x[a][n]),b++,m.setX(b,u),b++,m.setX(b,f),b++,m.setX(b,u),b++,m.setX(b,d),b++,m.setX(b,f),b++,p+=6;h.addGroup(E,p,0),E+=p}(),!1===a&&(0<t&&u(!0),0<e&&u(!1)),this.setIndex(m),this.addAttribute("position",g),this.addAttribute("normal",v),this.addAttribute("uv",y)}function tn(t,e,n,r,i,o,a,s){wt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Ke(t,e,n,r,i,o,a,s)),this.mergeVertices()}function en(t,e,n,r,i,o,a){tn.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function nn(t,e,n,r,i,o,a){Ke.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function rn(t,e,n,r){Et.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||50,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i=e+2,o=new Float32Array(3*i),a=new Float32Array(3*i),i=new Float32Array(2*i);a[2]=1,i[0]=.5,i[1]=.5;for(var s=0,l=3,u=2;s<=e;s++,l+=3,u+=2){var h=n+s/e*r;o[l]=t*Math.cos(h),o[l+1]=t*Math.sin(h),a[l+2]=1,i[u]=(o[l]/t+1)/2,i[u+1]=(o[l+1]/t+1)/2}for(n=[],l=1;l<=e;l++)n.push(l,l+1,0);this.setIndex(new ht(new Uint16Array(n),1)),this.addAttribute("position",new ht(o,3)),this.addAttribute("normal",new ht(a,3)),this.addAttribute("uv",new ht(i,2)),this.boundingSphere=new Q(new c,t)}function on(t,e,n,r){wt.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new rn(t,e,n,r))}function an(t,e,n,r,i,o){wt.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Tt(t,e,n,r,i,o)),this.mergeVertices()}function sn(){Y.call(this,{uniforms:ui.merge([pi.lights,{opacity:{value:1}}]),vertexShader:hi.shadow_vert,fragmentShader:hi.shadow_frag}),this.transparent=this.lights=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}})}function cn(t){Y.call(this,t),this.type="RawShaderMaterial"}function ln(t){this.uuid=ri.generateUUID(),this.type="MultiMaterial",this.materials=Array.isArray(t)?t:[],this.visible=!0}function un(t){q.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new H(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new H(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function hn(t){un.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(t)}function dn(t){q.call(this),this.type="MeshPhongMaterial",this.color=new H(16777215),this.specular=new H(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new H(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function pn(t){dn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function fn(t){q.call(this,t),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(t)}function mn(t){q.call(this),this.type="MeshLambertMaterial",this.color=new H(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new H(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function gn(t){q.call(this),this.type="LineDashedMaterial",this.color=new H(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}function vn(t,e,n){var r=this,i=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad)&&r.onLoad()},this.itemError=function(t){void 0!==r.onError&&r.onError(t)}}function yn(t){this.manager=void 0!==t?t:Ei}function _n(t){this.manager=void 0!==t?t:Ei,this._parser=null}function bn(t){this.manager=void 0!==t?t:Ei,this._parser=null}function xn(t){this.manager=void 0!==t?t:Ei}function wn(t){this.manager=void 0!==t?t:Ei}function En(t){this.manager=void 0!==t?t:Ei}function Mn(t,e){at.call(this),this.type="Light",this.color=new H(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Tn(t,e,n){Mn.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(at.DefaultUp),this.updateMatrix(),this.groundColor=new H(e)}function Sn(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new n(512,512),this.map=null,this.matrix=new l}function An(){Sn.call(this,new Lt(50,1,.5,500))}function Ln(t,e,n,r,i,o){Mn.call(this,t,e),this.type="SpotLight",this.position.copy(at.DefaultUp),this.updateMatrix(),this.target=new at,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new An}function Rn(t,e,n,r){Mn.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Sn(new Lt(90,1,.5,500))}function Cn(t){Sn.call(this,new Rt(-5,5,5,-5,.5,500))}function Pn(t,e){Mn.call(this,t,e),this.type="DirectionalLight",this.position.copy(at.DefaultUp),this.updateMatrix(),this.target=new at,this.shadow=new Cn}function On(t,e){Mn.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Nn(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function In(t,e,n,r){Nn.call(this,t,e,n,r),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Dn(t,e,n,r){Nn.call(this,t,e,n,r)}function Un(t,e,n,r){Nn.call(this,t,e,n,r)}function Fn(t,e,n,r){if(void 0===t)throw Error("track name is undefined");if(void 0===e||0===e.length)throw Error("no keyframes in track named "+t);this.name=t,this.times=Mi.convertArray(e,this.TimeBufferType),this.values=Mi.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Bn(t,e,n,r){Fn.call(this,t,e,n,r)}function zn(t,e,n,r){Nn.call(this,t,e,n,r)}function kn(t,e,n,r){Fn.call(this,t,e,n,r)}function jn(t,e,n,r){Fn.call(this,t,e,n,r)}function Hn(t,e,n,r){Fn.call(this,t,e,n,r)}function Gn(t,e,n){Fn.call(this,t,e,n)}function Vn(t,e,n,r){Fn.call(this,t,e,n,r)}function Wn(t,e,n,r){Fn.apply(this,arguments)}function Xn(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=ri.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function qn(t){this.manager=void 0!==t?t:Ei,this.textures={}}function Yn(t){this.manager=void 0!==t?t:Ei}function Zn(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function Jn(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),
t=void 0),this.manager=void 0!==t?t:Ei,this.withCredentials=!1}function $n(t){this.manager=void 0!==t?t:Ei,this.texturePath=""}function Qn(){}function Kn(t,e){this.v1=t,this.v2=e}function tr(){this.curves=[],this.autoClose=!1}function er(t,e,n,r,i,o,a,s){this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function nr(t){this.points=void 0===t?[]:t}function rr(t,e,n,r){this.v0=t,this.v1=e,this.v2=n,this.v3=r}function ir(t,e,n){this.v0=t,this.v1=e,this.v2=n}function or(){ar.apply(this,arguments),this.holes=[]}function ar(t){tr.call(this),this.currentPoint=new n,t&&this.fromPoints(t)}function sr(){this.subPaths=[],this.currentPath=null}function cr(t){this.data=t}function lr(t){this.manager=void 0!==t?t:Ei}function ur(t){this.manager=void 0!==t?t:Ei}function hr(t,e,n,r){Mn.call(this,t,e),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function dr(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Lt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Lt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function pr(t,e,n){at.call(this),this.type="CubeCamera";var r=new Lt(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new c(1,0,0)),this.add(r);var i=new Lt(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new c(-1,0,0)),this.add(i);var o=new Lt(90,1,t,e);o.up.set(0,0,1),o.lookAt(new c(0,1,0)),this.add(o);var s=new Lt(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new c(0,-1,0)),this.add(s);var l=new Lt(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new c(0,0,1)),this.add(l);var u=new Lt(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new c(0,0,-1)),this.add(u),this.renderTarget=new a(n,n,{format:1022,magFilter:1006,minFilter:1006}),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,a=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,r,n),n.activeCubeFace=1,t.render(e,i,n),n.activeCubeFace=2,t.render(e,o,n),n.activeCubeFace=3,t.render(e,s,n),n.activeCubeFace=4,t.render(e,l,n),n.texture.generateMipmaps=a,n.activeCubeFace=5,t.render(e,u,n),t.setRenderTarget(null)}}function fr(){at.call(this),this.type="AudioListener",this.context=Ri.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function mr(t){at.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function gr(t){mr.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function vr(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function yr(t,e,n){switch(this.binding=t,this.valueSize=n,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp}this.buffer=new t(4*n),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0}function _r(t,e,n){this.path=e,this.parsedPath=n||_r.parseTrackName(e),this.node=_r.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function br(t){this.uuid=ri.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function xr(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null,t=e.tracks,e=t.length,n=Array(e);for(var r={endingStart:2400,endingEnd:2400},i=0;i!==e;++i){var o=t[i].createInterpolant(null);n[i]=o,o.settings=r}this._interpolantSettings=r,this._interpolants=n,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function wr(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Er(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function Mr(){Et.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Tr(t,e,n,r){this.uuid=ri.generateUUID(),this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function Sr(t,e){this.uuid=ri.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Ar(t,e,n){Sr.call(this,t,e),this.meshPerAttribute=n||1}function Lr(t,e,n){ht.call(this,t,e),this.meshPerAttribute=n||1}function Rr(t,e,n,r){this.ray=new rt(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Cr(t,e){return t.distance-e.distance}function Pr(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r)){t=t.children,r=0;for(var i=t.length;r<i;r++)Pr(t[r],e,n,!0)}}function Or(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Nr(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Ir(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function Dr(t,e){Mt.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length;this.createAnimation("__default",0,n-1,n/1),this.setAnimationWeight("__default",1)}function Ur(t){at.call(this),this.material=t,this.render=function(t){}}function Fr(t,e,n,r){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16711680,r=void 0!==r?r:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=3*n.faces.length:n&&n.isBufferGeometry&&(e=n.attributes.normal.count),n=new Et,e=new _t(6*e,3),n.addAttribute("position",e),fe.call(this,n,new de({color:t,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Br(t){at.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,t=new Et;for(var e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1;32>n;n++,r++){var i=n/32*Math.PI*2,o=r/32*Math.PI*2;e.push(Math.cos(i),Math.sin(i),1,Math.cos(o),Math.sin(o),1)}t.addAttribute("position",new _t(e,3)),e=new de({fog:!1}),this.cone=new fe(t,e),this.add(this.cone),this.update()}function zr(t){this.bones=this.getBoneList(t);for(var e=new Et,n=[],r=[],i=new H(0,0,1),o=new H(0,1,0),a=0;a<this.bones.length;a++){var s=this.bones[a];s.parent&&s.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(i.r,i.g,i.b),r.push(o.r,o.g,o.b))}e.addAttribute("position",new _t(n,3)),e.addAttribute("color",new _t(r,3)),n=new de({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),fe.call(this,e,n),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function kr(t,e){this.light=t,this.light.updateMatrixWorld();var n=new Ge(e,4,2),r=new ut({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),Mt.call(this,n,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function jr(t){at.call(this),this.light=t,this.light.updateMatrixWorld();var e=new ut({color:t.color,fog:!1});t=new ut({color:t.color,fog:!1,wireframe:!0});var n=new Et;n.addAttribute("position",new ht(new Float32Array(18),3)),this.add(new Mt(n,e)),this.add(new Mt(n,t)),this.update()}function Hr(t,e){at.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var n=new Le(e);n.rotateY(.5*Math.PI);var r=new ut({vertexColors:2,wireframe:!0}),i=n.getAttribute("position"),i=new Float32Array(3*i.count);n.addAttribute("color",new ht(i,3)),this.add(new Mt(n,r)),this.update()}function Gr(t,e,n,r){t=t||10,e=e||10,n=new H(void 0!==n?n:4473924),r=new H(void 0!==r?r:8947848);for(var i=e/2,o=2*t/e,a=[],s=[],c=0,l=0,u=-t;c<=e;c++,u+=o){a.push(-t,0,u,t,0,u),a.push(u,0,-t,u,0,t);var h=c===i?n:r;h.toArray(s,l),l+=3,h.toArray(s,l),l+=3,h.toArray(s,l),l+=3,h.toArray(s,l),l+=3}t=new Et,t.addAttribute("position",new _t(a,3)),t.addAttribute("color",new _t(s,3)),a=new de({vertexColors:2}),fe.call(this,t,a)}function Vr(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new H(void 0!==i?i:4473924),o=new H(void 0!==o?o:8947848);var a=[],s=[],c,l,u,h,d;for(u=0;u<=e;u++)l=u/e*2*Math.PI,c=Math.sin(l)*t,l=Math.cos(l)*t,a.push(0,0,0),a.push(c,0,l),d=1&u?i:o,s.push(d.r,d.g,d.b),s.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?i:o,h=t-t/n*u,e=0;e<r;e++)l=e/r*2*Math.PI,c=Math.sin(l)*h,l=Math.cos(l)*h,a.push(c,0,l),s.push(d.r,d.g,d.b),l=(e+1)/r*2*Math.PI,c=Math.sin(l)*h,l=Math.cos(l)*h,a.push(c,0,l),s.push(d.r,d.g,d.b);t=new Et,t.addAttribute("position",new _t(a,3)),t.addAttribute("color",new _t(s,3)),a=new de({vertexColors:2}),fe.call(this,t,a)}function Wr(t,e,n,r){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16776960,r=void 0!==r?r:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=n.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),n=new Et,e=new _t(6*e,3),n.addAttribute("position",e),fe.call(this,n,new de({color:t,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Xr(t,e){at.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var n=new Et;n.addAttribute("position",new _t([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var r=new de({fog:!1});this.add(new pe(n,r)),n=new Et,n.addAttribute("position",new _t([0,0,0,0,0,1],3)),this.add(new pe(n,r)),this.update()}function qr(t){function e(t,e,r){n(t,r),n(e,r)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var r=new Et,i=new de({color:16777215,vertexColors:1}),o=[],a=[],s={},c=new H(16755200),l=new H(16711680),u=new H(43775),h=new H(16777215),d=new H(3355443);e("n1","n2",c),e("n2","n4",c),e("n4","n3",c),e("n3","n1",c),e("f1","f2",c),e("f2","f4",c),e("f4","f3",c),e("f3","f1",c),e("n1","f1",c),e("n2","f2",c),e("n3","f3",c),e("n4","f4",c),e("p","n1",l),e("p","n2",l),e("p","n3",l),e("p","n4",l),e("u1","u2",u),e("u2","u3",u),e("u3","u1",u),e("c","t",h),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),r.addAttribute("position",new _t(o,3)),r.addAttribute("color",new _t(a,3)),fe.call(this,r,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function Yr(t,e){void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Et;i.setIndex(new ht(n,1)),i.addAttribute("position",new ht(r,3)),fe.call(this,i,new de({color:e})),void 0!==t&&this.update(t)}function Zr(t,e,n,r,i,o){at.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),this.position.copy(e),this.line=new pe(Ci,new de({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mt(Pi,new ut({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function Jr(t){t=t||1;var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t];t=new Et,t.addAttribute("position",new _t(e,3)),t.addAttribute("color",new _t([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new de({vertexColors:2}),fe.call(this,t,e)}function $r(t,e,n,r,i,o){er.call(this,t,e,n,n,r,i,o)}function Qr(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Oi.call(this,t),this.type="catmullrom",this.closed=!0}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}}(),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;var n=[],r,i=e.length;for(r=0;r<i;r++)n[r]=e[r];for(r=0;r<i;r++)n[r].call(this,t)}}}});var Kr={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},ti={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},ei={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},ni={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008},ri={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=Array(36),n=0,r;return function(){for(var i=0;36>i;i++)8===i||13===i||18===i||23===i?e[i]="-":14===i?e[i]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),r=15&n,n>>=4,e[i]=t[19===i?3&r|8:r]);return e.join("")}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*ri.DEG2RAD},radToDeg:function(t){return t*ri.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}};n.prototype={constructor:n,isVector2:!0,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):this.y=this.x=0,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(r,i){return void 0===t&&(t=new n,e=new n),t.set(r,r),e.set(i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}};var ii=0;r.DEFAULT_IMAGE=void 0,r.DEFAULT_MAPPING=300,r.prototype={constructor:r,isTexture:!0,set needsUpdate(t){!0===t&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var e={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=ri.generateUUID()),void 0===t.images[n.uuid]){var r=t.images,i=n.uuid,o=n.uuid,a;void 0!==n.toDataURL?a=n:(a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),a.width=n.width,a.height=n.height,a.getContext("2d").drawImage(n,0,0,n.width,n.height)),a=2048<a.width||2048<a.height?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png"),r[i]={uuid:o,url:a}}e.image=n.uuid}return t.textures[this.uuid]=e},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.multiply(this.repeat),t.add(this.offset),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Object.assign(r.prototype,e.prototype),i.prototype={constructor:i,isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):this.w=this.z=this.y=this.x=0,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*r+t[12]*i,this.y=t[1]*e+t[5]*n+t[9]*r+t[13]*i,this.z=t[2]*e+t[6]*n+t[10]*r+t[14]*i,this.w=t[3]*e+t[7]*n+t[11]*r+t[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r;t=t.elements;var i=t[0];r=t[4];var o=t[8],a=t[1],s=t[5],c=t[9];n=t[2],e=t[6];var l=t[10];return.01>Math.abs(r-a)&&.01>Math.abs(o-n)&&.01>Math.abs(c-e)?.1>Math.abs(r+a)&&.1>Math.abs(o+n)&&.1>Math.abs(c+e)&&.1>Math.abs(i+s+l-3)?(this.set(1,0,0,0),this):(t=Math.PI,i=(i+1)/2,s=(s+1)/2,l=(l+1)/2,r=(r+a)/4,o=(o+n)/4,c=(c+e)/4,i>s&&i>l?.01>i?(e=0,r=n=.707106781):(e=Math.sqrt(i),n=r/e,r=o/e):s>l?.01>s?(e=.707106781,n=0,r=.707106781):(n=Math.sqrt(s),e=r/n,r=c/n):.01>l?(n=e=.707106781,r=0):(r=Math.sqrt(l),e=o/r,n=c/r),this.set(e,n,r,t),this):(t=Math.sqrt((e-c)*(e-c)+(o-n)*(o-n)+(a-r)*(a-r)),.001>Math.abs(t)&&(t=1),this.x=(e-c)/t,this.y=(o-n)/t,this.z=(a-r)/t,this.w=Math.acos((i+s+l-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new i,e=new i),t.set(n,n,n,n),e.set(r,r,r,r),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}},Object.assign(o.prototype,e.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.isWebGLRenderTargetCube=!0,s.prototype={constructor:s,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!1===(t&&t.isEuler))throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),r=Math.cos(t._y/2),i=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),c=t.order;return"XYZ"===c?(this._x=o*r*i+n*a*s,this._y=n*a*i-o*r*s,this._z=n*r*s+o*a*i,this._w=n*r*i-o*a*s):"YXZ"===c?(this._x=o*r*i+n*a*s,this._y=n*a*i-o*r*s,this._z=n*r*s-o*a*i,this._w=n*r*i+o*a*s):"ZXY"===c?(this._x=o*r*i-n*a*s,this._y=n*a*i+o*r*s,this._z=n*r*s+o*a*i,this._w=n*r*i-o*a*s):"ZYX"===c?(this._x=o*r*i-n*a*s,this._y=n*a*i+o*r*s,this._z=n*r*s-o*a*i,this._w=n*r*i+o*a*s):"YZX"===c?(this._x=o*r*i+n*a*s,this._y=n*a*i+o*r*s,this._z=n*r*s-o*a*i,this._w=n*r*i-o*a*s):"XZY"===c&&(this._x=o*r*i-n*a*s,this._y=n*a*i-o*r*s,this._z=n*r*s+o*a*i,this._w=n*r*i+o*a*s),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,n=e[0];t=e[4];var r=e[8],i=e[1],o=e[5],a=e[9],s=e[2],c=e[6],e=e[10],l=n+o+e;return 0<l?(n=.5/Math.sqrt(l+1),this._w=.25/n,this._x=(c-a)*n,this._y=(r-s)*n,this._z=(i-t)*n):n>o&&n>e?(n=2*Math.sqrt(1+n-o-e),this._w=(c-a)/n,this._x=.25*n,this._y=(t+i)/n,this._z=(r+s)/n):o>e?(n=2*Math.sqrt(1+o-n-e),this._w=(r-s)/n,this._x=(t+i)/n,this._y=.25*n,this._z=(a+c)/n):(n=2*Math.sqrt(1+e-n-o),this._w=(i-t)/n,this._x=(r+s)/n,this._y=(a+c)/n,this._z=.25*n),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e;return function(n,r){return void 0===t&&(t=new c),e=n.dot(r)+1,1e-6>e?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,c=e._z,l=e._w;return this._x=n*l+o*a+r*c-i*s,this._y=r*l+o*s+i*a-n*c,this._z=i*l+o*c+n*s-r*a,this._w=o*l-n*a-r*s-i*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),1<=a)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=Math.sqrt(1-a*a);if(.001>Math.abs(s))return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var c=Math.atan2(s,a),a=Math.sin((1-e)*c)/s,s=Math.sin(e*c)/s;
return this._w=o*a+this._w*s,this._x=n*a+this._x*s,this._y=r*a+this._y*s,this._z=i*a+this._z*s,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(s,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],c=n[r+1],l=n[r+2];n=n[r+3],r=i[o+0];var u=i[o+1],h=i[o+2];if(i=i[o+3],n!==i||s!==r||c!==u||l!==h){o=1-a;var d=s*r+c*u+l*h+n*i,p=0<=d?1:-1,f=1-d*d;f>Number.EPSILON&&(f=Math.sqrt(f),d=Math.atan2(f,d*p),o=Math.sin(o*d)/f,a=Math.sin(a*d)/f),p*=a,s=s*o+r*p,c=c*o+u*p,l=l*o+h*p,n=n*o+i*p,o===1-a&&(a=1/Math.sqrt(s*s+c*c+l*l+n*n),s*=a,c*=a,l*=a,n*=a)}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=n}}),c.prototype={constructor:c,isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):this.z=this.y=this.x=0,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return!1===(e&&e.isEuler)&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new s),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new s),this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z;return t=t.elements,this.x=t[0]*e+t[3]*n+t[6]*r,this.y=t[1]*e+t[4]*n+t[7]*r,this.z=t[2]*e+t[5]*n+t[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*r+t[12],this.y=t[1]*e+t[5]*n+t[9]*r+t[13],this.z=t[2]*e+t[6]*n+t[10]*r+t[14],this},applyProjection:function(t){var e=this.x,n=this.y,r=this.z;t=t.elements;var i=1/(t[3]*e+t[7]*n+t[11]*r+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*r+t[12])*i,this.y=(t[1]*e+t[5]*n+t[9]*r+t[13])*i,this.z=(t[2]*e+t[6]*n+t[10]*r+t[14])*i,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z;t=t.w;var s=t*e+o*r-a*n,c=t*n+a*e-i*r,l=t*r+i*n-o*e,e=-i*e-o*n-a*r;return this.x=s*t+e*-i+c*-a-l*-o,this.y=c*t+e*-o+l*-i-s*-a,this.z=l*t+e*-a+s*-o-c*-i,this},project:function(){var t;return function(e){return void 0===t&&(t=new l),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new l),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,r=this.z;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*r,this.y=t[1]*e+t[5]*n+t[9]*r,this.z=t[2]*e+t[6]*n+t[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new c,e=new c),t.set(n,n,n),e.set(r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,r=this.y,i=this.z;return this.x=r*t.z-i*t.y,this.y=i*t.x-n*t.z,this.z=n*t.y-r*t.x,this},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new c),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new c),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(ri.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return t=this.z-t.z,e*e+n*n+t*t},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var n=t;t=e,e=n}return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}},l.prototype={constructor:l,isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,c,l,u,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=l,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new l).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new c);var n=this.elements,r=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length();return e=1/t.setFromMatrixColumn(e,2).length(),n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[8]=r[8]*e,n[9]=r[9]*e,n[10]=r[10]*e,this}}(),makeRotationFromEuler:function(t){!1===(t&&t.isEuler)&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),n=Math.sin(n),a=Math.cos(r),r=Math.sin(r),s=Math.cos(i),i=Math.sin(i);if("XYZ"===t.order){t=o*s;var c=o*i,l=n*s,u=n*i;e[0]=a*s,e[4]=-a*i,e[8]=r,e[1]=c+l*r,e[5]=t-u*r,e[9]=-n*a,e[2]=u-t*r,e[6]=l+c*r,e[10]=o*a}else"YXZ"===t.order?(t=a*s,c=a*i,l=r*s,u=r*i,e[0]=t+u*n,e[4]=l*n-c,e[8]=o*r,e[1]=o*i,e[5]=o*s,e[9]=-n,e[2]=c*n-l,e[6]=u+t*n,e[10]=o*a):"ZXY"===t.order?(t=a*s,c=a*i,l=r*s,u=r*i,e[0]=t-u*n,e[4]=-o*i,e[8]=l+c*n,e[1]=c+l*n,e[5]=o*s,e[9]=u-t*n,e[2]=-o*r,e[6]=n,e[10]=o*a):"ZYX"===t.order?(t=o*s,c=o*i,l=n*s,u=n*i,e[0]=a*s,e[4]=l*r-c,e[8]=t*r+u,e[1]=a*i,e[5]=u*r+t,e[9]=c*r-l,e[2]=-r,e[6]=n*a,e[10]=o*a):"YZX"===t.order?(t=o*a,c=o*r,l=n*a,u=n*r,e[0]=a*s,e[4]=u-t*i,e[8]=l*i+c,e[1]=i,e[5]=o*s,e[9]=-n*s,e[2]=-r*s,e[6]=c*i+l,e[10]=t-u*i):"XZY"===t.order&&(t=o*a,c=o*r,l=n*a,u=n*r,e[0]=a*s,e[4]=-i,e[8]=r*s,e[1]=t*i+u,e[5]=o*s,e[9]=c*i-l,e[2]=l*i-c,e[6]=n*s,e[10]=u*i+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z,o=t.w,a=n+n,s=r+r,c=i+i;t=n*a;var l=n*s,n=n*c,u=r*s,r=r*c,i=i*c,a=o*a,s=o*s,o=o*c;return e[0]=1-(u+i),e[4]=l-o,e[8]=n+s,e[1]=l+o,e[5]=1-(t+i),e[9]=r-a,e[2]=n-s,e[6]=r+a,e[10]=1-(t+u),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,n;return function(r,i,o){void 0===t&&(t=new c,e=new c,n=new c);var a=this.elements;return n.subVectors(r,i).normalize(),0===n.lengthSq()&&(n.z=1),t.crossVectors(o,n).normalize(),0===t.lengthSq()&&(n.z+=1e-4,t.crossVectors(o,n).normalize()),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],l=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],n=n[15],b=r[0],x=r[4],w=r[8],E=r[12],M=r[1],T=r[5],S=r[9],A=r[13],L=r[2],R=r[6],C=r[10],P=r[14],O=r[3],N=r[7],I=r[11],r=r[15];return i[0]=o*b+a*M+s*L+c*O,i[4]=o*x+a*T+s*R+c*N,i[8]=o*w+a*S+s*C+c*I,i[12]=o*E+a*A+s*P+c*r,i[1]=l*b+u*M+h*L+d*O,i[5]=l*x+u*T+h*R+d*N,i[9]=l*w+u*S+h*C+d*I,i[13]=l*E+u*A+h*P+d*r,i[2]=p*b+f*M+m*L+g*O,i[6]=p*x+f*T+m*R+g*N,i[10]=p*w+f*S+m*C+g*I,i[14]=p*E+f*A+m*P+g*r,i[3]=v*b+y*M+_*L+n*O,i[7]=v*x+y*T+_*R+n*N,i[11]=v*w+y*S+_*C+n*I,i[15]=v*E+y*A+_*P+n*r,this},multiplyToArray:function(t,e,n){var r=this.elements;return this.multiplyMatrices(t,e),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,n,r){void 0===t&&(t=new c),void 0===n&&(n=0),void 0===r&&(r=e.length);for(var i=0;i<r;i+=3,n+=3)t.fromArray(e,n),t.applyMatrix4(this),t.toArray(e,n);return e}}(),applyToBufferAttribute:function(){var t;return function(e){void 0===t&&(t=new c);for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],c=t[13],l=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+i*s*u-r*c*u-i*a*h+n*c*h+r*a*d-n*s*d)+t[7]*(+e*s*d-e*c*h+i*o*h-r*o*d+r*c*l-i*s*l)+t[11]*(+e*c*u-e*a*d-i*o*u+n*o*d+i*a*l-n*c*l)+t[15]*(-r*a*l-e*s*u+e*a*h+r*o*u-n*o*h+n*s*l)},transpose:function(){var t=this.elements,e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],l=r[5],u=r[6],h=r[7],d=r[8],p=r[9],f=r[10],m=r[11],g=r[12],v=r[13],y=r[14],r=r[15],_=p*y*h-v*f*h+v*u*m-l*y*m-p*u*r+l*f*r,b=g*f*h-d*y*h-g*u*m+c*y*m+d*u*r-c*f*r,x=d*v*h-g*p*h+g*l*m-c*v*m-d*l*r+c*p*r,w=g*p*u-d*v*u-g*l*f+c*v*f+d*l*y-c*p*y,E=i*_+o*b+a*x+s*w;if(0===E){if(!0===e)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return E=1/E,n[0]=_*E,n[1]=(v*f*s-p*y*s-v*a*m+o*y*m+p*a*r-o*f*r)*E,n[2]=(l*y*s-v*u*s+v*a*h-o*y*h-l*a*r+o*u*r)*E,n[3]=(p*u*s-l*f*s-p*a*h+o*f*h+l*a*m-o*u*m)*E,n[4]=b*E,n[5]=(d*y*s-g*f*s+g*a*m-i*y*m-d*a*r+i*f*r)*E,n[6]=(g*u*s-c*y*s-g*a*h+i*y*h+c*a*r-i*u*r)*E,n[7]=(c*f*s-d*u*s+d*a*h-i*f*h-c*a*m+i*u*m)*E,n[8]=x*E,n[9]=(g*p*s-d*v*s-g*o*m+i*v*m+d*o*r-i*p*r)*E,n[10]=(c*v*s-g*l*s+g*o*h-i*v*h-c*o*r+i*l*r)*E,n[11]=(d*l*s-c*p*s-d*o*h+i*p*h+c*o*m-i*l*m)*E,n[12]=w*E,n[13]=(d*v*a-g*p*a+g*o*f-i*v*f-d*o*y+i*p*y)*E,n[14]=(g*l*a-c*v*a-g*o*u+i*v*u+c*o*y-i*l*y)*E,n[15]=(c*p*a-d*l*a+d*o*u-i*p*u-c*o*f+i*l*f)*E,this},scale:function(t){var e=this.elements,n=t.x,r=t.y;return t=t.z,e[0]*=n,e[4]*=r,e[8]*=t,e[1]*=n,e[5]*=r,e[9]*=t,e[2]*=n,e[6]*=r,e[10]*=t,e[3]*=n,e[7]*=r,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,c=i*o,l=i*a;return this.set(c*o+n,c*a-r*s,c*s+r*a,0,c*a+r*s,l*a+n,l*s-r*o,0,c*s-r*a,l*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t,e;return function(n,r,i){void 0===t&&(t=new c,e=new l);var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),u=t.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.elements.set(this.elements),n=1/a;var o=1/s,h=1/u;return e.elements[0]*=n,e.elements[1]*=n,e.elements[2]*=n,e.elements[4]*=o,e.elements[5]*=o,e.elements[6]*=o,e.elements[8]*=h,e.elements[9]*=h,e.elements[10]*=h,r.setFromRotationMatrix(e),i.x=a,i.y=s,i.z=u,this}}(),makeFrustum:function(t,e,n,r,i,o){var a=this.elements;return a[0]=2*i/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*i/(r-n),a[9]=(r+n)/(r-n),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+i)/(o-i),a[14]=-2*o*i/(o-i),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,n,r){t=n*Math.tan(ri.DEG2RAD*t*.5);var i=-t;return this.makeFrustum(i*e,t*e,i,t,n,r)},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),c=1/(n-r),l=1/(o-i);return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-((e+t)*s),a[1]=0,a[5]=2*c,a[9]=0,a[13]=-((n+r)*c),a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-((o+i)*l),a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var n=0;16>n;n++)if(e[n]!==t[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;16>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}},u.prototype=Object.create(r.prototype),u.prototype.constructor=u,u.prototype.isCubeTexture=!0,Object.defineProperty(u.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var oi=new r,ai=new u,si=[],ci=[];k.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(t,e[o.id])}};var li=/([\w\d_]+)(\])?(\[|\.)?/g;j.prototype.setValue=function(t,e,n){e=this.map[e],void 0!==e&&e.setValue(t,n,this.renderer)},j.prototype.set=function(t,e,n){var r=this.map[n];void 0!==r&&r.setValue(t,e[n],this.renderer)},j.prototype.setOptional=function(t,e,n){e=e[n],void 0!==e&&this.setValue(t,n,e)},j.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},j.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var ui={merge:function(t){for(var e={},n=0;n<t.length;n++){var r=this.clone(t[n]),i;for(i in r)e[i]=r[i]}return e},clone:function(t){var e={},n;for(n in t){e[n]={};for(var r in t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}},hi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 ltcTextureCoords( const in GeometricContext geometry, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = (LUT_SIZE - 1.0)/LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5/LUT_SIZE;\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nvoid clipQuadToHorizon( inout vec3 L[5], out int n ) {\n\tint config = 0;\n\tif ( L[0].z > 0.0 ) config += 1;\n\tif ( L[1].z > 0.0 ) config += 2;\n\tif ( L[2].z > 0.0 ) config += 4;\n\tif ( L[3].z > 0.0 ) config += 8;\n\tn = 0;\n\tif ( config == 0 ) {\n\t} else if ( config == 1 ) {\n\t\tn = 3;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 2 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 3 ) {\n\t\tn = 4;\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t\tL[3] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 4 ) {\n\t\tn = 3;\n\t\tL[0] = -L[3].z * L[2] + L[2].z * L[3];\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t} else if ( config == 5 ) {\n\t\tn = 0;\n\t} else if ( config == 6 ) {\n\t\tn = 4;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 7 ) {\n\t\tn = 5;\n\t\tL[4] = -L[3].z * L[0] + L[0].z * L[3];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 8 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[1] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] =  L[3];\n\t} else if ( config == 9 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[2].z * L[3] + L[3].z * L[2];\n\t} else if ( config == 10 ) {\n\t\tn = 0;\n\t} else if ( config == 11 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 12 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t} else if ( config == 13 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = L[2];\n\t\tL[2] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t} else if ( config == 14 ) {\n\t\tn = 5;\n\t\tL[4] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t} else if ( config == 15 ) {\n\t\tn = 4;\n\t}\n\tif ( n == 3 )\n\t\tL[3] = L[0];\n\tif ( n == 4 )\n\t\tL[4] = L[0];\n}\nfloat integrateLtcBrdfOverRectEdge( vec3 v1, vec3 v2 ) {\n\tfloat cosTheta = dot( v1, v2 );\n\tfloat theta = acos( cosTheta );\n\tfloat res = cross( v1, v2 ).z * ( ( theta > 0.001 ) ? theta / sin( theta ) : 1.0 );\n\treturn res;\n}\nvoid initRectPoints( const in vec3 pos, const in vec3 halfWidth, const in vec3 halfHeight, out vec3 rectPoints[4] ) {\n\trectPoints[0] = pos - halfWidth - halfHeight;\n\trectPoints[1] = pos + halfWidth - halfHeight;\n\trectPoints[2] = pos + halfWidth + halfHeight;\n\trectPoints[3] = pos - halfWidth + halfHeight;\n}\nvec3 integrateLtcBrdfOverRect( const in GeometricContext geometry, const in mat3 brdfMat, const in vec3 rectPoints[4] ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tvec3 T1, T2;\n\tT1 = normalize(V - N * dot( V, N ));\n\tT2 = - cross( N, T1 );\n\tmat3 brdfWrtSurface = brdfMat * transpose( mat3( T1, T2, N ) );\n\tvec3 clippedRect[5];\n\tclippedRect[0] = brdfWrtSurface * ( rectPoints[0] - P );\n\tclippedRect[1] = brdfWrtSurface * ( rectPoints[1] - P );\n\tclippedRect[2] = brdfWrtSurface * ( rectPoints[2] - P );\n\tclippedRect[3] = brdfWrtSurface * ( rectPoints[3] - P );\n\tint n;\n\tclipQuadToHorizon(clippedRect, n);\n\tif ( n == 0 )\n\t\treturn vec3( 0, 0, 0 );\n\tclippedRect[0] = normalize( clippedRect[0] );\n\tclippedRect[1] = normalize( clippedRect[1] );\n\tclippedRect[2] = normalize( clippedRect[2] );\n\tclippedRect[3] = normalize( clippedRect[3] );\n\tclippedRect[4] = normalize( clippedRect[4] );\n\tfloat sum = 0.0;\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[0], clippedRect[1] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[1], clippedRect[2] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[2], clippedRect[3] );\n\tif (n >= 4)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[3], clippedRect[4] );\n\tif (n == 5)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[4], clippedRect[0] );\n\tsum = max( 0.0, sum );\n\tvec3 Lo_i = vec3( sum, sum, sum );\n\treturn Lo_i;\n}\nvec3 Rect_Area_Light_Specular_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight,\n\t\tconst in float roughness,\n\t\tconst in sampler2D ltcMat, const in sampler2D ltcMag ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tvec2 uv = ltcTextureCoords( geometry, roughness );\n\tvec4 brdfLtcApproxParams, t;\n\tbrdfLtcApproxParams = texture2D( ltcMat, uv );\n\tt = texture2D( ltcMat, uv );\n\tfloat brdfLtcScalar = texture2D( ltcMag, uv ).a;\n\tmat3 brdfLtcApproxMat = mat3(\n\t\tvec3(   1,   0, t.y ),\n\t\tvec3(   0, t.z,   0 ),\n\t\tvec3( t.w,   0, t.x )\n\t);\n\tvec3 specularReflectance = integrateLtcBrdfOverRect( geometry, brdfLtcApproxMat, rectPoints );\n\tspecularReflectance *= brdfLtcScalar;\n\treturn specularReflectance;\n}\nvec3 Rect_Area_Light_Diffuse_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tmat3 diffuseBrdfMat = mat3(1);\n\tvec3 diffuseReflectance = integrateLtcBrdfOverRect( geometry, diffuseBrdfMat, rectPoints );\n\treturn diffuseReflectance;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",
clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\n#if NUM_RECT_AREA_LIGHTS > 0\n    void RE_Direct_RectArea_BlinnPhong( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n        vec3 matDiffColor = material.diffuseColor;\n        vec3 matSpecColor = material.specularColor;\n        vec3 lightColor   = rectAreaLight.color;\n        float roughness = BlinnExponentToGGXRoughness( material.specularShininess );\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n                roughness,\n                ltcMat, ltcMag );\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec / PI2;\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff / PI2;\n    }\n#endif\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n    void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n        vec3 matDiffColor = material.diffuseColor;\n        vec3 matSpecColor = material.specularColor;\n        vec3 lightColor   = rectAreaLight.color;\n        float roughness = material.specularRoughness;\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n                roughness,\n                ltcMat, ltcMag );\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec;\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff;\n    }\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",
lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#include <premultiplied_alpha_fragment>\n\t#include <encodings_fragment>\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"};H.prototype={constructor:H,isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:.5>n?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,r){return e=ri.euclideanModulo(e,1),n=ri.clamp(n,0,1),r=ri.clamp(r,0,1),0===n?this.r=this.g=this.b=r:(n=.5>=r?r*(1+n):r+n-r*n,r=2*r-n,this.r=t(r,n,e+1/3),this.g=t(r,n,e),this.b=t(r,n,e-1/3)),this}}(),setStyle:function(t){function e(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r=n[2];switch(n[1]){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){var r=parseFloat(n[1])/360,i=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(r,i,o)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){if(n=n[1],r=n.length,3===r)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,this;if(6===r)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,this}return t&&0<t.length&&(n=di[t],void 0!==n?this.setHex(n):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=0<e?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e=this.r,n=this.g,r=this.b,i=Math.max(e,n,r),o=Math.min(e,n,r),a,s=(o+i)/2;if(o===i)o=a=0;else{var c=i-o,o=.5>=s?c/(i+o):c/(2-i-o);switch(i){case e:a=(n-r)/c+(n<r?6:0);break;case n:a=(r-e)/c+2;break;case r:a=(e-n)/c+4}a/=6}return t.h=a,t.s=o,t.l=s,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var r=this.getHSL();return r.h+=t,r.s+=e,r.l+=n,this.setHSL(r.h,r.s,r.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}};var di={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};G.prototype=Object.create(r.prototype),G.prototype.constructor=G,G.prototype.isDataTexture=!0;var pi={common:{diffuse:{value:new H(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new i(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new n(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new H(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new H(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new i(0,0,1,1)}}},fi={basic:{uniforms:ui.merge([pi.common,pi.aomap,pi.lightmap,pi.fog]),vertexShader:hi.meshbasic_vert,fragmentShader:hi.meshbasic_frag},lambert:{uniforms:ui.merge([pi.common,pi.aomap,pi.lightmap,pi.emissivemap,pi.fog,pi.lights,{emissive:{value:new H(0)}}]),vertexShader:hi.meshlambert_vert,fragmentShader:hi.meshlambert_frag},phong:{uniforms:ui.merge([pi.common,pi.aomap,pi.lightmap,pi.emissivemap,pi.bumpmap,pi.normalmap,pi.displacementmap,pi.gradientmap,pi.fog,pi.lights,{emissive:{value:new H(0)},specular:{value:new H(1118481)},shininess:{value:30}}]),vertexShader:hi.meshphong_vert,fragmentShader:hi.meshphong_frag},standard:{uniforms:ui.merge([pi.common,pi.aomap,pi.lightmap,pi.emissivemap,pi.bumpmap,pi.normalmap,pi.displacementmap,pi.roughnessmap,pi.metalnessmap,pi.fog,pi.lights,{emissive:{value:new H(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:hi.meshphysical_vert,fragmentShader:hi.meshphysical_frag},points:{uniforms:ui.merge([pi.points,pi.fog]),vertexShader:hi.points_vert,fragmentShader:hi.points_frag},dashed:{uniforms:ui.merge([pi.common,pi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:hi.linedashed_vert,fragmentShader:hi.linedashed_frag},depth:{uniforms:ui.merge([pi.common,pi.displacementmap]),vertexShader:hi.depth_vert,fragmentShader:hi.depth_frag},normal:{uniforms:ui.merge([pi.common,pi.bumpmap,pi.normalmap,pi.displacementmap,{opacity:{value:1}}]),vertexShader:hi.normal_vert,fragmentShader:hi.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:hi.cube_vert,fragmentShader:hi.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:hi.equirect_vert,fragmentShader:hi.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new c}},vertexShader:hi.distanceRGBA_vert,fragmentShader:hi.distanceRGBA_frag}};fi.physical={uniforms:ui.merge([fi.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:hi.meshphysical_vert,fragmentShader:hi.meshphysical_frag},V.prototype={constructor:V,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new n;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new n).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new n).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new n;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}};var mi=0;q.prototype={constructor:q,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0===n)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else{var r=this[e];void 0===r?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]="overdraw"===e?Number(n):n}}},toJSON:function(t){function e(t){var e=[],n;for(n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var n=void 0===t;n&&(t={textures:{},images:{}});var r={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),2!==this.shading&&(r.shading=this.shading),0!==this.side&&(r.side=this.side),0!==this.vertexColors&&(r.vertexColors=this.vertexColors),1>this.opacity&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0<this.alphaTest&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),1<this.wireframeLinewidth&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),r.skinning=this.skinning,r.morphTargets=this.morphTargets,n&&(n=e(t.textures),t=e(t.images),0<n.length&&(r.textures=n),0<t.length&&(r.images=t)),r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection,t=t.clippingPlanes;var e=null;if(null!==t)for(var n=t.length,e=Array(n),r=0;r!==n;++r)e[r]=t[r].clone();return this.clippingPlanes=e,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(q.prototype,e.prototype),Y.prototype=Object.create(q.prototype),Y.prototype.constructor=Y,Y.prototype.isShaderMaterial=!0,Y.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ui.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Y.prototype.toJSON=function(t){return t=q.prototype.toJSON.call(this,t),t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Z.prototype=Object.create(q.prototype),Z.prototype.constructor=Z,Z.prototype.isMeshDepthMaterial=!0,Z.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},J.prototype={constructor:J,isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-(1/0),o=-(1/0),a=-(1/0),s=0,c=t.length;s<c;s+=3){var l=t[s],u=t[s+1],h=t[s+2];l<e&&(e=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>o&&(o=u),h>a&&(a=h)}this.min.set(e,n,r),this.max.set(i,o,a)},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-(1/0),o=-(1/0),a=-(1/0),s=0,c=t.count;s<c;s++){var l=t.getX(s),u=t.getY(s),h=t.getZ(s);l<e&&(e=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>o&&(o=u),h>a&&(a=h)}this.min.set(e,n,r),this.max.set(i,o,a)},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new c;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(){var t=new c;return function(e){var n=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var r,i;if(r=e.geometry,void 0!==r)if(r.isGeometry){var o=r.vertices;for(r=0,i=o.length;r<i;r++)t.copy(o[r]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}else if(r.isBufferGeometry&&(o=r.attributes.position,void 0!==o))for(r=0,i=o.count;r<i;r++)t.fromAttribute(o,r).applyMatrix4(e.matrixWorld),n.expandByPoint(t)}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t=t||new c,this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new c,this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),
this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new c).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new c),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return 0<t.normal.x?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),0<t.normal.y?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){return(e||new c).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new c;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new c;return function(e){return e=e||new Q,this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new c,new c,new c,new c,new c,new c,new c,new c];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Q.prototype={constructor:Q,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new J;return function(e,n){var r=this.center;void 0!==n?r.copy(n):t.setFromPoints(e).getCenter(r);for(var i=0,o=0,a=e.length;o<a;o++)i=Math.max(i,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),r=e||new c;return r.copy(t),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){return t=t||new J,t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},K.prototype={constructor:K,isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,c){var l=this.elements;return l[0]=t,l[1]=r,l[2]=a,l[3]=e,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){return t=t.elements,this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToVector3Array:function(){var t;return function(e,n,r){void 0===t&&(t=new c),void 0===n&&(n=0),void 0===r&&(r=e.length);for(var i=0;i<r;i+=3,n+=3)t.fromArray(e,n),t.applyMatrix3(this),t.toArray(e,n);return e}}(),applyToBufferAttribute:function(){var t;return function(e){void 0===t&&(t=new c);for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],c=t[7],t=t[8];return e*o*t-e*a*c-n*i*t+n*a*s+r*i*c-r*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7],n=n[8],d=n*c-l*h,p=l*u-n*s,f=h*s-c*u,m=i*d+o*p+a*f;if(0===m){if(!0===e)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return m=1/m,r[0]=d*m,r[1]=(a*h-n*o)*m,r[2]=(l*o-a*c)*m,r[3]=p*m,r[4]=(n*i-a*u)*m,r[5]=(a*s-l*i)*m,r[6]=f*m,r[7]=(o*u-h*i)*m,r[8]=(c*i-o*s)*m,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;9>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}},tt.prototype={constructor:tt,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new c,e=new c;return function(n,r,i){return r=t.subVectors(i,r).cross(e.subVectors(n,r)).normalize(),this.setFromNormalAndCoplanarPoint(r,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t);return(e||new c).copy(this.normal).multiplyScalar(n)},intersectLine:function(){var t=new c;return function(e,n){var r=n||new c,i=e.delta(t),o=this.normal.dot(i);return 0!==o?(o=-(e.start.dot(this.normal)+this.constant)/o,0>o||1<o?void 0:r.copy(i).multiplyScalar(o).add(e.start)):0===this.distanceToPoint(e.start)?r.copy(e.start):void 0}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new c).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new c,e=new K;return function(n,r){var i=this.coplanarPoint(t).applyMatrix4(n),o=r||e.getNormalMatrix(n),o=this.normal.applyMatrix3(o).normalize();return this.constant=-i.dot(o),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},et.prototype={constructor:et,set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;6>n;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements;t=n[0];var r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],c=n[6],l=n[7],u=n[8],h=n[9],d=n[10],p=n[11],f=n[12],m=n[13],g=n[14],n=n[15];return e[0].setComponents(o-t,l-a,p-u,n-f).normalize(),e[1].setComponents(o+t,l+a,p+u,n+f).normalize(),e[2].setComponents(o+r,l+s,p+h,n+m).normalize(),e[3].setComponents(o-r,l-s,p-h,n-m).normalize(),e[4].setComponents(o-i,l-c,p-d,n-g).normalize(),e[5].setComponents(o+i,l+c,p+d,n+g).normalize(),this},intersectsObject:function(){var t=new Q;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new Q;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){var e=this.planes,n=t.center;t=-t.radius;for(var r=0;6>r;r++)if(e[r].distanceToPoint(n)<t)return!1;return!0},intersectsBox:function(){var t=new c,e=new c;return function(n){for(var r=this.planes,i=0;6>i;i++){var o=r[i];t.x=0<o.normal.x?n.min.x:n.max.x,e.x=0<o.normal.x?n.max.x:n.min.x,t.y=0<o.normal.y?n.min.y:n.max.y,e.y=0<o.normal.y?n.max.y:n.min.y,t.z=0<o.normal.z?n.min.z:n.max.z,e.z=0<o.normal.z?n.max.z:n.min.z;var a=o.distanceToPoint(t),o=o.distanceToPoint(e);if(0>a&&0>o)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;6>n;n++)if(0>e[n].distanceToPoint(t))return!1;return!0}},rt.prototype={constructor:rt,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new c).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new c;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new c;n.subVectors(t,this.origin);var r=n.dot(this.direction);return 0>r?n.copy(this.origin):n.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new c;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return 0>n?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new c,e=new c,n=new c;return function(r,i,o,a){t.copy(r).add(i).multiplyScalar(.5),e.copy(i).sub(r).normalize(),n.copy(this.origin).sub(t);var s=.5*r.distanceTo(i),c=-this.direction.dot(e),l=n.dot(this.direction),u=-n.dot(e),h=n.lengthSq(),d=Math.abs(1-c*c),p;return 0<d?(r=c*u-l,i=c*l-u,p=s*d,0<=r?i>=-p?i<=p?(s=1/d,r*=s,i*=s,c=r*(r+c*i+2*l)+i*(c*r+i+2*u)+h):(i=s,r=Math.max(0,-(c*i+l)),c=-r*r+i*(i+2*u)+h):(i=-s,r=Math.max(0,-(c*i+l)),c=-r*r+i*(i+2*u)+h):i<=-p?(r=Math.max(0,-(-c*s+l)),i=0<r?-s:Math.min(Math.max(-s,-u),s),c=-r*r+i*(i+2*u)+h):i<=p?(r=0,i=Math.min(Math.max(-s,-u),s),c=i*(i+2*u)+h):(r=Math.max(0,-(c*s+l)),i=0<r?s:Math.min(Math.max(-s,-u),s),c=-r*r+i*(i+2*u)+h)):(i=0<c?-s:s,r=Math.max(0,-(c*i+l)),c=-r*r+i*(i+2*u)+h),o&&o.copy(this.direction).multiplyScalar(r).add(this.origin),a&&a.copy(e).multiplyScalar(i).add(t),c}}(),intersectSphere:function(){var t=new c;return function(e,n){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),i=t.dot(t)-r*r,o=e.radius*e.radius;return i>o?null:(o=Math.sqrt(o-i),i=r-o,r+=o,0>i&&0>r?null:0>i?this.at(r,n):this.at(i,n))}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/e,0<=t?t:null)},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},intersectBox:function(t,e){var n,r,i,o,a;r=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z;var s=this.origin;return 0<=r?(n=(t.min.x-s.x)*r,r*=t.max.x-s.x):(n=(t.max.x-s.x)*r,r*=t.min.x-s.x),0<=o?(i=(t.min.y-s.y)*o,o*=t.max.y-s.y):(i=(t.max.y-s.y)*o,o*=t.min.y-s.y),n>o||i>r?null:((i>n||n!==n)&&(n=i),(o<r||r!==r)&&(r=o),0<=a?(i=(t.min.z-s.z)*a,a*=t.max.z-s.z):(i=(t.max.z-s.z)*a,a*=t.min.z-s.z),n>a||i>r?null:((i>n||n!==n)&&(n=i),(a<r||r!==r)&&(r=a),0>r?null:this.at(0<=n?n:r,e)))},intersectsBox:function(){var t=new c;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new c,e=new c,n=new c,r=new c;return function(i,o,a,s,c){if(e.subVectors(o,i),n.subVectors(a,i),r.crossVectors(e,n),o=this.direction.dot(r),0<o){if(s)return null;s=1}else{if(!(0>o))return null;s=-1,o=-o}return t.subVectors(this.origin,i),i=s*this.direction.dot(n.crossVectors(t,n)),0>i?null:(a=s*this.direction.dot(e.cross(t)),0>a||i+a>o?null:(i=-s*t.dot(r),0>i?null:this.at(i/o,c)))}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},it.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),it.DefaultOrder="XYZ",it.prototype={constructor:it,isEuler:!0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=ri.clamp,i=t.elements;t=i[0];var o=i[4],a=i[8],s=i[1],c=i[5],l=i[9],u=i[2],h=i[6],i=i[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(r(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-l,i),this._z=Math.atan2(-o,t)):(this._x=Math.atan2(h,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(a,i),this._z=Math.atan2(s,c)):(this._y=Math.atan2(-u,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(h,-1,1)),.99999>Math.abs(h)?(this._y=Math.atan2(-u,i),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(s,t))):"ZYX"===e?(this._y=Math.asin(-r(u,-1,1)),.99999>Math.abs(u)?(this._x=Math.atan2(h,i),this._z=Math.atan2(s,t)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===e?(this._z=Math.asin(r(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-u,t)):(this._x=0,this._y=Math.atan2(a,i))):"XZY"===e?(this._z=Math.asin(-r(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,t)):(this._x=Math.atan2(-l,i),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,n,r){return void 0===t&&(t=new l),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,r)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new s;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new c(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},ot.prototype={constructor:ot,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}};var gi=0;at.DefaultUp=new c(0,1,0),at.DefaultMatrixAutoUpdate=!0,Object.assign(at.prototype,e.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new s;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new c(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new c(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new c(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new c;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new c(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new c(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new c(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new l;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new l;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);e=this.children.indexOf(t),-1!==e&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return t=t||new c,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new c,e=new c;return function(n){return n=n||new s,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new s;return function(e){return e=e||new it,this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new c,e=new s;return function(n){return n=n||new c,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new s;return function(e){return e=e||new c,this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[],n;for(n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var n=void 0===t||""===t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{}},r.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var i={};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),i.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),i.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),i.material=this.material.uuid),0<this.children.length){i.children=[];for(var o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(t).object)}if(n){var n=e(t.geometries),o=e(t.materials),a=e(t.textures);t=e(t.images),0<n.length&&(r.geometries=n),0<o.length&&(r.materials=o),0<a.length&&(r.textures=a),0<t.length&&(r.images=t)}return r.object=i,r},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}),st.prototype={constructor:st,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new c).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new c).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new c;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new c,e=new c;return function(n,r){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var i=e.dot(e),i=e.dot(t)/i;return r&&(i=ri.clamp(i,0,1)),i}}(),closestPointToPoint:function(t,e,n){return t=this.closestPointToPointParameter(t,e),n=n||new c,this.delta(n).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},ct.normal=function(){var t=new c;return function(e,n,r,i){return i=i||new c,i.subVectors(r,n),t.subVectors(e,n),i.cross(t),e=i.lengthSq(),0<e?i.multiplyScalar(1/Math.sqrt(e)):i.set(0,0,0)}}(),ct.barycoordFromPoint=function(){var t=new c,e=new c,n=new c;return function(r,i,o,a,s){t.subVectors(a,i),e.subVectors(o,i),n.subVectors(r,i),r=t.dot(t),i=t.dot(e),o=t.dot(n);var l=e.dot(e);a=e.dot(n);var u=r*l-i*i;return s=s||new c,0===u?s.set(-2,-1,-1):(u=1/u,l=(l*o-i*a)*u,r=(r*a-i*o)*u,s.set(1-l-r,r,l))}}(),ct.containsPoint=function(){var t=new c;return function(e,n,r,i){return e=ct.barycoordFromPoint(e,n,r,i,t),0<=e.x&&0<=e.y&&1>=e.x+e.y}}(),ct.prototype={constructor:ct,set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new c,e=new c;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new c).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return ct.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new tt).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return ct.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return ct.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,n,r;return function(i,o){void 0===t&&(t=new tt,e=[new st,new st,new st],n=new c,r=new c);var a=o||new c,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(i,n),!0===this.containsPoint(n))a.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var l=0;l<e.length;l++){e[l].closestPointToPoint(n,!0,r);var u=n.distanceToSquared(r);u<s&&(s=u,a.copy(r))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},lt.prototype={constructor:lt,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},ut.prototype=Object.create(q.prototype),ut.prototype.constructor=ut,ut.prototype.isMeshBasicMaterial=!0,ut.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},ht.prototype={constructor:ht,isBufferAttribute:!0,set needsUpdate(t){!0===t&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new H),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,r=0,i=0,o=t.length;i<o;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new n),e[r++]=a.x,e[r++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new c),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,o=t.length;r<o;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new i),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return(new this.constructor).copy(this)}},dt.prototype=Object.create(ht.prototype),dt.prototype.constructor=dt,pt.prototype=Object.create(ht.prototype),pt.prototype.constructor=pt,ft.prototype=Object.create(ht.prototype),ft.prototype.constructor=ft,mt.prototype=Object.create(ht.prototype),mt.prototype.constructor=mt,gt.prototype=Object.create(ht.prototype),gt.prototype.constructor=gt,vt.prototype=Object.create(ht.prototype),vt.prototype.constructor=vt,yt.prototype=Object.create(ht.prototype),yt.prototype.constructor=yt,_t.prototype=Object.create(ht.prototype),_t.prototype.constructor=_t,bt.prototype=Object.create(ht.prototype),bt.prototype.constructor=bt,Object.assign(xt.prototype,{computeGroups:function(t){var e,n=[],r=void 0;t=t.faces;for(var i=0;i<t.length;i++){var o=t[i];o.materialIndex!==r&&(r=o.materialIndex,void 0!==e&&(e.count=3*i-e.start,n.push(e)),e={start:3*i,materialIndex:r})}void 0!==e&&(e.count=3*i-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&0<i[0].length,a=i[1]&&0<i[1].length,s=t.morphTargets,c=s.length,l;if(0<c){l=[];for(var u=0;u<c;u++)l[u]=[];this.morphTargets.position=l}var h=t.morphNormals,d=h.length,p;if(0<d){for(p=[],u=0;u<d;u++)p[u]=[];this.morphTargets.normal=p}for(var f=t.skinIndices,m=t.skinWeights,g=f.length===r.length,v=m.length===r.length,u=0;u<e.length;u++){var y=e[u];this.vertices.push(r[y.a],r[y.b],r[y.c]);var _=y.vertexNormals;for(3===_.length?this.normals.push(_[0],_[1],_[2]):(_=y.normal,
this.normals.push(_,_,_)),_=y.vertexColors,3===_.length?this.colors.push(_[0],_[1],_[2]):(_=y.color,this.colors.push(_,_,_)),!0===o&&(_=i[0][u],void 0!==_?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new n,new n,new n))),!0===a&&(_=i[1][u],void 0!==_?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new n,new n,new n))),_=0;_<c;_++){var b=s[_].vertices;l[_].push(b[y.a],b[y.b],b[y.c])}for(_=0;_<d;_++)b=h[_].vertexNormals[u],p[_].push(b.a,b.b,b.c);g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}}),Object.assign(wt.prototype,e.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new K).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(t);for(n=0,r=this.faces.length;n<r;n++){t=this.faces[n],t.normal.applyMatrix3(e).normalize();for(var i=0,o=t.vertexNormals.length;i<o;i++)t.vertexNormals[i].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,r){return void 0===t&&(t=new l),t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,r){return void 0===t&&(t=new l),t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new at),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,n,i){var o=void 0!==s?[d[t].clone(),d[e].clone(),d[n].clone()]:[],a=void 0!==l?[r.colors[t].clone(),r.colors[e].clone(),r.colors[n].clone()]:[];i=new lt(t,e,n,o,a,i),r.faces.push(i),void 0!==u&&r.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[n].clone()]),void 0!==h&&r.faceVertexUvs[1].push([f[t].clone(),f[e].clone(),f[n].clone()])}var r=this,i=null!==t.index?t.index.array:void 0,o=t.attributes,a=o.position.array,s=void 0!==o.normal?o.normal.array:void 0,l=void 0!==o.color?o.color.array:void 0,u=void 0!==o.uv?o.uv.array:void 0,h=void 0!==o.uv2?o.uv2.array:void 0;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var d=[],p=[],f=[],m=o=0;o<a.length;o+=3,m+=2)r.vertices.push(new c(a[o],a[o+1],a[o+2])),void 0!==s&&d.push(new c(s[o],s[o+1],s[o+2])),void 0!==l&&r.colors.push(new H(l[o],l[o+1],l[o+2])),void 0!==u&&p.push(new n(u[m],u[m+1])),void 0!==h&&f.push(new n(h[m],h[m+1]));if(void 0!==i)if(a=t.groups,0<a.length)for(o=0;o<a.length;o++)for(var g=a[o],v=g.start,y=g.count,m=v,v=v+y;m<v;m+=3)e(i[m],i[m+1],i[m+2],g.materialIndex);else for(o=0;o<i.length;o+=3)e(i[o],i[o+1],i[o+2]);else for(o=0;o<a.length/3;o+=3)e(o,o+1,o+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,e=0===e?1:1/e,n=new l;return n.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new c,e=new c,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b];t.subVectors(this.vertices[i.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n,r;for(r=Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)r[e]=new c;if(t){var i,o,a,s=new c,l=new c;for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],i=this.vertices[n.a],o=this.vertices[n.b],a=this.vertices[n.c],s.subVectors(a,o),l.subVectors(i,o),s.cross(l),r[n.a].add(s),r[n.b].add(s),r[n.c].add(s)}else for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++)n=this.faces[t],r[n.a].add(n.normal),r[n.b].add(n.normal),r[n.c].add(n.normal);for(e=0,n=this.vertices.length;e<n;e++)r[e].normalize();for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],i=n.vertexNormals,3===i.length?(i[0].copy(r[n.a]),i[1].copy(r[n.b]),i[2].copy(r[n.c])):(i[0]=r[n.a].clone(),i[1]=r[n.b].clone(),i[2]=r[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){n=this.faces[t];var r=n.vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for(i=this.faces[n],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new wt;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],i=this.morphNormals[t].faceNormals;var a=this.morphNormals[t].vertexNormals,s,l;for(n=0,r=this.faces.length;n<r;n++)s=new c,l={a:new c,b:new c,c:new c},i.push(s),a.push(l)}for(a=this.morphNormals[t],o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],s=a.faceNormals[n],l=a.vertexNormals[n],s.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)i=this.faces[n],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,r=e.length;n<r;n++)0<n&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new J),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Q),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!1===(t&&t.isGeometry))console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);else{var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],u=t.faceVertexUvs[0],h=this.colors,d=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new K).getNormalMatrix(e)),t=0;for(var p=a.length;t<p;t++){var f=a[t].clone();void 0!==e&&f.applyMatrix4(e),o.push(f)}for(t=0,p=d.length;t<p;t++)h.push(d[t].clone());for(t=0,p=c.length;t<p;t++){var a=c[t],m=a.vertexNormals,d=a.vertexColors,h=new lt(a.a+i,a.b+i,a.c+i);for(h.normal.copy(a.normal),void 0!==r&&h.normal.applyMatrix3(r).normalize(),e=0,o=m.length;e<o;e++)f=m[e].clone(),void 0!==r&&f.applyMatrix3(r).normalize(),h.vertexNormals.push(f);for(h.color.copy(a.color),e=0,o=d.length;e<o;e++)f=d[e],h.vertexColors.push(f.clone());h.materialIndex=a.materialIndex+n,s.push(h)}for(t=0,p=u.length;t<p;t++)if(n=u[t],r=[],void 0!==n){for(e=0,o=n.length;e<o;e++)r.push(n[e].clone());l.push(r)}}},mergeMesh:function(t){!1===(t&&t.isMesh)?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t={},e=[],n=[],r,i=Math.pow(10,4),o,a;for(o=0,a=this.vertices.length;o<a;o++)r=this.vertices[o],r=Math.round(r.x*i)+"_"+Math.round(r.y*i)+"_"+Math.round(r.z*i),void 0===t[r]?(t[r]=o,e.push(this.vertices[o]),n[o]=e.length-1):n[o]=n[t[r]];for(t=[],o=0,a=this.faces.length;o<a;o++)for(i=this.faces[o],i.a=n[i.a],i.b=n[i.b],i.c=n[i.c],i=[i.a,i.b,i.c],r=0;3>r;r++)if(i[r]===i[(r+1)%3]){t.push(o);break}for(o=t.length-1;0<=o;o--)for(i=t[o],this.faces.splice(i,1),n=0,a=this.faceVertexUvs.length;n<a;n++)this.faceVertexUvs[n].splice(i,1);return o=this.vertices.length-e.length,this.vertices=e,o},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var r=this.faceVertexUvs[0],i=this.faceVertexUvs[1],o,a;for(r&&r.length===e&&(o=[]),i&&i.length===e&&(a=[]),n=0;n<e;n++){var s=t[n]._id;o&&o.push(r[s]),a&&a.push(i[s])}o&&(this.faceVertexUvs[0]=o),a&&(this.faceVertexUvs[1]=a)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]?l[e]:(l[e]=c.length/3,c.push(t.x,t.y,t.z),l[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]?h[e]:(h[e]=u.length,u.push(t.getHex()),h[e])}function r(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=d.length/2,d.push(t.x,t.y),p[e])}var i={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var o=this.parameters,a;for(a in o)void 0!==o[a]&&(i[a]=o[a]);return i}for(o=[],a=0;a<this.vertices.length;a++){var s=this.vertices[a];o.push(s.x,s.y,s.z)}var s=[],c=[],l={},u=[],h={},d=[],p={};for(a=0;a<this.faces.length;a++){var f=this.faces[a],m=void 0!==this.faceVertexUvs[0][a],g=0<f.normal.length(),v=0<f.vertexNormals.length,y=1!==f.color.r||1!==f.color.g||1!==f.color.b,_=0<f.vertexColors.length,b=0,b=t(b,0,0),b=t(b,1,!0),b=t(b,2,!1),b=t(b,3,m),b=t(b,4,g),b=t(b,5,v),b=t(b,6,y),b=t(b,7,_);s.push(b),s.push(f.a,f.b,f.c),s.push(f.materialIndex),m&&(m=this.faceVertexUvs[0][a],s.push(r(m[0]),r(m[1]),r(m[2]))),g&&s.push(e(f.normal)),v&&(g=f.vertexNormals,s.push(e(g[0]),e(g[1]),e(g[2]))),y&&s.push(n(f.color)),_&&(f=f.vertexColors,s.push(n(f[0]),n(f[1]),n(f[2])))}return i.data={},i.data.vertices=o,i.data.normals=c,0<u.length&&(i.data.colors=u),0<d.length&&(i.data.uvs=[d]),i.data.faces=s,i},clone:function(){return(new wt).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]],this.colors=[];for(var e=t.vertices,n=0,r=e.length;n<r;n++)this.vertices.push(e[n].clone());for(e=t.colors,n=0,r=e.length;n<r;n++)this.colors.push(e[n].clone());for(e=t.faces,n=0,r=e.length;n<r;n++)this.faces.push(e[n].clone());for(n=0,r=t.faceVertexUvs.length;n<r;n++){e=t.faceVertexUvs[n],void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]);for(var i=0,o=e.length;i<o;i++){for(var a=e[i],s=[],c=0,l=a.length;c<l;c++)s.push(a[c].clone());this.faceVertexUvs[n].push(s)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var vi=0;Object.assign(Et.prototype,e.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e,n){if(!1===(e&&e.isBufferAttribute)&&!1===(e&&e.isInterleavedBufferAttribute))console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new ht(e,n));else{if("index"!==t)return this.attributes[t]=e,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)}},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;return void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0),e=this.attributes.normal,void 0!==e&&((new K).getNormalMatrix(t).applyToVector3Array(e.array),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,r){return void 0===t&&(t=new l),t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,r){return void 0===t&&(t=new l),t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new at),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){t=new _t(3*e.vertices.length,3);var n=new _t(3*e.colors.length,3);this.addAttribute("position",t.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new _t(e.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var n=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}return!0===e.verticesNeedUpdate&&(n=this.attributes.position,void 0!==n&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(n=this.attributes.normal,void 0!==n&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(n=this.attributes.color,void 0!==n&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(n=this.attributes.uv,void 0!==n&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!==n&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new xt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);this.addAttribute("position",new ht(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new ht(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new ht(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new ht(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new ht(e,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(e=new(65535<t.vertices.length?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new ht(e,1).copyIndicesArray(t.indices))),this.groups=t.groups;for(var n in t.morphTargets){for(var e=[],r=t.morphTargets[n],i=0,o=r.length;i<o;i++){var a=r[i],s=new _t(3*a.length,3);e.push(s.copyVector3sArray(a))}this.morphAttributes[n]=e}return 0<t.skinIndices.length&&(n=new _t(4*t.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new _t(4*t.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new J);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new J,e=new c;return function(){null===this.boundingSphere&&(this.boundingSphere=new Q);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(r);for(var i=0,o=0,a=n.count;o<a;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),i=Math.max(i,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new ht(new Float32Array(r.length),3));else for(var i=e.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var i=e.normal.array,s,l,u,h=new c,d=new c,p=new c,f=new c,m=new c;if(t){t=t.array,0===n.length&&this.addGroup(0,t.length);for(var g=0,v=n.length;g<v;++g)for(o=n[g],a=o.start,s=o.count,o=a,a+=s;o<a;o+=3)s=3*t[o+0],l=3*t[o+1],u=3*t[o+2],h.fromArray(r,s),d.fromArray(r,l),p.fromArray(r,u),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),i[s]+=f.x,i[s+1]+=f.y,i[s+2]+=f.z,i[l]+=f.x,i[l+1]+=f.y,i[l+2]+=f.z,i[u]+=f.x,i[u+1]+=f.y,i[u+2]+=f.z}else for(o=0,a=r.length;o<a;o+=9)h.fromArray(r,o),d.fromArray(r,o+3),p.fromArray(r,o+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),i[o]=f.x,i[o+1]=f.y,i[o+2]=f.z,i[o+3]=f.x,i[o+4]=f.y,i[o+5]=f.z,i[o+6]=f.x,i[o+7]=f.y,i[o+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(!1!==(t&&t.isBufferGeometry)){void 0===e&&(e=0);var n=this.attributes,r;for(r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=0,o=o.itemSize*e;s<a.length;s++,o++)i[o]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal.array,e,n,r,i=0,o=t.length;i<o;i+=3)e=t[i],n=t[i+1],r=t[i+2],e=1/Math.sqrt(e*e+n*n+r*r),t[i]*=e,t[i+1]*=e,t[i+2]*=e},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Et,e=this.index.array,n=this.attributes,r;for(r in n){for(var i=n[r],o=i.array,i=i.itemSize,a=new o.constructor(e.length*i),s,c=0,l=0,u=e.length;l<u;l++){s=e[l]*i;for(var h=0;h<i;h++)a[c++]=o[s++]}t.addAttribute(r,new ht(a,i))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters,n;for(n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(e=Array.prototype.slice.call(r.array),t.data.index={type:r.array.constructor.name,array:e}),r=this.attributes;for(n in r){var i=r[n],e=Array.prototype.slice.call(i.array);t.data.attributes[n]={itemSize:i.itemSize,type:i.array.constructor.name,array:e,normalized:i.normalized}}return n=this.groups,0<n.length&&(t.data.groups=JSON.parse(JSON.stringify(n))),n=this.boundingSphere,null!==n&&(t.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),t},clone:function(){return(new Et).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var e=t.attributes,n;for(n in e)this.addAttribute(n,e[n].clone());for(t=t.groups,n=0,e=t.length;n<e;n++){var r=t[n];this.addGroup(r.start,r.count,r.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Et.MaxIndex=65535,Mt.prototype=Object.assign(Object.create(at.prototype),{constructor:Mt,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return at.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t=this.geometry.morphTargets;if(void 0!==t&&0<t.length){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,n=t.length;e<n;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[t[e].name]=e}},raycast:function(){function t(t,e,n,r,i,o,a){return ct.barycoordFromPoint(t,e,n,r,y),i.multiplyScalar(y.x),o.multiplyScalar(y.y),a.multiplyScalar(y.z),i.add(o).add(a),i.clone()}function e(t,e,n,r,i,o,a){var s=t.material;return null===(1===s.side?n.intersectTriangle(o,i,r,!0,a):n.intersectTriangle(r,i,o,2!==s.side,a))?null:(b.copy(a),b.applyMatrix4(t.matrixWorld),n=e.ray.origin.distanceTo(b),n<e.near||n>e.far?null:{distance:n,point:b.clone(),object:t})}function r(n,r,i,o,a,c,l,d){return s.fromArray(o,3*c),u.fromArray(o,3*l),h.fromArray(o,3*d),(n=e(n,r,i,s,u,h,_))&&(a&&(m.fromArray(a,2*c),g.fromArray(a,2*l),v.fromArray(a,2*d),n.uv=t(_,s,u,h,m,g,v)),n.face=new lt(c,l,d,ct.normal(s,u,h)),n.faceIndex=c),n}var i=new l,o=new rt,a=new Q,s=new c,u=new c,h=new c,d=new c,p=new c,f=new c,m=new n,g=new n,v=new n,y=new c,_=new c,b=new c;return function(n,c){var l=this.geometry,y=this.material,b=this.matrixWorld;if(void 0!==y&&(null===l.boundingSphere&&l.computeBoundingSphere(),a.copy(l.boundingSphere),a.applyMatrix4(b),!1!==n.ray.intersectsSphere(a)&&(i.getInverse(b),o.copy(n.ray).applyMatrix4(i),null===l.boundingBox||!1!==o.intersectsBox(l.boundingBox)))){var x,w;if(l.isBufferGeometry){var E,M,y=l.index,b=l.attributes,l=b.position.array;if(void 0!==b.uv&&(x=b.uv.array),null!==y)for(var b=y.array,T=0,S=b.length;T<S;T+=3)y=b[T],E=b[T+1],M=b[T+2],(w=r(this,n,o,l,x,y,E,M))&&(w.faceIndex=Math.floor(T/3),c.push(w));else for(T=0,S=l.length;T<S;T+=9)y=T/3,E=y+1,M=y+2,(w=r(this,n,o,l,x,y,E,M))&&(w.index=y,c.push(w))}else if(l.isGeometry){var A,L,b=y&&y.isMultiMaterial,T=!0===b?y.materials:null,S=l.vertices;E=l.faces,M=l.faceVertexUvs[0],0<M.length&&(x=M);for(var R=0,C=E.length;R<C;R++){var P=E[R];if(w=!0===b?T[P.materialIndex]:y,void 0!==w){if(M=S[P.a],A=S[P.b],L=S[P.c],!0===w.morphTargets){w=l.morphTargets;var O=this.morphTargetInfluences;s.set(0,0,0),u.set(0,0,0),h.set(0,0,0);for(var N=0,I=w.length;N<I;N++){var D=O[N];if(0!==D){var U=w[N].vertices;s.addScaledVector(d.subVectors(U[P.a],M),D),u.addScaledVector(p.subVectors(U[P.b],A),D),h.addScaledVector(f.subVectors(U[P.c],L),D)}}s.add(M),u.add(A),h.add(L),M=s,A=u,L=h}(w=e(this,n,o,M,A,L,_))&&(x&&(O=x[R],m.copy(O[0]),g.copy(O[1]),v.copy(O[2]),w.uv=t(_,M,A,L,m,g,v)),w.face=P,w.faceIndex=R,c.push(w))}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Tt.prototype=Object.create(Et.prototype),Tt.prototype.constructor=Tt,St.prototype=Object.create(Et.prototype),St.prototype.constructor=St,At.prototype=Object.create(at.prototype),At.prototype.constructor=At,At.prototype.isCamera=!0,At.prototype.getWorldDirection=function(){var t=new s;return function(e){return e=e||new c,this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),At.prototype.lookAt=function(){var t=new l;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),At.prototype.clone=function(){return(new this.constructor).copy(this)},At.prototype.copy=function(t){return at.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},Lt.prototype=Object.assign(Object.create(At.prototype),{constructor:Lt,isPerspectiveCamera:!0,copy:function(t){return At.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*ri.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*ri.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*ri.RAD2DEG*Math.atan(Math.tan(.5*ri.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:r,width:i,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*ri.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==o)var a=o.fullWidth,s=o.fullHeight,i=i+o.offsetX*r/a,e=e-o.offsetY*n/s,r=o.width/a*r,n=o.height/s*n;o=this.filmOffset,0!==o&&(i+=t*o/this.getFilmWidth()),this.projectionMatrix.makeFrustum(i,i+r,e-n,e,t,this.far)},toJSON:function(t){return t=at.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Rt.prototype=Object.assign(Object.create(At.prototype),{constructor:Rt,isOrthographicCamera:!0,copy:function(t){return At.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:r,width:i,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,n=n+t,t=r+e,e=r-e;if(null!==this.view)var n=this.zoom/(this.view.width/this.view.fullWidth),e=this.zoom/(this.view.height/this.view.fullHeight),o=(this.right-this.left)/this.view.width,r=(this.top-this.bottom)/this.view.height,i=i+this.view.offsetX/n*o,n=i+this.view.width/n*o,t=t-this.view.offsetY/e*r,e=t-this.view.height/e*r;this.projectionMatrix.makeOrthographic(i,n,t,e,this.near,this.far)},toJSON:function(t){return t=at.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}});var yi=0;ne.prototype.isFogExp2=!0,ne.prototype.clone=function(){return new ne(this.color.getHex(),this.density)},ne.prototype.toJSON=function(t){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},re.prototype.isFog=!0,re.prototype.clone=function(){return new re(this.color.getHex(),this.near,this.far)},re.prototype.toJSON=function(t){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ie.prototype=Object.create(at.prototype),ie.prototype.constructor=ie,ie.prototype.copy=function(t,e){return at.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},ie.prototype.toJSON=function(t){var e=at.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},oe.prototype=Object.assign(Object.create(at.prototype),{constructor:oe,isLensFlare:!0,copy:function(t){at.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,n,r,i,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===i&&(i=new H(16777215)),void 0===r&&(r=1),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:i,blending:r})},updateLensFlares:function(){var t,e=this.lensFlares.length,n,r=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(t=0;t<e;t++)n=this.lensFlares[t],n.x=this.positionScreen.x+r*n.distance,n.y=this.positionScreen.y+i*n.distance,n.wantedRotation=n.x*Math.PI*.25,n.rotation+=.25*(n.wantedRotation-n.rotation)}}),ae.prototype=Object.create(q.prototype),ae.prototype.constructor=ae,ae.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},se.prototype=Object.assign(Object.create(at.prototype),{constructor:se,isSprite:!0,raycast:function(){var t=new c;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.distanceSqToPoint(t);r>this.scale.x*this.scale.y/4||n.push({distance:Math.sqrt(r),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),ce.prototype=Object.assign(Object.create(at.prototype),{constructor:ce,copy:function(t){at.prototype.copy.call(this,t,!1),t=t.levels;for(var e=0,n=t.length;e<n;e++){var r=t[e];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);n.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new c;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(t);this.getObjectForDistance(r).raycast(e,n)}}(),update:function(){var t=new c,e=new c;return function(n){var r=this.levels;if(1<r.length){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),n=t.distanceTo(e),r[0].object.visible=!0;for(var i=1,o=r.length;i<o&&n>=r[i].distance;i++)r[i-1].object.visible=!1,r[i].object.visible=!0;for(;i<o;i++)r[i].object.visible=!1}}}(),toJSON:function(t){t=at.prototype.toJSON.call(this,t),t.object.levels=[];for(var e=this.levels,n=0,r=e.length;n<r;n++){var i=e[n];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}),Object.assign(le.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new l;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var t,e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),
t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new l;return function(){for(var e=0,n=this.bones.length;e<n;e++)t.multiplyMatrices(this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix,this.boneInverses[e]),t.toArray(this.boneMatrices,16*e);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new le(this.bones,this.boneInverses,this.useVertexTexture)}}),ue.prototype=Object.assign(Object.create(at.prototype),{constructor:ue,isBone:!0}),he.prototype=Object.assign(Object.create(Mt.prototype),{constructor:he,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],n=1/e.lengthManhattan();1/0!==n?e.multiplyScalar(n):e.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry)for(var e=new i,r=this.geometry.attributes.skinWeight,t=0;t<r.count;t++)e.x=r.getX(t),e.y=r.getY(t),e.z=r.getZ(t),e.w=r.getW(t),n=1/e.lengthManhattan(),1/0!==n?e.multiplyScalar(n):e.set(1,0,0,0),r.setXYZW(t,e.x,e.y,e.z,e.w)},updateMatrixWorld:function(t){Mt.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),de.prototype=Object.create(q.prototype),de.prototype.constructor=de,de.prototype.isLineBasicMaterial=!0,de.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},pe.prototype=Object.assign(Object.create(at.prototype),{constructor:pe,isLine:!0,raycast:function(){var t=new l,e=new rt,n=new Q;return function(r,i){var o=r.linePrecision,o=o*o,a=this.geometry,s=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),!1!==r.ray.intersectsSphere(n)){t.getInverse(s),e.copy(r.ray).applyMatrix4(t);var l=new c,u=new c,s=new c,h=new c,d=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var p=a.index,f=a.attributes.position.array;if(null!==p)for(var p=p.array,a=0,m=p.length-1;a<m;a+=d){var g=p[a+1];l.fromArray(f,3*p[a]),u.fromArray(f,3*g),g=e.distanceSqToSegment(l,u,h,s),g>o||(h.applyMatrix4(this.matrixWorld),g=r.ray.origin.distanceTo(h),g<r.near||g>r.far||i.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}else for(a=0,m=f.length/3-1;a<m;a+=d)l.fromArray(f,3*a),u.fromArray(f,3*a+3),g=e.distanceSqToSegment(l,u,h,s),g>o||(h.applyMatrix4(this.matrixWorld),g=r.ray.origin.distanceTo(h),g<r.near||g>r.far||i.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}else if(a.isGeometry)for(l=a.vertices,u=l.length,a=0;a<u-1;a+=d)g=e.distanceSqToSegment(l[a],l[a+1],h,s),g>o||(h.applyMatrix4(this.matrixWorld),g=r.ray.origin.distanceTo(h),g<r.near||g>r.far||i.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),fe.prototype=Object.assign(Object.create(pe.prototype),{constructor:fe,isLineSegments:!0}),me.prototype=Object.create(q.prototype),me.prototype.constructor=me,me.prototype.isPointsMaterial=!0,me.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},ge.prototype=Object.assign(Object.create(at.prototype),{constructor:ge,isPoints:!0,raycast:function(){var t=new l,e=new rt,n=new Q;return function(r,i){function o(t,n){var o=e.distanceSqToPoint(t);if(o<h){var s=e.closestPointToPoint(t);s.applyMatrix4(l);var c=r.ray.origin.distanceTo(s);c<r.near||c>r.far||i.push({distance:c,distanceToRay:Math.sqrt(o),point:s.clone(),index:n,face:null,object:a})}}var a=this,s=this.geometry,l=this.matrixWorld,u=r.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(l),!1!==r.ray.intersectsSphere(n)){t.getInverse(l),e.copy(r.ray).applyMatrix4(t);var u=u/((this.scale.x+this.scale.y+this.scale.z)/3),h=u*u,u=new c;if(s.isBufferGeometry){var d=s.index,s=s.attributes.position.array;if(null!==d)for(var p=d.array,d=0,f=p.length;d<f;d++){var m=p[d];u.fromArray(s,3*m),o(u,m)}else for(d=0,p=s.length/3;d<p;d++)u.fromArray(s,3*d),o(u,d)}else for(u=s.vertices,d=0,p=u.length;d<p;d++)o(u[d],d)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ve.prototype=Object.assign(Object.create(at.prototype),{constructor:ve}),ye.prototype=Object.create(r.prototype),ye.prototype.constructor=ye,_e.prototype=Object.create(r.prototype),_e.prototype.constructor=_e,_e.prototype.isCompressedTexture=!0,be.prototype=Object.create(r.prototype),be.prototype.constructor=be,xe.prototype=Object.create(r.prototype),xe.prototype.constructor=xe,xe.prototype.isDepthTexture=!0,we.prototype=Object.create(Et.prototype),we.prototype.constructor=we,Ee.prototype=Object.create(Et.prototype),Ee.prototype.constructor=Ee,Me.prototype=Object.create(wt.prototype),Me.prototype.constructor=Me,Te.prototype=Object.create(Et.prototype),Te.prototype.constructor=Te,Se.prototype=Object.create(Te.prototype),Se.prototype.constructor=Se,Ae.prototype=Object.create(wt.prototype),Ae.prototype.constructor=Ae,Le.prototype=Object.create(Te.prototype),Le.prototype.constructor=Le,Re.prototype=Object.create(wt.prototype),Re.prototype.constructor=Re,Ce.prototype=Object.create(Te.prototype),Ce.prototype.constructor=Ce,Pe.prototype=Object.create(wt.prototype),Pe.prototype.constructor=Pe,Oe.prototype=Object.create(Te.prototype),Oe.prototype.constructor=Oe,Ne.prototype=Object.create(wt.prototype),Ne.prototype.constructor=Ne,Ie.prototype=Object.create(wt.prototype),Ie.prototype.constructor=Ie,De.prototype=Object.create(Et.prototype),De.prototype.constructor=De,Ue.prototype=Object.create(wt.prototype),Ue.prototype.constructor=Ue,Fe.prototype=Object.create(Et.prototype),Fe.prototype.constructor=Fe,Be.prototype=Object.create(wt.prototype),Be.prototype.constructor=Be,ze.prototype=Object.create(Et.prototype),ze.prototype.constructor=ze,ke.prototype=Object.create(wt.prototype),ke.prototype.constructor=ke;var _i={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},triangulate:function(){return function(t,e){var n=t.length;if(3>n)return null;var r=[],i=[],o=[],a,s,c;if(0<_i.area(t))for(s=0;s<n;s++)i[s]=s;else for(s=0;s<n;s++)i[s]=n-1-s;var l=2*n;for(s=n-1;2<n;){if(0>=l--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}a=s,n<=a&&(a=0),s=a+1,n<=s&&(s=0),c=s+1,n<=c&&(c=0);var u;t:{var h,d,p,f,m,g,v,y;if(h=t[i[a]].x,d=t[i[a]].y,p=t[i[s]].x,f=t[i[s]].y,m=t[i[c]].x,g=t[i[c]].y,0>=(p-h)*(g-d)-(f-d)*(m-h))u=!1;else{var _,b,x,w,E,M,T,S,A,L;for(_=m-p,b=g-f,x=h-m,w=d-g,E=p-h,M=f-d,u=0;u<n;u++)if(v=t[i[u]].x,y=t[i[u]].y,!(v===h&&y===d||v===p&&y===f||v===m&&y===g)&&(T=v-h,S=y-d,A=v-p,L=y-f,v-=m,y-=g,A=_*L-b*A,T=E*S-M*T,S=x*y-w*v,A>=-Number.EPSILON&&S>=-Number.EPSILON&&T>=-Number.EPSILON)){u=!1;break t}u=!0}}if(u){for(r.push([t[i[a]],t[i[s]],t[i[c]]]),o.push([i[a],i[s],i[c]]),a=s,c=s+1;c<n;a++,c++)i[a]=i[c];n--,l=2*n}}return e?o:r}}(),triangulateShape:function(t,e){function n(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function r(t,e,n){return t.x!==e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function i(t,e,n,i,o){var a=e.x-t.x,s=e.y-t.y,c=i.x-n.x,l=i.y-n.y,u=t.x-n.x,h=t.y-n.y,d=s*c-a*l,p=s*u-a*h;if(Math.abs(d)>Number.EPSILON){if(0<d){if(0>p||p>d)return[];if(c=l*u-c*h,0>c||c>d)return[]}else{if(0<p||p<d)return[];if(c=l*u-c*h,0<c||c<d)return[]}return 0===c?!o||0!==p&&p!==d?[t]:[]:c===d?!o||0!==p&&p!==d?[e]:[]:0===p?[n]:p===d?[i]:(o=c/d,[{x:t.x+o*a,y:t.y+o*s}])}return 0!==p||l*u!==c*h?[]:(s=0===a&&0===s,c=0===c&&0===l,s&&c?t.x!==n.x||t.y!==n.y?[]:[t]:s?r(n,i,t)?[t]:[]:c?r(t,e,n)?[n]:[]:(0!==a?(t.x<e.x?(a=t,c=t.x,s=e,t=e.x):(a=e,c=e.x,s=t,t=t.x),n.x<i.x?(e=n,d=n.x,l=i,n=i.x):(e=i,d=i.x,l=n,n=n.x)):(t.y<e.y?(a=t,c=t.y,s=e,t=e.y):(a=e,c=e.y,s=t,t=t.y),n.y<i.y?(e=n,d=n.y,l=i,n=i.y):(e=i,d=i.y,l=n,n=n.y)),c<=d?t<d?[]:t===d?o?[]:[e]:t<=n?[e,s]:[e,l]:c>n?[]:c===n?o?[]:[a]:t<=n?[a,s]:[a,l]))}function o(t,e,n,r){var i=e.x-t.x,o=e.y-t.y;e=n.x-t.x,n=n.y-t.y;var a=r.x-t.x;return r=r.y-t.y,t=i*n-o*e,i=i*r-o*a,Math.abs(t)>Number.EPSILON?(e=a*n-r*e,0<t?0<=i&&0<=e:0<=i||0<=e):0<i}n(t),e.forEach(n);var a,s,c,l,u,h={};for(c=t.concat(),a=0,s=e.length;a<s;a++)Array.prototype.push.apply(c,e[a]);for(a=0,s=c.length;a<s;a++)u=c[a].x+":"+c[a].y,void 0!==h[u]&&console.warn("THREE.ShapeUtils: Duplicate point",u,a),h[u]=a;a=function(t,e){function n(t,e){var n=s.length-1,r=t-1;0>r&&(r=n);var i=t+1;return i>n&&(i=0),!!(n=o(s[t],s[r],s[i],c[e]))&&(n=c.length-1,r=e-1,0>r&&(r=n),i=e+1,i>n&&(i=0),!!(n=o(c[e],c[r],c[i],s[t])))}function r(t,e){var n,r;for(n=0;n<s.length;n++)if(r=n+1,r%=s.length,r=i(t,e,s[n],s[r],!0),0<r.length)return!0;return!1}function a(t,n){var r,o,a,s;for(r=0;r<l.length;r++)for(o=e[l[r]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,s=i(t,n,o[a],o[s],!0),0<s.length)return!0;return!1}var s=t.concat(),c,l=[],u,h,d,p,f,m=[],g,v,y,_=0;for(u=e.length;_<u;_++)l.push(_);g=0;for(var b=2*l.length;0<l.length;){if(b--,0>b){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(h=g;h<s.length;h++){for(d=s[h],u=-1,_=0;_<l.length;_++)if(p=l[_],f=d.x+":"+d.y+":"+p,void 0===m[f]){for(c=e[p],v=0;v<c.length;v++)if(p=c[v],n(h,v)&&!r(d,p)&&!a(d,p)){u=v,l.splice(_,1),g=s.slice(0,h+1),p=s.slice(h),v=c.slice(u),y=c.slice(0,u+1),s=g.concat(v).concat(y).concat(p),g=h;break}if(0<=u)break;m[f]=!0}if(0<=u)break}}return s}(t,e);var d=_i.triangulate(a,!1);for(a=0,s=d.length;a<s;a++)for(l=d[a],c=0;3>c;c++)u=l[c].x+":"+l[c].y,u=h[u],void 0!==u&&(l[c]=u);return d.concat()},isClockWise:function(t){return 0>_i.area(t)},b2:function(){return function(t,e,n,r){var i=1-t;return i*i*e+2*(1-t)*t*n+t*t*r}}(),b3:function(){return function(t,e,n,r,i){var o=1-t,a=1-t;return o*o*o*e+3*a*a*t*n+3*(1-t)*t*t*r+t*t*t*i}}()};je.prototype=Object.create(wt.prototype),je.prototype.constructor=je,je.prototype.addShapeList=function(t,e){for(var n=t.length,r=0;r<n;r++)this.addShape(t[r],e)},je.prototype.addShape=function(t,e){function r(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function i(t,e,r){var i,o,a;o=t.x-e.x,a=t.y-e.y,i=r.x-t.x;var s=r.y-t.y,c=o*o+a*a;if(Math.abs(o*s-a*i)>Number.EPSILON){var l=Math.sqrt(c),u=Math.sqrt(i*i+s*s),c=e.x-a/l;if(e=e.y+o/l,s=((r.x-s/u-c)*s-(r.y+i/u-e)*i)/(o*s-a*i),i=c+o*s-t.x,o=e+a*s-t.y,a=i*i+o*o,2>=a)return new n(i,o);a=Math.sqrt(a/2)}else t=!1,o>Number.EPSILON?i>Number.EPSILON&&(t=!0):o<-Number.EPSILON?i<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(s)&&(t=!0),t?(i=-a,a=Math.sqrt(c)):(i=o,o=a,a=Math.sqrt(c/2));return new n(i/a,o/a)}function o(t,e){var n,r;for(k=t.length;0<=--k;){n=k,r=k-1,0>r&&(r=t.length-1);var i,o=m+2*d;for(i=0;i<o;i++){var a=F*i,s=F*(i+1),c=e+n+a,a=e+r+a,l=e+r+s,s=e+n+s,c=c+L,a=a+L,l=l+L,s=s+L;A.faces.push(new lt(c,a,s,null,null,1)),A.faces.push(new lt(a,l,s,null,null,1)),c=_.generateSideWallUV(A,c,a,l,s),A.faceVertexUvs[0].push([c[0],c[1],c[3]]),A.faceVertexUvs[0].push([c[1],c[2],c[3]])}}}function a(t,e,n){A.vertices.push(new c(t,e,n))}function s(t,e,n){t+=L,e+=L,n+=L,A.faces.push(new lt(t,e,n,null,null,0)),t=_.generateTopUV(A,t,e,n),A.faceVertexUvs[0].push(t)}var l=void 0!==e.amount?e.amount:100,u=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:u-2,d=void 0!==e.bevelSegments?e.bevelSegments:3,p=void 0===e.bevelEnabled||e.bevelEnabled,f=void 0!==e.curveSegments?e.curveSegments:12,m=void 0!==e.steps?e.steps:1,g=e.extrudePath,v,y=!1,_=void 0!==e.UVGenerator?e.UVGenerator:je.WorldUVGenerator,b,x,w,E;g&&(v=g.getSpacedPoints(m),y=!0,p=!1,b=void 0!==e.frames?e.frames:g.computeFrenetFrames(m,!1),x=new c,w=new c,E=new c),p||(h=u=d=0);var M,T,S,A=this,L=this.vertices.length,g=t.extractPoints(f),f=g.shape,R=g.holes;if(g=!_i.isClockWise(f)){for(f=f.reverse(),T=0,S=R.length;T<S;T++)M=R[T],_i.isClockWise(M)&&(R[T]=M.reverse());g=!1}var C=_i.triangulateShape(f,R),P=f;for(T=0,S=R.length;T<S;T++)M=R[T],f=f.concat(M);var O,N,I,D,U,F=f.length,B,z=C.length,g=[],k=0;for(I=P.length,O=I-1,N=k+1;k<I;k++,O++,N++)O===I&&(O=0),N===I&&(N=0),g[k]=i(P[k],P[O],P[N]);var j=[],H,G=g.concat();for(T=0,S=R.length;T<S;T++){for(M=R[T],H=[],k=0,I=M.length,O=I-1,N=k+1;k<I;k++,O++,N++)O===I&&(O=0),N===I&&(N=0),H[k]=i(M[k],M[O],M[N]);j.push(H),G=G.concat(H)}for(O=0;O<d;O++){for(I=O/d,D=u*Math.cos(I*Math.PI/2),N=h*Math.sin(I*Math.PI/2),k=0,I=P.length;k<I;k++)U=r(P[k],g[k],N),a(U.x,U.y,-D);for(T=0,S=R.length;T<S;T++)for(M=R[T],H=j[T],k=0,I=M.length;k<I;k++)U=r(M[k],H[k],N),a(U.x,U.y,-D)}for(N=h,k=0;k<F;k++)U=p?r(f[k],G[k],N):f[k],y?(w.copy(b.normals[0]).multiplyScalar(U.x),x.copy(b.binormals[0]).multiplyScalar(U.y),E.copy(v[0]).add(w).add(x),a(E.x,E.y,E.z)):a(U.x,U.y,0);for(I=1;I<=m;I++)for(k=0;k<F;k++)U=p?r(f[k],G[k],N):f[k],y?(w.copy(b.normals[I]).multiplyScalar(U.x),x.copy(b.binormals[I]).multiplyScalar(U.y),E.copy(v[I]).add(w).add(x),a(E.x,E.y,E.z)):a(U.x,U.y,l/m*I);for(O=d-1;0<=O;O--){for(I=O/d,D=u*Math.cos(I*Math.PI/2),N=h*Math.sin(I*Math.PI/2),k=0,I=P.length;k<I;k++)U=r(P[k],g[k],N),a(U.x,U.y,l+D);for(T=0,S=R.length;T<S;T++)for(M=R[T],H=j[T],k=0,I=M.length;k<I;k++)U=r(M[k],H[k],N),y?a(U.x,U.y+v[m-1].y,v[m-1].x+D):a(U.x,U.y,l+D)}!function(){if(p){var t=0*F;for(k=0;k<z;k++)B=C[k],s(B[2]+t,B[1]+t,B[0]+t);for(t=F*(m+2*d),k=0;k<z;k++)B=C[k],s(B[0]+t,B[1]+t,B[2]+t)}else{for(k=0;k<z;k++)B=C[k],s(B[2],B[1],B[0]);for(k=0;k<z;k++)B=C[k],s(B[0]+F*m,B[1]+F*m,B[2]+F*m)}}(),function(){var t=0;for(o(P,t),t+=P.length,T=0,S=R.length;T<S;T++)M=R[T],o(M,t),t+=M.length}()},je.WorldUVGenerator={generateTopUV:function(t,e,r,i){return t=t.vertices,e=t[e],r=t[r],i=t[i],[new n(e.x,e.y),new n(r.x,r.y),new n(i.x,i.y)]},generateSideWallUV:function(t,e,r,i,o){return t=t.vertices,e=t[e],r=t[r],i=t[i],o=t[o],.01>Math.abs(e.y-r.y)?[new n(e.x,1-e.z),new n(r.x,1-r.z),new n(i.x,1-i.z),new n(o.x,1-o.z)]:[new n(e.y,1-e.z),new n(r.y,1-r.z),new n(i.y,1-i.z),new n(o.y,1-o.z)]}},He.prototype=Object.create(je.prototype),He.prototype.constructor=He,Ge.prototype=Object.create(Et.prototype),Ge.prototype.constructor=Ge,Ve.prototype=Object.create(wt.prototype),Ve.prototype.constructor=Ve,We.prototype=Object.create(Et.prototype),We.prototype.constructor=We,Xe.prototype=Object.create(wt.prototype),Xe.prototype.constructor=Xe,qe.prototype=Object.create(wt.prototype),qe.prototype.constructor=qe,Ye.prototype=Object.create(Et.prototype),Ye.prototype.constructor=Ye,Ze.prototype=Object.create(wt.prototype),Ze.prototype.constructor=Ze,Je.prototype=Object.create(Et.prototype),Je.prototype.constructor=Je,$e.prototype=Object.create(wt.prototype),$e.prototype.constructor=$e,Qe.prototype=Object.create(Et.prototype),Qe.prototype.constructor=Qe,Ke.prototype=Object.create(Et.prototype),Ke.prototype.constructor=Ke,tn.prototype=Object.create(wt.prototype),tn.prototype.constructor=tn,en.prototype=Object.create(tn.prototype),en.prototype.constructor=en,nn.prototype=Object.create(Ke.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create(Et.prototype),rn.prototype.constructor=rn,on.prototype=Object.create(wt.prototype),on.prototype.constructor=on,an.prototype=Object.create(wt.prototype),an.prototype.constructor=an;var bi=Object.freeze({WireframeGeometry:we,ParametricGeometry:Me,ParametricBufferGeometry:Ee,TetrahedronGeometry:Ae,TetrahedronBufferGeometry:Se,OctahedronGeometry:Re,OctahedronBufferGeometry:Le,IcosahedronGeometry:Pe,IcosahedronBufferGeometry:Ce,DodecahedronGeometry:Ne,DodecahedronBufferGeometry:Oe,PolyhedronGeometry:Ie,PolyhedronBufferGeometry:Te,TubeGeometry:Ue,TubeBufferGeometry:De,TorusKnotGeometry:Be,TorusKnotBufferGeometry:Fe,TorusGeometry:ke,TorusBufferGeometry:ze,TextGeometry:He,SphereBufferGeometry:Ge,SphereGeometry:Ve,RingGeometry:Xe,RingBufferGeometry:We,PlaneBufferGeometry:St,PlaneGeometry:qe,LatheGeometry:Ze,LatheBufferGeometry:Ye,ShapeGeometry:$e,ShapeBufferGeometry:Je,ExtrudeGeometry:je,EdgesGeometry:Qe,ConeGeometry:en,ConeBufferGeometry:nn,CylinderGeometry:tn,CylinderBufferGeometry:Ke,CircleBufferGeometry:rn,CircleGeometry:on,BoxBufferGeometry:Tt,BoxGeometry:an});sn.prototype=Object.create(Y.prototype),sn.prototype.constructor=sn,sn.prototype.isShadowMaterial=!0,cn.prototype=Object.create(Y.prototype),cn.prototype.constructor=cn,cn.prototype.isRawShaderMaterial=!0,ln.prototype={constructor:ln,isMultiMaterial:!0,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},n=this.materials,r=0,i=n.length;r<i;r++){var o=n[r].toJSON(t);delete o.metadata,e.materials.push(o)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},un.prototype=Object.create(q.prototype),un.prototype.constructor=un,un.prototype.isMeshStandardMaterial=!0,un.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},hn.prototype=Object.create(un.prototype),hn.prototype.constructor=hn,hn.prototype.isMeshPhysicalMaterial=!0,hn.prototype.copy=function(t){return un.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},dn.prototype=Object.create(q.prototype),dn.prototype.constructor=dn,dn.prototype.isMeshPhongMaterial=!0,dn.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},pn.prototype=Object.create(dn.prototype),pn.prototype.constructor=pn,pn.prototype.isMeshToonMaterial=!0,pn.prototype.copy=function(t){return dn.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},fn.prototype=Object.create(q.prototype),fn.prototype.constructor=fn,fn.prototype.isMeshNormalMaterial=!0,fn.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},mn.prototype=Object.create(q.prototype),mn.prototype.constructor=mn,mn.prototype.isMeshLambertMaterial=!0,mn.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},gn.prototype=Object.create(q.prototype),gn.prototype.constructor=gn,gn.prototype.isLineDashedMaterial=!0,gn.prototype.copy=function(t){return q.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var xi=Object.freeze({ShadowMaterial:sn,SpriteMaterial:ae,RawShaderMaterial:cn,ShaderMaterial:Y,PointsMaterial:me,MultiMaterial:ln,MeshPhysicalMaterial:hn,MeshStandardMaterial:un,MeshPhongMaterial:dn,MeshToonMaterial:pn,MeshNormalMaterial:fn,MeshLambertMaterial:mn,MeshDepthMaterial:Z,MeshBasicMaterial:ut,LineDashedMaterial:gn,LineBasicMaterial:de,Material:q}),wi={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Ei=new vn;Object.assign(yn.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=wi.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],c=!!a[2],a=a[3],a=window.decodeURIComponent(a);c&&(a=window.atob(a));try{var l,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":l=new ArrayBuffer(a.length);for(var h=new Uint8Array(l),c=0;c<a.length;c++)h[c]=a.charCodeAt(c);"blob"===u&&(l=new Blob([l],{type:s}));break;case"document":l=(new DOMParser).parseFromString(a,s);break;case"json":l=JSON.parse(a);break;default:l=a}window.setTimeout(function(){e&&e(l),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemError(t)},0)}}else{var d=new XMLHttpRequest;d.open("GET",t,!0),d.addEventListener("load",function(n){var o=n.target.response;wi.add(t,o),200===this.status?(e&&e(o),i.manager.itemEnd(t)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),e&&e(o),i.manager.itemEnd(t)):(r&&r(n),i.manager.itemError(t))},!1),void 0!==n&&d.addEventListener("progress",function(t){n(t)},!1),d.addEventListener("error",function(e){r&&r(e),i.manager.itemError(t)},!1),void 0!==this.responseType&&(d.responseType=this.responseType),void 0!==this.withCredentials&&(d.withCredentials=this.withCredentials),d.overrideMimeType&&d.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),d.send(null)}return i.manager.itemStart(t),d},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Object.assign(_n.prototype,{load:function(t,e,n,r){function i(i){c.load(t[i],function(t){t=o._parser(t,!0),a[i]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},l+=1,6===l&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s))},n,r)}var o=this,a=[],s=new _e;s.image=a;var c=new yn(this.manager);if(c.setPath(this.path),c.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,u=0,h=t.length;u<h;++u)i(u);else c.load(t,function(t){if(t=o._parser(t,!0),t.isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,r=0;r<n;r++){a[r]={mipmaps:[]};for(var i=0;i<t.mipmapCount;i++)a[r].mipmaps.push(t.mipmaps[r*t.mipmapCount+i]),a[r].format=t.format,a[r].width=t.width,a[r].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s)},n,r);return s},setPath:function(t){return this.path=t,this}}),Object.assign(bn.prototype,{load:function(t,e,n,r){var i=this,o=new G,a=new yn(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){(t=i._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:1001,o.wrapT=void 0!==t.wrapT?t.wrapT:1001,o.magFilter=void 0!==t.magFilter?t.magFilter:1006,o.minFilter=void 0!==t.minFilter?t.minFilter:1008,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,t))},n,r),o}}),Object.assign(xn.prototype,{load:function(t,e,n,r){var i=this,o=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(o.onload=function(){o.onload=null,URL.revokeObjectURL(o.src),e&&e(o),i.manager.itemEnd(t)},o.onerror=r,0===t.indexOf("data:"))o.src=t;else if(void 0!==this.crossOrigin)o.crossOrigin=this.crossOrigin,o.src=t;else{var a=new yn;a.setPath(this.path),a.setResponseType("blob"),a.setWithCredentials(this.withCredentials),a.load(t,function(t){o.src=URL.createObjectURL(t)},n,r)}return i.manager.itemStart(t),o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(wn.prototype,{load:function(t,e,n,r){function i(n){a.load(t[n],function(t){o.images[n]=t,s++,6===s&&(o.needsUpdate=!0,e&&e(o))},void 0,r)}var o=new u,a=new xn(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var s=0;for(n=0;n<t.length;++n)i(n);return o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(En.prototype,{load:function(t,e,n,i){var o=new r,a=new xn(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setWithCredentials(this.withCredentials),a.setPath(this.path),a.load(t,function(n){var r=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/);o.format=r?1022:1023,o.image=n,o.needsUpdate=!0,void 0!==e&&e(o)},n,i),o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Mn.prototype=Object.assign(Object.create(at.prototype),{constructor:Mn,isLight:!0,copy:function(t){return at.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=at.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Tn.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Tn,isHemisphereLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Sn.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),An.prototype=Object.assign(Object.create(Sn.prototype),{constructor:An,isSpotLightShadow:!0,update:function(t){var e=2*ri.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height;t=t.distance||500;var r=this.camera;e===r.fov&&n===r.aspect&&t===r.far||(r.fov=e,r.aspect=n,r.far=t,r.updateProjectionMatrix())}}),Ln.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Ln,isSpotLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Rn.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Rn,isPointLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Cn.prototype=Object.assign(Object.create(Sn.prototype),{constructor:Cn}),Pn.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Pn,isDirectionalLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),On.prototype=Object.assign(Object.create(Mn.prototype),{constructor:On,isAmbientLight:!0});var Mi={arraySlice:function(t,e,n){return Mi.isTypedArray(t)?new t.constructor(t.subarray(e,n)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=Array(e),r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,c=0;c!==e;++c)i[a++]=t[s+c];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a)){do a=o[r],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[i++];while(void 0!==o)}else if(void 0!==a.toArray){do a=o[r],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++];while(void 0!==o)}else do a=o[r],void 0!==a&&(e.push(o.time),n.push(a)),o=t[i++];while(void 0!==o)}}};Nn.prototype={constructor:Nn,evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return this._cachedIndex=n=e.length,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,r=e[++n],t<r)break e}r=e.length;break n}if(t>=i)break t;for(o=e[1],t<o&&(n=2,i=o),o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,i=e[--n-1],t>=i)break e}r=n,n=0}for(;n<r;)i=n+r>>>1,t<e[i]?r=i:n=i+1;if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,
this.beforeStart_(0,t,r);if(void 0===r)return this._cachedIndex=n=e.length,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize;t*=r;for(var i=0;i!==r;++i)e[i]=n[t+i];return e},interpolate_:function(t,e,n,r){throw Error("call to abstract method")},intervalChanged_:function(t,e,n){}},Object.assign(Nn.prototype,{beforeStart_:Nn.prototype.copySampleValue_,afterEnd_:Nn.prototype.copySampleValue_}),In.prototype=Object.assign(Object.create(Nn.prototype),{constructor:In,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=t,a=2*e-n;break;case 2402:i=r.length-2,a=e+r[i]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*n-e;break;case 2402:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}t=.5*(n-e),r=this.valueSize,this._weightPrev=t/(e-a),this._weightNext=t/(s-n),this._offsetPrev=i*r,this._offsetNext=o*r},interpolate_:function(t,e,n,r){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize;t*=a;var s=t-a,c=this._offsetPrev,l=this._offsetNext,u=this._weightPrev,h=this._weightNext,d=(n-e)/(r-e);for(n=d*d,r=n*d,e=-u*r+2*u*n-u*d,u=(1+u)*r+(-1.5-2*u)*n+(-.5+u)*d+1,d=(-1-h)*r+(1.5+h)*n+.5*d,h=h*r-h*n,n=0;n!==a;++n)i[n]=e*o[c+n]+u*o[s+n]+d*o[t+n]+h*o[l+n];return i}}),Dn.prototype=Object.assign(Object.create(Nn.prototype),{constructor:Dn,interpolate_:function(t,e,n,r){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize;t*=a;var s=t-a;for(e=(n-e)/(r-e),n=1-e,r=0;r!==a;++r)i[r]=o[s+r]*n+o[t+r]*e;return i}}),Un.prototype=Object.assign(Object.create(Nn.prototype),{constructor:Un,interpolate_:function(t,e,n,r){return this.copySampleValue_(t-1)}});var Ti;Ti={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Un(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Dn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new In(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}console.warn(e)}else this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;return++o,0===i&&o===r||(i>=o&&(o=Math.max(o,1),i=o-1),r=this.getValueSize(),this.times=Mi.arraySlice(n,i,o),this.values=Mi.arraySlice(this.values,i*r,o*r)),this},validate:function(){var t=!0,e=this.getValueSize();0!==e-Math.floor(e)&&(console.error("invalid value size in track",this),t=!1);var n=this.times,e=this.values,r=n.length;0===r&&(console.error("track is empty",this),t=!1);for(var i=null,o=0;o!==r;o++){var a=n[o];if("number"==typeof a&&isNaN(a)){console.error("time is not a valid number",this,o,a),t=!1;break}if(null!==i&&i>a){console.error("out of order keys",this,o,a,i),t=!1;break}i=a}if(void 0!==e&&Mi.isTypedArray(e))for(o=0,n=e.length;o!==n;++o)if(r=e[o],isNaN(r)){console.error("value is not a valid number",this,o,r),t=!1;break}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,o=t.length-1,a=1;a<o;++a){var s=!1,c=t[a];if(c!==t[a+1]&&(1!==a||c!==c[0]))if(r)s=!0;else for(var l=a*n,u=l-n,h=l+n,c=0;c!==n;++c){var d=e[l+c];if(d!==e[u+c]||d!==e[h+c]){s=!0;break}}if(s){if(a!==i)for(t[i]=t[a],s=a*n,l=i*n,c=0;c!==n;++c)e[l+c]=e[s+c];++i}}if(0<o){for(t[i]=t[o],s=o*n,l=i*n,c=0;c!==n;++c)e[l+c]=e[s+c];++i}return i!==t.length&&(this.times=Mi.arraySlice(t,0,i),this.values=Mi.arraySlice(e,0,i*n)),this}},Bn.prototype=Object.assign(Object.create(Ti),{constructor:Bn,ValueTypeName:"vector"}),zn.prototype=Object.assign(Object.create(Nn.prototype),{constructor:zn,interpolate_:function(t,e,n,r){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize;for(t*=a,e=(n-e)/(r-e),n=t+a;t!==n;t+=4)s.slerpFlat(i,0,o,t-a,o,t,e);return i}}),kn.prototype=Object.assign(Object.create(Ti),{constructor:kn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new zn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),jn.prototype=Object.assign(Object.create(Ti),{constructor:jn,ValueTypeName:"number"}),Hn.prototype=Object.assign(Object.create(Ti),{constructor:Hn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Gn.prototype=Object.assign(Object.create(Ti),{constructor:Gn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Vn.prototype=Object.assign(Object.create(Ti),{constructor:Vn,ValueTypeName:"color"}),Wn.prototype=Ti,Ti.constructor=Wn,Object.assign(Wn,{parse:function(t){if(void 0===t.type)throw Error("track type undefined, can not parse");var e=Wn._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],r=[];Mi.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e=t.constructor;if(void 0!==e.toJSON)e=e.toJSON(t);else{var e={name:t.name,times:Mi.convertArray(t.times,Array),values:Mi.convertArray(t.values,Array)},n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return jn;case"vector":case"vector2":case"vector3":case"vector4":return Bn;case"color":return Vn;case"quaternion":return kn;case"bool":case"boolean":return Gn;case"string":return Hn}throw Error("Unsupported typeName: "+t)}}),Xn.prototype={constructor:Xn,resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e)var r=this.tracks[e],t=Math.max(t,r.times[r.times.length-1]);this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(Xn,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(Wn.parse(n[i]).scale(r));return new Xn(t.name,t.duration,e)},toJSON:function(t){var e=[],n=t.tracks;t={name:t.name,duration:t.duration,tracks:e};for(var r=0,i=n.length;r!==i;++r)e.push(Wn.toJSON(n[r]));return t},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var l=Mi.getKeyframeOrder(s),s=Mi.sortedArray(s,1,l),c=Mi.sortedArray(c,1,l);r||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new jn(".morphTargetInfluences["+e[a].name+"]",s,c).scale(1/n))}return new Xn(t,-1,o)},findByName:function(t,e){var n=t;Array.isArray(t)||(n=t.geometry&&t.geometry.animations||t.animations);for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],c=s.name.match(i);if(c&&1<c.length){var l=c[1];(c=r[l])||(r[l]=c=[]),c.push(s)}}t=[];for(l in r)t.push(Xn.CreateFromMorphTargetSequence(l,r[l],e,n));return t},parseAnimation:function(t,e){if(!t)return console.error("  no animation in JSONLoader data"),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];Mi.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var o={},u=0;u<l.length;u++)if(l[u].morphTargets)for(var h=0;h<l[u].morphTargets.length;h++)o[l[u].morphTargets[h]]=-1;for(var d in o){for(var p=[],f=[],h=0;h!==l[u].morphTargets.length;++h){var m=l[u];p.push(m.time),f.push(m.morphTarget===d?1:0)}r.push(new jn(".morphTargetInfluence["+d+"]",p,f))}o=o.length*(a||1)}else u=".bones["+e[c].name+"]",n(Bn,u+".position",l,"pos",r),n(kn,u+".quaternion",l,"rot",r),n(Bn,u+".scale",l,"scl",r)}return 0===r.length?null:new Xn(i,o,r)}}),Object.assign(qn.prototype,{load:function(t,e,n,r){var i=this;new yn(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===r[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),r[t]}var r=this.textures,i=new xi[t.type];if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&i.specular.setHex(t.specular),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearCoat&&(i.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(i.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(i.uniforms=t.uniforms),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(i.vertexColors=t.vertexColors),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.shading&&(i.shading=t.shading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.side&&(i.side=t.side),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(i.skinning=t.skinning),void 0!==t.morphTargets&&(i.morphTargets=t.morphTargets),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=e(t.map)),void 0!==t.alphaMap&&(i.alphaMap=e(t.alphaMap),i.transparent=!0),void 0!==t.bumpMap&&(i.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=e(t.normalMap)),void 0!==t.normalScale){var o=t.normalScale;!1===Array.isArray(o)&&(o=[o,o]),i.normalScale=(new n).fromArray(o)}if(void 0!==t.displacementMap&&(i.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=e(t.specularMap)),void 0!==t.envMap&&(i.envMap=e(t.envMap)),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.lightMap&&(i.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=e(t.gradientMap)),void 0!==t.materials)for(var o=0,a=t.materials.length;o<a;o++)i.materials.push(this.parse(t.materials[o]));return i}}),Object.assign(Yn.prototype,{load:function(t,e,n,r){var i=this;new yn(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){var e=new Et,n=t.data.index,r={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};void 0!==n&&(n=new r[n.type](n.array),e.setIndex(new ht(n,1)));var i=t.data.attributes,o;for(o in i){var a=i[o],n=new r[a.type](a.array);e.addAttribute(o,new ht(n,a.itemSize,a.normalized))}if(r=t.data.groups||t.data.drawcalls||t.data.offsets,void 0!==r)for(o=0,n=r.length;o!==n;++o)i=r[o],e.addGroup(i.start,i.count,i.materialIndex);return t=t.data.boundingSphere,void 0!==t&&(r=new c,void 0!==t.center&&r.fromArray(t.center),e.boundingSphere=new Q(r,t.radius)),e}}),Zn.prototype={constructor:Zn,crossOrigin:void 0,extractUrlBase:function(t){return t=t.split("/"),1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:function(){var t,e,n;return function(r,i,o){function a(t,n,r,a,c){t=i+t;var l=Zn.Handlers.get(t);return null!==l?t=l.load(t):(e.setCrossOrigin(o),t=e.load(t)),void 0!==n&&(t.repeat.fromArray(n),1!==n[0]&&(t.wrapS=1e3),1!==n[1]&&(t.wrapT=1e3)),void 0!==r&&t.offset.fromArray(r),void 0!==a&&("repeat"===a[0]&&(t.wrapS=1e3),"mirror"===a[0]&&(t.wrapS=1002),"repeat"===a[1]&&(t.wrapT=1e3),"mirror"===a[1]&&(t.wrapT=1002)),void 0!==c&&(t.anisotropy=c),n=ri.generateUUID(),s[n]=t,n}void 0===t&&(t=new H),void 0===e&&(e=new En),void 0===n&&(n=new qn);var s={},c={uuid:ri.generateUUID(),type:"MeshLambertMaterial"},l;for(l in r){var u=r[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=u;break;case"blending":c.blending=Kr[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":c.color=t.fromArray(u).getHex();break;case"colorSpecular":c.specular=t.fromArray(u).getHex();break;case"colorEmissive":c.emissive=t.fromArray(u).getHex();break;case"specularCoef":c.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(c.type="MeshPhongMaterial"),"standard"===u.toLowerCase()&&(c.type="MeshStandardMaterial");break;case"mapDiffuse":c.map=a(u,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":c.emissiveMap=a(u,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":c.lightMap=a(u,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=a(u,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=a(u,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=a(u,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[u,u];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=a(u,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":c.metalnessMap=a(u,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":c.roughnessMap=a(u,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":c.alphaMap=a(u,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=1;break;case"doubleSided":c.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[l]=u;break;case"vertexColors":!0===u&&(c.vertexColors=2),"face"===u&&(c.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,u)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,1>c.opacity&&(c.transparent=!0),n.setTextures(s),n.parse(c)}}()},Zn.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n+1];if(e[n].test(t))return i}return null}},Object.assign(Jn.prototype,{load:function(t,e,n,r){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Zn.prototype.extractUrlBase(t),a=new yn(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){n=JSON.parse(n);var r=n.metadata;if(void 0!==r&&(r=r.type,void 0!==r)){if("object"===r.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===r.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}n=i.parse(n,o),e(n.geometry,n.materials)},n,r)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){var r=new wt,o=void 0!==t.scale?1/t.scale:1;return function(e){var i,o,a,s,l,u,h,d,p,f,m,g,v,y=t.faces;u=t.vertices;var _=t.normals,b=t.colors,x=0;if(void 0!==t.uvs){for(i=0;i<t.uvs.length;i++)t.uvs[i].length&&x++;for(i=0;i<x;i++)r.faceVertexUvs[i]=[]}for(s=0,l=u.length;s<l;)i=new c,i.x=u[s++]*e,i.y=u[s++]*e,i.z=u[s++]*e,r.vertices.push(i);for(s=0,l=y.length;s<l;)if(e=y[s++],p=1&e,a=2&e,i=8&e,h=16&e,f=32&e,u=64&e,e&=128,p){if(p=new lt,p.a=y[s],p.b=y[s+1],p.c=y[s+3],m=new lt,m.a=y[s+1],m.b=y[s+2],m.c=y[s+3],s+=4,a&&(a=y[s++],p.materialIndex=a,m.materialIndex=a),a=r.faces.length,i)for(i=0;i<x;i++)for(g=t.uvs[i],r.faceVertexUvs[i][a]=[],r.faceVertexUvs[i][a+1]=[],o=0;4>o;o++)d=y[s++],v=g[2*d],d=g[2*d+1],v=new n(v,d),2!==o&&r.faceVertexUvs[i][a].push(v),0!==o&&r.faceVertexUvs[i][a+1].push(v);if(h&&(h=3*y[s++],p.normal.set(_[h++],_[h++],_[h]),m.normal.copy(p.normal)),f)for(i=0;4>i;i++)h=3*y[s++],f=new c(_[h++],_[h++],_[h]),2!==i&&p.vertexNormals.push(f),0!==i&&m.vertexNormals.push(f);if(u&&(u=y[s++],u=b[u],p.color.setHex(u),m.color.setHex(u)),e)for(i=0;4>i;i++)u=y[s++],u=b[u],2!==i&&p.vertexColors.push(new H(u)),0!==i&&m.vertexColors.push(new H(u));r.faces.push(p),r.faces.push(m)}else{if(p=new lt,p.a=y[s++],p.b=y[s++],p.c=y[s++],a&&(a=y[s++],p.materialIndex=a),a=r.faces.length,i)for(i=0;i<x;i++)for(g=t.uvs[i],r.faceVertexUvs[i][a]=[],o=0;3>o;o++)d=y[s++],v=g[2*d],d=g[2*d+1],v=new n(v,d),r.faceVertexUvs[i][a].push(v);if(h&&(h=3*y[s++],p.normal.set(_[h++],_[h++],_[h])),f)for(i=0;3>i;i++)h=3*y[s++],f=new c(_[h++],_[h++],_[h]),p.vertexNormals.push(f);if(u&&(u=y[s++],p.color.setHex(b[u])),e)for(i=0;3>i;i++)u=y[s++],p.vertexColors.push(new H(b[u]));r.faces.push(p)}}(o),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,o=t.skinWeights.length;n<o;n+=e)r.skinWeights.push(new i(t.skinWeights[n],1<e?t.skinWeights[n+1]:0,2<e?t.skinWeights[n+2]:0,3<e?t.skinWeights[n+3]:0));if(t.skinIndices)for(n=0,o=t.skinIndices.length;n<o;n+=e)r.skinIndices.push(new i(t.skinIndices[n],1<e?t.skinIndices[n+1]:0,2<e?t.skinIndices[n+2]:0,3<e?t.skinIndices[n+3]:0));r.bones=t.bones,r.bones&&0<r.bones.length&&(r.skinWeights.length!==r.skinIndices.length||r.skinIndices.length!==r.vertices.length)&&console.warn("When skinning, number of vertices ("+r.vertices.length+"), skinIndices ("+r.skinIndices.length+"), and skinWeights ("+r.skinWeights.length+") should match.")}(),function(e){if(void 0!==t.morphTargets)for(var n=0,i=t.morphTargets.length;n<i;n++){r.morphTargets[n]={},r.morphTargets[n].name=t.morphTargets[n].name,r.morphTargets[n].vertices=[];for(var o=r.morphTargets[n].vertices,a=t.morphTargets[n].vertices,s=0,l=a.length;s<l;s+=3){var u=new c;u.x=a[s]*e,u.y=a[s+1]*e,u.z=a[s+2]*e,o.push(u)}}if(void 0!==t.morphColors&&0<t.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),e=r.faces,o=t.morphColors[0].colors,n=0,i=e.length;n<i;n++)e[n].color.fromArray(o,3*n)}(o),function(){var e=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var i=0;i<n.length;i++){var o=Xn.parseAnimation(n[i],r.bones);o&&e.push(o)}r.morphTargets&&(n=Xn.CreateClipsFromMorphTargetSequences(r.morphTargets,10),e=e.concat(n)),0<e.length&&(r.animations=e)}(),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:r}:(o=Zn.prototype.initMaterials(t.materials,e,this.crossOrigin),{geometry:r,materials:o})}}),Object.assign($n.prototype,{load:function(t,e,n,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new yn(i.manager).load(t,function(n){var r=null;try{r=JSON.parse(n)}catch(e){return void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}n=r.metadata,void 0===n||void 0===n.type||"geometry"===n.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead."):i.parse(r,e)},n,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseGeometries(t.geometries),r=this.parseImages(t.images,function(){void 0!==e&&e(i)}),r=this.parseTextures(t.textures,r),r=this.parseMaterials(t.materials,r),i=this.parseObject(t.object,n,r);return t.animations&&(i.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(i),i},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new Jn,r=new Yn,i=0,o=t.length;i<o;i++){var a,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new bi[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new bi[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new bi[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new bi[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new bi[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new bi[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new bi[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new bi[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new bi[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new bi[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new bi[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=r.parse(s);break;case"Geometry":a=n.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var n={};if(void 0!==t){var r=new qn;r.setTextures(e);for(var i=0,o=t.length;i<o;i++){var a=r.parse(t[i]);n[a.uuid]=a}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=Xn.parse(t[n]);e.push(r)}return e},parseImages:function(t,e){function n(t){return r.manager.itemStart(t),a.load(t,function(){r.manager.itemEnd(t)},void 0,function(){r.manager.itemError(t)})}var r=this,i={};if(void 0!==t&&0<t.length){var o=new vn(e),a=new xn(o);a.setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var c=t[o],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:r.texturePath+c.url;i[c.uuid]=n(l)}}return i},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==t)for(var o=0,a=t.length;o<a;o++){var s=t[o];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var c=new r(e[s.image]);c.needsUpdate=!0,c.uuid=s.uuid,void 0!==s.name&&(c.name=s.name),void 0!==s.mapping&&(c.mapping=n(s.mapping,ti)),void 0!==s.offset&&c.offset.fromArray(s.offset),void 0!==s.repeat&&c.repeat.fromArray(s.repeat),void 0!==s.wrap&&(c.wrapS=n(s.wrap[0],ei),c.wrapT=n(s.wrap[1],ei)),void 0!==s.minFilter&&(c.minFilter=n(s.minFilter,ni)),void 0!==s.magFilter&&(c.magFilter=n(s.magFilter,ni)),void 0!==s.anisotropy&&(c.anisotropy=s.anisotropy),void 0!==s.flipY&&(c.flipY=s.flipY),i[s.uuid]=c}return i},parseObject:function(){var t=new l;return function(e,n,r){function i(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function o(t){if(void 0!==t)return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),r[t]}var a;switch(e.type){case"Scene":a=new ie,void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new H(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new re(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new ne(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new Lt(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Rt(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new On(e.color,e.intensity);break;case"DirectionalLight":a=new Pn(e.color,e.intensity);break;case"PointLight":a=new Rn(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":a=new Ln(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Tn(e.color,e.groundColor,e.intensity);break;case"Mesh":a=i(e.geometry);var s=o(e.material);a=a.bones&&0<a.bones.length?new he(a,s):new Mt(a,s);break;case"LOD":a=new ce;break;case"Line":a=new pe(i(e.geometry),o(e.material),e.mode);break;case"LineSegments":a=new fe(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":a=new ge(i(e.geometry),o(e.material));break;case"Sprite":a=new se(o(e.material));break;case"Group":a=new ve;break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh type. Instantiates Object3D instead.");default:a=new at}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var c in e.children)a.add(this.parseObject(e.children[c],n,r));if("LOD"===e.type)for(e=e.levels,s=0;s<e.length;s++){var l=e[s];c=a.getObjectByProperty("uuid",l.object),void 0!==c&&a.addLevel(c,l.distance)}return a}}()}),Qn.prototype={constructor:Qn,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){return t=this.getUtoTmapping(t),this.getPoint(t)},getPoints:function(t){t||(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){t||(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e=[],n,r=this.getPoint(0),i,o=0;for(e.push(0),i=1;i<=t;i++)n=this.getPoint(i/t),o+=n.distanceTo(r),e.push(o),r=n;return this.cacheArcLengths=e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n=this.getLengths(),r,i=n.length,o;o=e?e:t*n[i-1];for(var a=0,s=i-1,c;a<=s;)if(r=Math.floor(a+(s-a)/2),c=n[r]-o,0>c)a=r+1;else{if(!(0<c)){s=r;break}s=r-1}return r=s,n[r]===o?r/(i-1):(a=n[r],(r+(o-a)/(n[r+1]-a))/(i-1))},getTangent:function(t){var e=t-1e-4;return t+=1e-4,0>e&&(e=0),1<t&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){var n=new c,r=[],i=[],o=[],a=new c,s=new l,u,h;for(u=0;u<=t;u++)h=u/t,r[u]=this.getTangentAt(h),r[u].normalize();i[0]=new c,o[0]=new c,u=Number.MAX_VALUE,h=Math.abs(r[0].x);var d=Math.abs(r[0].y),p=Math.abs(r[0].z);for(h<=u&&(u=h,n.set(1,0,0)),d<=u&&(u=d,n.set(0,1,0)),p<=u&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]),u=1;u<=t;u++)i[u]=i[u-1].clone(),o[u]=o[u-1].clone(),a.crossVectors(r[u-1],r[u]),a.length()>Number.EPSILON&&(a.normalize(),n=Math.acos(ri.clamp(r[u-1].dot(r[u]),-1,1)),i[u].applyMatrix4(s.makeRotationAxis(a,n))),o[u].crossVectors(r[u],i[u]);if(!0===e)for(n=Math.acos(ri.clamp(i[0].dot(i[t]),-1,1)),n/=t,0<r[0].dot(a.crossVectors(i[0],i[t]))&&(n=-n),u=1;u<=t;u++)i[u].applyMatrix4(s.makeRotationAxis(r[u],n*u)),o[u].crossVectors(r[u],i[u]);return{tangents:r,normals:i,binormals:o}}},Qn.create=function(t,e){return t.prototype=Object.create(Qn.prototype),
t.prototype.constructor=t,t.prototype.getPoint=e,t},Kn.prototype=Object.create(Qn.prototype),Kn.prototype.constructor=Kn,Kn.prototype.isLineCurve=!0,Kn.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},Kn.prototype.getPointAt=function(t){return this.getPoint(t)},Kn.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},tr.prototype=Object.assign(Object.create(Qn.prototype),{constructor:tr,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Kn(e,t))},getPoint:function(t){var e=t*this.getLength(),n=this.getCurveLengths();for(t=0;t<n.length;){if(n[t]>=e)return e=n[t]-e,t=this.curves[t],n=t.getLength(),t.getPointAt(0===n?0:1-e/n);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){t||(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e=[],n,r=0,i=this.curves;r<i.length;r++)for(var o=i[r],o=o.getPoints(o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t),a=0;a<o.length;a++){var s=o[a];n&&n.equals(s)||(e.push(s),n=s)}return this.autoClose&&1<e.length&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},createPointsGeometry:function(t){return t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){for(var e=new wt,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new c(i.x,i.y,i.z||0))}return e}}),er.prototype=Object.create(Qn.prototype),er.prototype.constructor=er,er.prototype.isEllipseCurve=!0,er.prototype.getPoint=function(t){for(var e=2*Math.PI,r=this.aEndAngle-this.aStartAngle,i=Math.abs(r)<Number.EPSILON;0>r;)r+=e;for(;r>e;)r-=e;r<Number.EPSILON&&(r=i?0:e),!0!==this.aClockwise||i||(r=r===e?-e:r-e),e=this.aStartAngle+t*r,t=this.aX+this.xRadius*Math.cos(e);var o=this.aY+this.yRadius*Math.sin(e);return 0!==this.aRotation&&(e=Math.cos(this.aRotation),r=Math.sin(this.aRotation),i=t-this.aX,o-=this.aY,t=i*e-o*r+this.aX,o=i*r+o*e+this.aY),new n(t,o)};var Si={tangentQuadraticBezier:function(t,e,n,r){return 2*(1-t)*(n-e)+2*t*(r-n)},tangentCubicBezier:function(t,e,n,r,i){return-3*e*(1-t)*(1-t)+3*n*(1-t)*(1-t)-6*t*n*(1-t)+6*t*r*(1-t)-3*t*t*r+3*t*t*i},tangentSpline:function(t,e,n,r,i){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,n,r,i){t=.5*(n-t),r=.5*(r-e);var o=i*i;return(2*e-2*n+t+r)*i*o+(-3*e+3*n-2*t-r)*o+t*i+e}};nr.prototype=Object.create(Qn.prototype),nr.prototype.constructor=nr,nr.prototype.isSplineCurve=!0,nr.prototype.getPoint=function(t){var e=this.points;t*=e.length-1;var r=Math.floor(t);t-=r;var i=e[0===r?r:r-1],o=e[r],a=e[r>e.length-2?e.length-1:r+1],e=e[r>e.length-3?e.length-1:r+2],r=Si.interpolate;return new n(r(i.x,o.x,a.x,e.x,t),r(i.y,o.y,a.y,e.y,t))},rr.prototype=Object.create(Qn.prototype),rr.prototype.constructor=rr,rr.prototype.getPoint=function(t){var e=_i.b3;return new n(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},rr.prototype.getTangent=function(t){var e=Si.tangentCubicBezier;return new n(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},ir.prototype=Object.create(Qn.prototype),ir.prototype.constructor=ir,ir.prototype.getPoint=function(t){var e=_i.b2;return new n(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y))},ir.prototype.getTangent=function(t){var e=Si.tangentQuadraticBezier;return new n(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize()};var Ai=Object.assign(Object.create(tr.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var r=new Kn(this.currentPoint.clone(),new n(t,e));this.curves.push(r),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,r,i){t=new ir(this.currentPoint.clone(),new n(t,e),new n(r,i)),this.curves.push(t),this.currentPoint.set(r,i)},bezierCurveTo:function(t,e,r,i,o,a){t=new rr(this.currentPoint.clone(),new n(t,e),new n(r,i),new n(o,a)),this.curves.push(t),this.currentPoint.set(o,a)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),e=new nr(e);this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,o){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o)},absarc:function(t,e,n,r,i,o){this.absellipse(t,e,n,n,r,i,o)},ellipse:function(t,e,n,r,i,o,a,s){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o,a,s)},absellipse:function(t,e,n,r,i,o,a,s){t=new er(t,e,n,r,i,o,a,s),0<this.curves.length&&(e=t.getPoint(0),e.equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)}});or.prototype=Object.assign(Object.create(Ai),{constructor:or,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),ar.prototype=Ai,Ai.constructor=ar,sr.prototype={moveTo:function(t,e){this.currentPath=new ar,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,o){this.currentPath.bezierCurveTo(t,e,n,r,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new or;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(0>l&&(a=e[o],c=-c,s=e[i],l=-l),!(t.y<a.y||t.y>s.y))if(t.y===a.y){if(t.x===a.x)return!0}else{if(i=l*(t.x-a.x)-c*(t.y-a.y),0===i)return!0;0>i||(r=!r)}}else if(t.y===a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return!0}return r}var i=_i.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,c,l=[];if(1===o.length)return s=o[0],c=new or,c.curves=s.curves,l.push(c),l;var u=!i(o[0].getPoints()),u=t?!u:u;c=[];var h=[],d=[],p=0,f;h[p]=void 0,d[p]=[];for(var m=0,g=o.length;m<g;m++)s=o[m],f=s.getPoints(),a=i(f),(a=t?!a:a)?(!u&&h[p]&&p++,h[p]={s:new or,p:f},h[p].s.curves=s.curves,u&&p++,d[p]=[]):d[p].push({h:s,p:f[0]});if(!h[0])return n(o);if(1<h.length){for(m=!1,s=[],i=0,o=h.length;i<o;i++)c[i]=[];for(i=0,o=h.length;i<o;i++)for(a=d[i],u=0;u<a.length;u++){for(p=a[u],f=!0,g=0;g<h.length;g++)r(p.p,h[g].p)&&(i!==g&&s.push({froms:i,tos:g,hole:u}),f?(f=!1,c[g].push(p)):m=!0);f&&c[i].push(p)}0<s.length&&(m||(d=c))}for(m=0,i=h.length;m<i;m++)for(c=h[m].s,l.push(c),s=d[m],o=0,a=s.length;o<a;o++)c.holes.push(s[o].h);return l}},Object.assign(cr.prototype,{isFont:!0,generateShapes:function(t,e,n){void 0===e&&(e=100),void 0===n&&(n=4);var r=this.data;t=String(t).split("");var i=e/r.resolution,o=0;e=[];for(var a=0;a<t.length;a++){var s;s=i;var c=o,l=r.glyphs[t[a]]||r.glyphs["?"];if(l){var u=new sr,h=[],d=_i.b2,p=_i.b3,f,m,g,v,y,_,b,x;if(l.o)for(var w=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),E=0,M=w.length;E<M;)switch(w[E++]){case"m":f=w[E++]*s+c,m=w[E++]*s,u.moveTo(f,m);break;case"l":f=w[E++]*s+c,m=w[E++]*s,u.lineTo(f,m);break;case"q":if(f=w[E++]*s+c,m=w[E++]*s,y=w[E++]*s+c,_=w[E++]*s,u.quadraticCurveTo(y,_,f,m),v=h[h.length-1]){g=v.x,v=v.y;for(var T=1;T<=n;T++){var S=T/n;d(S,g,y,f),d(S,v,_,m)}}break;case"b":if(f=w[E++]*s+c,m=w[E++]*s,y=w[E++]*s+c,_=w[E++]*s,b=w[E++]*s+c,x=w[E++]*s,u.bezierCurveTo(y,_,b,x,f,m),v=h[h.length-1])for(g=v.x,v=v.y,T=1;T<=n;T++)S=T/n,p(S,g,y,b,f),p(S,v,_,x,m)}s={offset:l.ha*s,path:u}}else s=void 0;o+=s.offset,e.push(s.path)}for(n=[],r=0,t=e.length;r<t;r++)Array.prototype.push.apply(n,e[r].toShapes());return n}}),Object.assign(lr.prototype,{load:function(t,e,n,r){var i=this;new yn(this.manager).load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}t=i.parse(n),e&&e(t)},n,r)},parse:function(t){return new cr(t)}});var Li,Ri={getContext:function(){return void 0===Li&&(Li=new(window.AudioContext||window.webkitAudioContext)),Li},setContext:function(t){Li=t}};Object.assign(ur.prototype,{load:function(t,e,n,r){var i=new yn(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){Ri.getContext().decodeAudioData(t,function(t){e(t)})},n,r)}}),hr.prototype=Object.assign(Object.create(Mn.prototype),{constructor:hr,isRectAreaLight:!0,copy:function(t){return Mn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this}}),Object.assign(dr.prototype,{update:function(){var t,e,n,r,i,o,a,s=new l,c=new l;return function(l){if(t!==this||e!==l.focus||n!==l.fov||r!==l.aspect*this.aspect||i!==l.near||o!==l.far||a!==l.zoom){t=this,e=l.focus,n=l.fov,r=l.aspect*this.aspect,i=l.near,o=l.far,a=l.zoom;var u=l.projectionMatrix.clone(),h=this.eyeSep/2,d=h*i/e,p=i*Math.tan(ri.DEG2RAD*n*.5)/a,f;c.elements[12]=-h,s.elements[12]=h,h=-p*r+d,f=p*r+d,u.elements[0]=2*i/(f-h),u.elements[8]=(f+h)/(f-h),this.cameraL.projectionMatrix.copy(u),h=-p*r-d,f=p*r-d,u.elements[0]=2*i/(f-h),u.elements[8]=(f+h)/(f-h),this.cameraR.projectionMatrix.copy(u)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(c),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(s)}}()}),pr.prototype=Object.create(at.prototype),pr.prototype.constructor=pr,fr.prototype=Object.assign(Object.create(at.prototype),{constructor:fr,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new c,e=new s,n=new c,r=new c;return function(i){at.prototype.updateMatrixWorld.call(this,i),i=this.context.listener;var o=this.up;this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),i.positionX?(i.positionX.setValueAtTime(t.x,this.context.currentTime),i.positionY.setValueAtTime(t.y,this.context.currentTime),i.positionZ.setValueAtTime(t.z,this.context.currentTime),i.forwardX.setValueAtTime(r.x,this.context.currentTime),i.forwardY.setValueAtTime(r.y,this.context.currentTime),i.forwardZ.setValueAtTime(r.z,this.context.currentTime),i.upX.setValueAtTime(o.x,this.context.currentTime),i.upY.setValueAtTime(o.y,this.context.currentTime),i.upZ.setValueAtTime(o.z,this.context.currentTime)):(i.setPosition(t.x,t.y,t.z),i.setOrientation(r.x,r.y,r.z,o.x,o.y,o.z))}}()}),mr.prototype=Object.assign(Object.create(at.prototype),{constructor:mr,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),t.start(0,this.startTime),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){return!1!==this.hasPlaybackControl?(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this):void console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){return!1!==this.hasPlaybackControl?(this.source.stop(),this.startTime=0,this.isPlaying=!1,this):void console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){return!1!==this.hasPlaybackControl?(this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this):void console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){return!1!==this.hasPlaybackControl?(this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this):void console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),gr.prototype=Object.assign(Object.create(mr.prototype),{constructor:gr,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new c;return function(e){at.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(vr.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),yr.prototype={constructor:yr,accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(o=0;o!==r;++o)n[i+o]=n[o];o=e}else o+=e,this._mixBufferRegion(n,i,0,e/o,r);this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer;t=t*e+e;var r=this.cumulativeWeight,i=this.binding;this.cumulativeWeight=0,1>r&&this._mixBufferRegion(n,t,3*e,1-r,e);for(var r=e,o=e+e;r!==o;++r)if(n[r]!==n[r+e]){i.setValue(n,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,n=3*e;this.binding.getValue(t,n);for(var r=e;r!==n;++r)t[r]=t[n+r%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,n,r,i){if(.5<=r)for(r=0;r!==i;++r)t[e+r]=t[n+r]},_slerp:function(t,e,n,r,i){s.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}},_r.prototype={constructor:_r,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(this.node=t=_r.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);for(t=t.skeleton.bones,n=0;n<t.length;n++)if(t[n].name===o){o=n;break}break;default:if(void 0===t[n])return void console.error("  can not bind to objectName of node, undefined",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[o]}}if(o=t[r],void 0===o)console.error("  trying to update property for track: "+e.nodeName+"."+r+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==t.needsUpdate?(e=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t),n=this.BindingType.Direct,void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(n=0;n<this.node.geometry.morphTargets.length;n++)if(t.geometry.morphTargets[n].name===i){i=n;break}}n=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(n=this.BindingType.HasFromToArray,this.resolvedProperty=o):void 0!==o.length?(n=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[n],this.setValue=this.SetterByBindingTypeAndVersioning[n][e]}}else console.error("  trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(_r.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:_r.prototype.getValue,_setValue_unbound:_r.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),_r.Composite=function(t,e,n){n=n||_r.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,n)},_r.Composite.prototype={constructor:_r.Composite,getValue:function(t,e){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},_r.create=function(t,e,n){return t&&t.isAnimationObjectGroup?new _r.Composite(t,e,n):new _r(t,e,n)},_r.parseTrackName=function(t){var e=/^((?:[\w-]+[\/:])*)([\w-]+)?(?:\.([\w-]+)(?:\[(.+)\])?)?\.([\w-]+)(?:\[(.+)\])?$/.exec(t);if(!e)throw Error("cannot parse trackName at all: "+t);if(e={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},null===e.propertyName||0===e.propertyName.length)throw Error("can not parse propertyName from trackName: "+t);return e},_r.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var r=t.bones[n];if(r.name===e)return r}return null}(t.skeleton);if(n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e||(i=r(i.children)))return i}return null};if(n=r(t.children))return n}return null},br.prototype={constructor:br,isAnimationObjectGroup:!0,add:function(t){for(var e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,c=s.length,l=0,u=arguments.length;l!==u;++l){var h=arguments[l],d=h.uuid,p=i[d];if(void 0===p){p=n++,i[d]=p,e.push(h);for(var d=0,f=c;d!==f;++d)s[d].push(new _r(h,o[d],a[d]))}else if(p<r){var m=--r,f=e[m];for(i[f.uuid]=p,e[p]=f,i[d]=m,e[m]=h,d=0,f=c;d!==f;++d){var g=s[d],v=g[p];g[p]=g[m],void 0===v&&(v=new _r(h,o[d],a[d])),g[m]=v}}else void 0!==e[p]&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=r},remove:function(t){for(var e=this._objects,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],l=c.uuid,u=r[l];if(void 0!==u&&u>=n){var h=n++,d=e[h];for(r[d.uuid]=u,e[u]=d,r[l]=h,e[h]=c,c=0,l=o;c!==l;++c){var d=i[c],p=d[u];d[u]=d[h],d[h]=p}}}this.nCachedObjects_=n},uncache:function(t){for(var e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,c=arguments.length;s!==c;++s){var l=arguments[s].uuid,u=i[l];if(void 0!==u)if(delete i[l],u<r){var l=--r,h=e[l],d=--n,p=e[d];for(i[h.uuid]=u,e[u]=h,i[p.uuid]=l,e[l]=p,e.pop(),h=0,p=a;h!==p;++h){var f=o[h],m=f[d];f[u]=f[l],f[l]=m,f.pop()}}else for(d=--n,p=e[d],i[p.uuid]=u,e[u]=p,e.pop(),h=0,p=a;h!==p;++h)f=o[h],f[u]=f[d],f.pop()}this.nCachedObjects_=r},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,c=this.nCachedObjects_,l=Array(s.length),r=i.length;for(n[t]=r,o.push(t),a.push(e),i.push(l),n=c,r=s.length;n!==r;++n)l[n]=new _r(s[n],t,e);return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}},xr.prototype={constructor:xr,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){n=this._clip.duration;var r=t._clip.duration,i=n/r;t.warp(1,r/n,e),this.warp(i,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;return null===o&&(this._timeScaleInterpolant=o=r._lendControlInterpolant()),r=o.parameterPositions,o=o.sampleValues,r[0]=i,r[1]=i+n,o[0]=t/a,o[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){var i=this._startTime;if(null!==i){if(e=(t-i)*n,0>e||0===n)return;this._startTime=null,e*=n}if(e*=this._updateTimeScale(t),n=this._updateTime(e),t=this._updateWeight(t),0<t){e=this._interpolants;for(var i=this._propertyBindings,o=0,a=e.length;o!==a;++o)e[o].evaluate(n),i[o].accumulate(r,t)}},_updateWeight:function(t){var e=0;if(this.enabled){var e=this.weight,n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0],e=e*r;t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e},_updateTimeScale:function(t){var e=0;if(!this.paused){var e=this.timeScale,n=this._timeScaleInterpolant;if(null!==n){var r=n.evaluate(t)[0],e=e*r;t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(2200===r)t:{if(-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1)),e>=n)e=n;else{if(!(0>e))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(r=2202===r,-1===i&&(0<=t?(i=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),e>=n||0>e){var o=Math.floor(e/n),e=e-n*o,i=i+Math.abs(o),a=this.repetitions-i;0>a?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(0===a?(t=0>t,this._setEndings(t,!t,r)):this._setEndings(!1,!1,r),this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o}))}if(r&&1===(1&i))return this.time=e,n-e}return this.time=e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;return null===o&&(this._weightInterpolant=o=r._lendControlInterpolant()),r=o.parameterPositions,o=o.sampleValues,r[0]=i,o[0]=e,r[1]=i+t,o[1]=n,this}},Object.assign(wr.prototype,e.prototype,{clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Xn.findByName(n,t):t,n=null!==i?i.uuid:t,o=this._actionsByClip[n],a=null;if(void 0!==o){if(a=o.actionByRoot[r],void 0!==a)return a;a=o.knownActions[0],null===i&&(i=a._clip)}return null===i?null:(i=new xr(this,i,e),this._bindAction(i,a),this._addInactiveAction(i,n,r),i)},existingAction:function(t,e){var n=e||this._root,r=n.uuid,n="string"==typeof t?Xn.findByName(n,t):t,n=this._actionsByClip[n?n.uuid:t];return void 0!==n?n.actionByRoot[r]||null:null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings,i=this._nActiveBindings=this._nActiveActions=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){var s=e[a];s.enabled&&s._update(r,t,i,o)}for(t=this._bindings,e=this._nActiveBindings,a=0;a!==e;++a)t[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var n=this._actionsByClip,r=n[t];if(void 0!==r){for(var r=r.knownActions,i=0,o=r.length;i!==o;++i){var a=r[i];this._deactivateAction(a);var s=a._cacheIndex,c=e[e.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,c._cacheIndex=s,e[s]=c,e.pop(),this._removeInactiveBindingsForAction(a)}delete n[t]}},uncacheRoot:function(t){t=t.uuid;var e=this._actionsByClip,n;for(n in e){var r=e[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}if(n=this._bindingsByRootAndName[t],void 0!==n)for(var i in n)t=n[i],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Object.assign(wr.prototype,{_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];for(void 0===l&&(l={},c[s]=l),c=0;c!==i;++c){var u=r[c],h=u.name,d=l[h];if(void 0===d){if(d=o[c],void 0!==d){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,h));continue}d=new yr(_r.create(n,h,e&&e._propertyBindings[c].binding.parsedPath),u.ValueTypeName,u.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,h)}o[c]=d,a[c].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0===i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],
this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return t=t._cacheIndex,null!==t&&t<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];void 0===o?(o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o):(e=o.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var n=t._clip.uuid,r=this._actionsByClip,i=r[n],o=i.knownActions,a=o[o.length-1],s=t._byClipCacheIndex;a._byClipCacheIndex=s,o[s]=a,o.pop(),t._byClipCacheIndex=null,delete i.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete r[n],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){t=t._propertyBindings;for(var e=0,n=t.length;e!==n;++e){var r=t[e];0===--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,n=n.path,i=this._bindingsByRootAndName,o=i[r],a=e[e.length-1];t=t._cacheIndex,a._cacheIndex=t,e[t]=a,e.pop(),delete o[n];t:{for(var s in o)break t;delete i[r]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&(n=new Dn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1)}),Er.prototype.clone=function(){return new Er(void 0===this.value.clone?this.value:this.value.clone())},Mr.prototype=Object.create(Et.prototype),Mr.prototype.constructor=Mr,Mr.prototype.isInstancedBufferGeometry=!0,Mr.prototype.addGroup=function(t,e,n){this.groups.push({start:t,count:e,materialIndex:n})},Mr.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var e=t.attributes,n;for(n in e)this.addAttribute(n,e[n].clone());for(t=t.groups,n=0,e=t.length;n<e;n++){var r=t[n];this.addGroup(r.start,r.count,r.materialIndex)}return this},Tr.prototype={constructor:Tr,isInterleavedBufferAttribute:!0,get count(){return this.data.count},get array(){return this.data.array},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}},Sr.prototype={constructor:Sr,isInterleavedBuffer:!0,set needsUpdate(t){!0===t&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}},Ar.prototype=Object.create(Sr.prototype),Ar.prototype.constructor=Ar,Ar.prototype.isInstancedInterleavedBuffer=!0,Ar.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Lr.prototype=Object.create(ht.prototype),Lr.prototype.constructor=Lr,Lr.prototype.isInstancedBufferAttribute=!0,Lr.prototype.copy=function(t){return ht.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Rr.prototype={constructor:Rr,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var n=[];return Pr(t,this,n,e),n.sort(Cr),n},intersectObjects:function(t,e){var n=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,i=t.length;r<i;r++)Pr(t[r],this,n,e);return n.sort(Cr),n}},Or.prototype={constructor:Or,start:function(){this.oldTime=this.startTime=(performance||Date).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now(),t=(e-this.oldTime)/1e3;this.oldTime=e,this.elapsedTime+=t}return t}},Nr.prototype={constructor:Nr,set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(ri.clamp(t.y/this.radius,-1,1))),this}},Ir.prototype={constructor:Ir,set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}},Dr.prototype=Object.create(Mt.prototype),Dr.prototype.constructor=Dr,Dr.prototype.createAnimation=function(t,e,n,r){e={start:e,end:n,length:n-e+1,fps:r,duration:(n-e)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[t]=e,this.animationsList.push(e)},Dr.prototype.autoCreateAnimations=function(t){for(var e=/([a-z]+)_?(\d+)/i,n,r={},i=this.geometry,o=0,a=i.morphTargets.length;o<a;o++){var s=i.morphTargets[o].name.match(e);if(s&&1<s.length){var c=s[1];r[c]||(r[c]={start:1/0,end:-(1/0)}),s=r[c],o<s.start&&(s.start=o),o>s.end&&(s.end=o),n||(n=c)}}for(c in r)s=r[c],this.createAnimation(c,s.start,s.end,t);this.firstAnimation=n},Dr.prototype.setAnimationDirectionForward=function(t){(t=this.animationsMap[t])&&(t.direction=1,t.directionBackwards=!1)},Dr.prototype.setAnimationDirectionBackward=function(t){(t=this.animationsMap[t])&&(t.direction=-1,t.directionBackwards=!0)},Dr.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},Dr.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},Dr.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},Dr.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},Dr.prototype.getAnimationTime=function(t){var e=0;return(t=this.animationsMap[t])&&(e=t.time),e},Dr.prototype.getAnimationDuration=function(t){var e=-1;return(t=this.animationsMap[t])&&(e=t.duration),e},Dr.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},Dr.prototype.stopAnimation=function(t){(t=this.animationsMap[t])&&(t.active=!1)},Dr.prototype.update=function(t){for(var e=0,n=this.animationsList.length;e<n;e++){var r=this.animationsList[e];if(r.active){var i=r.duration/r.length;r.time+=r.direction*t,r.mirroredLoop?(r.time>r.duration||0>r.time)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),0>r.time&&(r.time=0,r.directionBackwards=!1)):(r.time%=r.duration,0>r.time&&(r.time+=r.duration));var o=r.start+ri.clamp(Math.floor(r.time/i),0,r.length-1),a=r.weight;o!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*a,this.morphTargetInfluences[o]=0,r.lastFrame=r.currentFrame,r.currentFrame=o),i=r.time%i/i,r.directionBackwards&&(i=1-i),r.currentFrame!==r.lastFrame?(this.morphTargetInfluences[r.currentFrame]=i*a,this.morphTargetInfluences[r.lastFrame]=(1-i)*a):this.morphTargetInfluences[r.currentFrame]=a}}},Ur.prototype=Object.create(at.prototype),Ur.prototype.constructor=Ur,Ur.prototype.isImmediateRenderObject=!0,Fr.prototype=Object.create(fe.prototype),Fr.prototype.constructor=Fr,Fr.prototype.update=function(){var t=new c,e=new c,n=new K;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,c=a.faces,l=a=0,u=c.length;l<u;l++)for(var h=c[l],d=0,p=h.vertexNormals.length;d<p;d++){var f=h.vertexNormals[d];t.copy(s[h[r[d]]]).applyMatrix4(i),e.copy(f).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),a+=1,o.setXYZ(a,e.x,e.y,e.z),a+=1}else if(a&&a.isBufferGeometry)for(r=a.attributes.position,s=a.attributes.normal,d=a=0,p=r.count;d<p;d++)t.set(r.getX(d),r.getY(d),r.getZ(d)).applyMatrix4(i),e.set(s.getX(d),s.getY(d),s.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),a+=1,o.setXYZ(a,e.x,e.y,e.z),a+=1;return o.needsUpdate=!0,this}}(),Br.prototype=Object.create(at.prototype),Br.prototype.constructor=Br,Br.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Br.prototype.update=function(){var t=new c,e=new c;return function(){var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),zr.prototype=Object.create(fe.prototype),zr.prototype.constructor=zr,zr.prototype.getBoneList=function(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,this.getBoneList(t.children[n]));return e},zr.prototype.update=function(){var t=new c,e=new l,n=new l;return function(){var r=this.geometry,i=r.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var o=0,a=0;o<this.bones.length;o++){var s=this.bones[o];s.parent&&s.parent.isBone&&(e.multiplyMatrices(n,s.matrixWorld),t.setFromMatrixPosition(e),i.setXYZ(a,t.x,t.y,t.z),e.multiplyMatrices(n,s.parent.matrixWorld),t.setFromMatrixPosition(e),i.setXYZ(a+1,t.x,t.y,t.z),a+=2)}r.getAttribute("position").needsUpdate=!0}}(),kr.prototype=Object.create(Mt.prototype),kr.prototype.constructor=kr,kr.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},kr.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},jr.prototype=Object.create(at.prototype),jr.prototype.constructor=jr,jr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose(),this.children[1].geometry.dispose(),this.children[1].material.dispose()},jr.prototype.update=function(){var t=new c,e=new c;return function(){var n=this.children[0],r=this.children[1];if(this.light.target){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld);var i=e.clone().sub(t);n.lookAt(i),r.lookAt(i)}n.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var r=.5*this.light.width,i=.5*this.light.height,n=n.geometry.getAttribute("position"),o=n.array;o[0]=r,o[1]=-i,o[2]=0,o[3]=r,o[4]=i,o[5]=0,o[6]=-r,o[7]=i,o[8]=0,o[9]=-r,o[10]=i,o[11]=0,o[12]=-r,o[13]=-i,o[14]=0,o[15]=r,o[16]=-i,o[17]=0,n.needsUpdate=!0}}(),Hr.prototype=Object.create(at.prototype),Hr.prototype.constructor=Hr,Hr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Hr.prototype.update=function(){var t=new c,e=new H,n=new H;return function(){var r=this.children[0],i=r.geometry.getAttribute("color");e.copy(this.light.color).multiplyScalar(this.light.intensity),n.copy(this.light.groundColor).multiplyScalar(this.light.intensity);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?e:n;i.setXYZ(o,s.r,s.g,s.b)}r.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),i.needsUpdate=!0}}(),Gr.prototype=Object.create(fe.prototype),Gr.prototype.constructor=Gr,Vr.prototype=Object.create(fe.prototype),Vr.prototype.constructor=Vr,Wr.prototype=Object.create(fe.prototype),Wr.prototype.constructor=Wr,Wr.prototype.update=function(){var t=new c,e=new c,n=new K;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,o=o.faces,s=0,c=0,l=o.length;c<l;c++){var u=o[c],h=u.normal;t.copy(a[u.a]).add(a[u.b]).add(a[u.c]).divideScalar(3).applyMatrix4(r),e.copy(h).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),i.setXYZ(s,t.x,t.y,t.z),s+=1,i.setXYZ(s,e.x,e.y,e.z),s+=1}return i.needsUpdate=!0,this}}(),Xr.prototype=Object.create(at.prototype),Xr.prototype.constructor=Xr,Xr.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},Xr.prototype.update=function(){var t=new c,e=new c,n=new c;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t);var r=this.children[0],i=this.children[1];r.lookAt(n),r.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),i.lookAt(n),i.scale.z=n.length()}}(),qr.prototype=Object.create(fe.prototype),qr.prototype.constructor=qr,qr.prototype.update=function(){function t(t,o,a,s){if(r.set(o,a,s).unproject(i),t=n[t],void 0!==t)for(o=e.getAttribute("position"),a=0,s=t.length;a<s;a++)o.setXYZ(t[a],r.x,r.y,r.z)}var e,n,r=new c,i=new At;return function(){e=this.geometry,n=this.pointMap,i.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),Yr.prototype=Object.create(fe.prototype),Yr.prototype.constructor=Yr,Yr.prototype.update=function(){var t=new J;return function(e){if(e&&e.isBox3?t.copy(e):t.setFromObject(e),!t.isEmpty()){e=t.min;var n=t.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}();var Ci=new Et;Ci.addAttribute("position",new _t([0,0,0,0,1,0],3));var Pi=new Ke(0,.5,1,5,1);Pi.translate(0,-.5,0),Zr.prototype=Object.create(at.prototype),Zr.prototype.constructor=Zr,Zr.prototype.setDirection=function(){var t=new c,e;return function(n){.99999<n.y?this.quaternion.set(0,0,0,1):-.99999>n.y?this.quaternion.set(1,0,0,0):(t.set(n.z,0,-n.x).normalize(),e=Math.acos(n.y),this.quaternion.setFromAxisAngle(t,e))}}(),Zr.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Zr.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Jr.prototype=Object.create(fe.prototype),Jr.prototype.constructor=Jr;var Oi=function(){function t(){}var e=new c,n=new t,r=new t,i=new t;return t.prototype.init=function(t,e,n,r){this.c0=t,this.c1=n,this.c2=-3*t+3*e-2*n-r,this.c3=2*t-2*e+n+r},t.prototype.initNonuniformCatmullRom=function(t,e,n,r,i,o,a){this.init(e,n,((e-t)/i-(n-t)/(i+o)+(n-e)/o)*o,((n-e)/o-(r-e)/(o+a)+(r-n)/a)*o)},t.prototype.initCatmullRom=function(t,e,n,r,i){this.init(e,n,i*(n-t),i*(r-e))},t.prototype.calc=function(t){var e=t*t;return this.c0+this.c1*t+this.c2*e+this.c3*e*t},Qn.create(function(t){this.points=t||[],this.closed=!1},function(t){var o=this.points,a,s;s=o.length,2>s&&console.log("duh, you need at least 2 points"),t*=s-(this.closed?0:1),a=Math.floor(t),t-=a,this.closed?a+=0<a?0:(Math.floor(Math.abs(a)/o.length)+1)*o.length:0===t&&a===s-1&&(a=s-2,t=1);var l,u,h;if(this.closed||0<a?l=o[(a-1)%s]:(e.subVectors(o[0],o[1]).add(o[0]),l=e),u=o[a%s],h=o[(a+1)%s],this.closed||a+2<s?o=o[(a+2)%s]:(e.subVectors(o[s-1],o[s-2]).add(o[s-1]),o=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var d="chordal"===this.type?.5:.25;s=Math.pow(l.distanceToSquared(u),d),a=Math.pow(u.distanceToSquared(h),d),d=Math.pow(h.distanceToSquared(o),d),1e-4>a&&(a=1),1e-4>s&&(s=a),1e-4>d&&(d=a),n.initNonuniformCatmullRom(l.x,u.x,h.x,o.x,s,a,d),r.initNonuniformCatmullRom(l.y,u.y,h.y,o.y,s,a,d),i.initNonuniformCatmullRom(l.z,u.z,h.z,o.z,s,a,d)}else"catmullrom"===this.type&&(s=void 0!==this.tension?this.tension:.5,n.initCatmullRom(l.x,u.x,h.x,o.x,s),r.initCatmullRom(l.y,u.y,h.y,o.y,s),i.initCatmullRom(l.z,u.z,h.z,o.z,s));return new c(n.calc(t),r.calc(t),i.calc(t))})}(),Ni=Qn.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0===t?[]:t},function(t){var e=this.points;t*=e.length-1;var n=Math.floor(t);t-=n;var r=e[0==n?n:n-1],i=e[n],o=e[n>e.length-2?e.length-1:n+1],e=e[n>e.length-3?e.length-1:n+2],n=Si.interpolate;return new c(n(r.x,i.x,o.x,e.x,t),n(r.y,i.y,o.y,e.y,t),n(r.z,i.z,o.z,e.z,t))}),Ii=Qn.create(function(t,e,n,r){this.v0=t,this.v1=e,this.v2=n,this.v3=r},function(t){var e=_i.b3;return new c(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),Di=Qn.create(function(t,e,n){this.v0=t,this.v1=e,this.v2=n},function(t){var e=_i.b2;return new c(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z))}),Ui=Qn.create(function(t,e){this.v1=t,this.v2=e},function(t){if(1===t)return this.v2.clone();var e=new c;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e});$r.prototype=Object.create(er.prototype),$r.prototype.constructor=$r,Qr.prototype=Object.create(Oi.prototype),Gr.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Object.assign(V.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(J.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),st.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ri.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(K.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToBuffer:function(t,e,n){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)}}),Object.assign(l.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new c),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t,e,n){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)}}),tt.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},s.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(rt.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(or.prototype,{extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new je(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new $e(this,t)}}),Object.assign(c.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)}}),wt.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(at.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(at.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(ce.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Lt.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Mn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(ht.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Et.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Et.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Er.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.");
}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(q.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new H}}}),Object.defineProperties(dn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Y.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),e.prototype=Object.assign(Object.create({constructor:e,apply:function(t){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(t,this)}}),e.prototype),Object.assign(ee.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(ee.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(nt.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(t){t=1!==t,console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(o.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),mr.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new ur).load(t,function(t){e.setBuffer(t)}),this},vr.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},t.WebGLRenderTargetCube=a,t.WebGLRenderTarget=o,t.WebGLRenderer=ee,t.ShaderLib=fi,t.UniformsLib=pi,t.UniformsUtils=ui,t.ShaderChunk=hi,t.FogExp2=ne,t.Fog=re,t.Scene=ie,t.LensFlare=oe,t.Sprite=se,t.LOD=ce,t.SkinnedMesh=he,t.Skeleton=le,t.Bone=ue,t.Mesh=Mt,t.LineSegments=fe,t.Line=pe,t.Points=ge,t.Group=ve,t.VideoTexture=ye,t.DataTexture=G,t.CompressedTexture=_e,t.CubeTexture=u,t.CanvasTexture=be,t.DepthTexture=xe,t.Texture=r,t.CompressedTextureLoader=_n,t.BinaryTextureLoader=bn,t.DataTextureLoader=bn,t.CubeTextureLoader=wn,t.TextureLoader=En,t.ObjectLoader=$n,t.MaterialLoader=qn,t.BufferGeometryLoader=Yn,t.DefaultLoadingManager=Ei,t.LoadingManager=vn,t.JSONLoader=Jn,t.ImageLoader=xn,t.FontLoader=lr,t.FileLoader=yn,t.Loader=Zn,t.Cache=wi,t.AudioLoader=ur,t.SpotLightShadow=An,t.SpotLight=Ln,t.PointLight=Rn,t.RectAreaLight=hr,t.HemisphereLight=Tn,t.DirectionalLightShadow=Cn,t.DirectionalLight=Pn,t.AmbientLight=On,t.LightShadow=Sn,t.Light=Mn,t.StereoCamera=dr,t.PerspectiveCamera=Lt,t.OrthographicCamera=Rt,t.CubeCamera=pr,t.Camera=At,t.AudioListener=fr,t.PositionalAudio=gr,t.AudioContext=Ri,t.AudioAnalyser=vr,t.Audio=mr,t.VectorKeyframeTrack=Bn,t.StringKeyframeTrack=Hn,t.QuaternionKeyframeTrack=kn,t.NumberKeyframeTrack=jn,t.ColorKeyframeTrack=Vn,t.BooleanKeyframeTrack=Gn,t.PropertyMixer=yr,t.PropertyBinding=_r,t.KeyframeTrack=Wn,t.AnimationUtils=Mi,t.AnimationObjectGroup=br,t.AnimationMixer=wr,t.AnimationClip=Xn,t.Uniform=Er,t.InstancedBufferGeometry=Mr,t.BufferGeometry=Et,t.GeometryIdCount=function(){return vi++},t.Geometry=wt,t.InterleavedBufferAttribute=Tr,t.InstancedInterleavedBuffer=Ar,t.InterleavedBuffer=Sr,t.InstancedBufferAttribute=Lr,t.Face3=lt,t.Object3D=at,t.Raycaster=Rr,t.Layers=ot,t.EventDispatcher=e,t.Clock=Or,t.QuaternionLinearInterpolant=zn,t.LinearInterpolant=Dn,t.DiscreteInterpolant=Un,t.CubicInterpolant=In,t.Interpolant=Nn,t.Triangle=ct,t.Spline=function(t){function e(t,e,n,r,i,o,a){return t=.5*(n-t),r=.5*(r-e),(2*(e-n)+t+r)*a+(-3*(e-n)-2*t-r)*o+t*i+e}this.points=t;var n=[],r={x:0,y:0,z:0},i,o,a,s,l,u,h,d,p;this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return i=(this.points.length-1)*t,o=Math.floor(i),a=i-o,n[0]=0===o?o:o-1,n[1]=o,n[2]=o>this.points.length-2?this.points.length-1:o+1,n[3]=o>this.points.length-3?this.points.length-1:o+2,u=this.points[n[0]],h=this.points[n[1]],d=this.points[n[2]],p=this.points[n[3]],s=a*a,l=a*s,r.x=e(u.x,h.x,d.x,p.x,a,s,l),r.y=e(u.y,h.y,d.y,p.y,a,s,l),r.z=e(u.z,h.z,d.z,p.z,a,s,l),r},this.getControlPointsArray=function(){var t,e,n=this.points.length,r=[];for(t=0;t<n;t++)e=this.points[t],r[t]=[e.x,e.y,e.z];return r},this.getLength=function(t){var e,n,r,i=0,o=new c,a=new c,s=[],l=0;for(s[0]=0,t||(t=100),n=this.points.length*t,o.copy(this.points[0]),t=1;t<n;t++)e=t/n,r=this.getPoint(e),a.copy(r),l+=a.distanceTo(o),o.copy(r),e*=this.points.length-1,e=Math.floor(e),e!==i&&(s[e]=l,i=e);return s[s.length]=l,{chunks:s,total:l}},this.reparametrizeByArcLength=function(t){var e,n,r,i,o,a,s=[],l=new c,u=this.getLength();for(s.push(l.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(n=u.chunks[e]-u.chunks[e-1],a=Math.ceil(t*n/u.total),i=(e-1)/(this.points.length-1),o=e/(this.points.length-1),n=1;n<a-1;n++)r=i+1/a*n*(o-i),r=this.getPoint(r),s.push(l.copy(r).clone());s.push(l.copy(this.points[e]).clone())}this.points=s}},t.Math=ri,t.Spherical=Nr,t.Cylindrical=Ir,t.Plane=tt,t.Frustum=et,t.Sphere=Q,t.Ray=rt,t.Matrix4=l,t.Matrix3=K,t.Box3=J,t.Box2=V,t.Line3=st,t.Euler=it,t.Vector4=i,t.Vector3=c,t.Vector2=n,t.Quaternion=s,t.Color=H,t.MorphBlendMesh=Dr,t.ImmediateRenderObject=Ur,t.VertexNormalsHelper=Fr,t.SpotLightHelper=Br,t.SkeletonHelper=zr,t.PointLightHelper=kr,t.RectAreaLightHelper=jr,t.HemisphereLightHelper=Hr,t.GridHelper=Gr,t.PolarGridHelper=Vr,t.FaceNormalsHelper=Wr,t.DirectionalLightHelper=Xr,t.CameraHelper=qr,t.BoxHelper=Yr,t.ArrowHelper=Zr,t.AxisHelper=Jr,t.CatmullRomCurve3=Oi,t.SplineCurve3=Ni,t.CubicBezierCurve3=Ii,t.QuadraticBezierCurve3=Di,t.LineCurve3=Ui,t.ArcCurve=$r,t.EllipseCurve=er,t.SplineCurve=nr,t.CubicBezierCurve=rr,t.QuadraticBezierCurve=ir,t.LineCurve=Kn,t.Shape=or,t.ShapePath=sr,t.Path=ar,t.Font=cr,t.CurvePath=tr,t.Curve=Qn,t.ShapeUtils=_i,t.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new ve,r=0,i=e.length;r<i;r++)n.add(new Mt(t,e[r]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){var r=new l;r.getInverse(n.matrixWorld),t.applyMatrix(r),e.remove(t),n.add(t)}},t.CurveUtils=Si,t.WireframeGeometry=we,t.ParametricGeometry=Me,t.ParametricBufferGeometry=Ee,t.TetrahedronGeometry=Ae,t.TetrahedronBufferGeometry=Se,t.OctahedronGeometry=Re,t.OctahedronBufferGeometry=Le,t.IcosahedronGeometry=Pe,t.IcosahedronBufferGeometry=Ce,t.DodecahedronGeometry=Ne,t.DodecahedronBufferGeometry=Oe;t.PolyhedronGeometry=Ie;t.PolyhedronBufferGeometry=Te,t.TubeGeometry=Ue,t.TubeBufferGeometry=De,t.TorusKnotGeometry=Be,t.TorusKnotBufferGeometry=Fe,t.TorusGeometry=ke,t.TorusBufferGeometry=ze,t.TextGeometry=He,t.SphereBufferGeometry=Ge,t.SphereGeometry=Ve,t.RingGeometry=Xe,t.RingBufferGeometry=We,t.PlaneBufferGeometry=St,t.PlaneGeometry=qe,t.LatheGeometry=Ze,t.LatheBufferGeometry=Ye,t.ShapeGeometry=$e,t.ShapeBufferGeometry=Je,t.ExtrudeGeometry=je,t.EdgesGeometry=Qe,t.ConeGeometry=en,t.ConeBufferGeometry=nn,t.CylinderGeometry=tn,t.CylinderBufferGeometry=Ke,t.CircleBufferGeometry=rn,t.CircleGeometry=on,t.BoxBufferGeometry=Tt,t.BoxGeometry=an,t.ShadowMaterial=sn,t.SpriteMaterial=ae,t.RawShaderMaterial=cn,t.ShaderMaterial=Y,t.PointsMaterial=me,t.MultiMaterial=ln,t.MeshPhysicalMaterial=hn,t.MeshStandardMaterial=un,t.MeshPhongMaterial=dn,t.MeshToonMaterial=pn,t.MeshNormalMaterial=fn,t.MeshLambertMaterial=mn,t.MeshDepthMaterial=Z,t.MeshBasicMaterial=ut,t.LineDashedMaterial=gn,t.LineBasicMaterial=de,t.Material=q,t.Float64BufferAttribute=bt,t.Float32BufferAttribute=_t,t.Uint32BufferAttribute=yt,t.Int32BufferAttribute=vt,t.Uint16BufferAttribute=gt,t.Int16BufferAttribute=mt,t.Uint8ClampedBufferAttribute=ft,t.Uint8BufferAttribute=pt,t.Int8BufferAttribute=dt,t.BufferAttribute=ht,t.REVISION="83",t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.BlendingMode=Kr,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.Uncharted2ToneMapping=3,t.CineonToneMapping=4,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.SphericalReflectionMapping=305,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.TextureMapping=ti,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.TextureWrapping=ei,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.TextureFilter=ni,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.AlphaFormat=1021,t.RGBFormat=1022,t.RGBAFormat=1023,t.LuminanceFormat=1024,t.LuminanceAlphaFormat=1025,t.RGBEFormat=1023,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.RGB_S3TC_DXT1_Format=2001,t.RGBA_S3TC_DXT1_Format=2002,t.RGBA_S3TC_DXT3_Format=2003,t.RGBA_S3TC_DXT5_Format=2004,t.RGB_PVRTC_4BPPV1_Format=2100,t.RGB_PVRTC_2BPPV1_Format=2101,t.RGBA_PVRTC_4BPPV1_Format=2102,t.RGBA_PVRTC_2BPPV1_Format=2103,t.RGB_ETC1_Format=2151,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=2400,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.CubeGeometry=an,t.Face4=function(t,e,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new lt(t,e,n,i,o,a)},t.LineStrip=0,t.LinePieces=1,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been renamed to THREE.MultiMaterial."),new ln(t)},t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ge(t,e)},t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new se(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ge(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new me(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new me(t)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new me(t)},t.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new c(t,e,n)},t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new ht(t,e).setDynamic(!0)},t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new dt(t,e)},t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new pt(t,e)},t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ft(t,e)};t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new mt(t,e)};t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new gt(t,e)},t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new vt(t,e)},t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new yt(t,e)},t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new _t(t,e)},t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new bt(t,e)},t.ClosedSplineCurve3=Qr,t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Yr(t,e)},t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new fe(new Qe(t.geometry),new de({color:void 0!==e?e:16777215}))},t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new fe(new we(t.geometry),new de({color:void 0!==e?e:16777215}))},t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new yn(t)},t.GeometryUtils={merge:function(t,e,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var r;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new En;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,n,void 0,r),e&&(t.mapping=e),t},loadTextureCube:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new wn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,n,void 0,r),e&&(t.mapping=e),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},t.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(t,"__esModule",{value:!0})}),THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*N.autoRotateSpeed}function r(){return Math.pow(.95,N.zoomSpeed)}function i(t){j.theta-=t}function o(t){j.phi-=t}function a(t){N.object instanceof THREE.PerspectiveCamera?H/=t:N.object instanceof THREE.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom*t)),N.object.updateProjectionMatrix(),V=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function s(t){N.object instanceof THREE.PerspectiveCamera?H*=t:N.object instanceof THREE.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom/t)),N.object.updateProjectionMatrix(),V=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function c(t){W.set(t.clientX,t.clientY)}function l(t){Q.set(t.clientX,t.clientY)}function u(t){Y.set(t.clientX,t.clientY)}function h(t){X.set(t.clientX,t.clientY),q.subVectors(X,W);var e=N.domElement===document?N.domElement.body:N.domElement;i(2*Math.PI*q.x/e.clientWidth*N.rotateSpeed),o(2*Math.PI*q.y/e.clientHeight*N.rotateSpeed),W.copy(X),N.update()}function d(t){K.set(t.clientX,t.clientY),tt.subVectors(K,Q),tt.y>0?a(r()):tt.y<0&&s(r()),Q.copy(K),N.update()}function p(t){Z.set(t.clientX,t.clientY),J.subVectors(Z,Y),rt(J.x,J.y),Y.copy(Z),N.update()}function f(t){}function m(t){t.deltaY<0?s(r()):t.deltaY>0&&a(r()),N.update()}function g(t){switch(t.keyCode){case N.keys.UP:rt(0,N.keyPanSpeed),N.update();break;case N.keys.BOTTOM:rt(0,-N.keyPanSpeed),N.update();break;case N.keys.LEFT:rt(N.keyPanSpeed,0),N.update();break;case N.keys.RIGHT:rt(-N.keyPanSpeed,0),N.update()}}function v(t){W.set(t.touches[0].pageX,t.touches[0].pageY)}function y(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);Q.set(0,r)}function _(t){Y.set(t.touches[0].pageX,t.touches[0].pageY)}function b(t){X.set(t.touches[0].pageX,t.touches[0].pageY),q.subVectors(X,W);var e=N.domElement===document?N.domElement.body:N.domElement;i(2*Math.PI*q.x/e.clientWidth*N.rotateSpeed),o(2*Math.PI*q.y/e.clientHeight*N.rotateSpeed),W.copy(X),N.update()}function x(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);K.set(0,i),tt.subVectors(K,Q),tt.y>0?s(r()):tt.y<0&&a(r()),Q.copy(K),N.update()}function w(t){Z.set(t.touches[0].pageX,t.touches[0].pageY),J.subVectors(Z,Y),rt(J.x,J.y),Y.copy(Z),N.update()}function E(t){}function M(t){if(N.enabled!==!1){if(t.preventDefault(),t.button===N.mouseButtons.ORBIT){if(N.enableRotate===!1)return;c(t),B=F.ROTATE}else if(t.button===N.mouseButtons.ZOOM){if(N.enableZoom===!1)return;l(t),B=F.DOLLY}else if(t.button===N.mouseButtons.PAN){if(N.enablePan===!1)return;u(t),B=F.PAN}B!==F.NONE&&(document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",S,!1),N.dispatchEvent(D))}}function T(t){if(N.enabled!==!1)if(t.preventDefault(),B===F.ROTATE){if(N.enableRotate===!1)return;h(t)}else if(B===F.DOLLY){if(N.enableZoom===!1)return;d(t)}else if(B===F.PAN){if(N.enablePan===!1)return;p(t)}}function S(t){N.enabled!==!1&&(f(t),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",S,!1),N.dispatchEvent(U),B=F.NONE)}function A(t){N.enabled===!1||N.enableZoom===!1||B!==F.NONE&&B!==F.ROTATE||(t.preventDefault(),t.stopPropagation(),m(t),N.dispatchEvent(D),N.dispatchEvent(U))}function L(t){N.enabled!==!1&&N.enableKeys!==!1&&N.enablePan!==!1&&g(t)}function R(t){if(N.enabled!==!1){switch(t.touches.length){case 1:if(N.enableRotate===!1)return;v(t),B=F.TOUCH_ROTATE;break;case 2:if(N.enableZoom===!1)return;y(t),B=F.TOUCH_DOLLY;break;case 3:if(N.enablePan===!1)return;_(t),B=F.TOUCH_PAN;break;default:B=F.NONE}B!==F.NONE&&N.dispatchEvent(D)}}function C(t){if(N.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(N.enableRotate===!1)return;if(B!==F.TOUCH_ROTATE)return;b(t);break;case 2:if(N.enableZoom===!1)return;if(B!==F.TOUCH_DOLLY)return;x(t);break;case 3:if(N.enablePan===!1)return;if(B!==F.TOUCH_PAN)return;w(t);break;default:B=F.NONE}}function P(t){N.enabled!==!1&&(E(t),N.dispatchEvent(U),B=F.NONE)}function O(t){t.preventDefault()}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return k.phi},this.getAzimuthalAngle=function(){return k.theta},this.reset=function(){N.target.copy(N.target0),N.object.position.copy(N.position0),N.object.zoom=N.zoom0,N.object.updateProjectionMatrix(),N.dispatchEvent(I),N.update(),B=F.NONE},this.update=function(){var e=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),o=r.clone().inverse(),a=new THREE.Vector3,s=new THREE.Quaternion;return function t(){var c=N.object.position;return e.copy(c).sub(N.target),e.applyQuaternion(r),k.setFromVector3(e),N.autoRotate&&B===F.NONE&&i(n()),k.theta+=j.theta,k.phi+=j.phi,k.theta=Math.max(N.minAzimuthAngle,Math.min(N.maxAzimuthAngle,k.theta)),k.phi=Math.max(N.minPolarAngle,Math.min(N.maxPolarAngle,k.phi)),k.makeSafe(),k.radius*=H,k.radius=Math.max(N.minDistance,Math.min(N.maxDistance,k.radius)),N.target.add(G),e.setFromSpherical(k),e.applyQuaternion(o),c.copy(N.target).add(e),N.object.lookAt(N.target),N.enableDamping===!0?(j.theta*=1-N.dampingFactor,j.phi*=1-N.dampingFactor):j.set(0,0,0),H=1,G.set(0,0,0),!!(V||a.distanceToSquared(N.object.position)>z||8*(1-s.dot(N.object.quaternion))>z)&&(N.dispatchEvent(I),a.copy(N.object.position),s.copy(N.object.quaternion),V=!1,!0)}}(),this.dispose=function(){N.domElement.removeEventListener("contextmenu",O,!1),N.domElement.removeEventListener("mousedown",M,!1),N.domElement.removeEventListener("wheel",A,!1),N.domElement.removeEventListener("touchstart",R,!1),N.domElement.removeEventListener("touchend",P,!1),N.domElement.removeEventListener("touchmove",C,!1),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",S,!1),window.removeEventListener("keydown",L,!1)};var N=this,I={type:"change"},D={type:"start"},U={type:"end"},F={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},B=F.NONE,z=1e-6,k=new THREE.Spherical,j=new THREE.Spherical,H=1,G=new THREE.Vector3,V=!1,W=new THREE.Vector2,X=new THREE.Vector2,q=new THREE.Vector2,Y=new THREE.Vector2,Z=new THREE.Vector2,J=new THREE.Vector2,Q=new THREE.Vector2,K=new THREE.Vector2,tt=new THREE.Vector2,et=function(){var t=new THREE.Vector3;return function e(n,r){t.setFromMatrixColumn(r,0),t.multiplyScalar(-n),G.add(t)}}(),nt=function(){var t=new THREE.Vector3;return function e(n,r){t.setFromMatrixColumn(r,1),t.multiplyScalar(n),G.add(t)}}(),rt=function(){var t=new THREE.Vector3;return function e(n,r){var i=N.domElement===document?N.domElement.body:N.domElement;if(N.object instanceof THREE.PerspectiveCamera){var o=N.object.position;t.copy(o).sub(N.target);var a=t.length();a*=Math.tan(N.object.fov/2*Math.PI/180),et(2*n*a/i.clientHeight,N.object.matrix),nt(2*r*a/i.clientHeight,N.object.matrix)}else N.object instanceof THREE.OrthographicCamera?(et(n*(N.object.right-N.object.left)/N.object.zoom/i.clientWidth,N.object.matrix),nt(r*(N.object.top-N.object.bottom)/N.object.zoom/i.clientHeight,N.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),N.enablePan=!1)}}();N.domElement.addEventListener("contextmenu",O,!1),N.domElement.addEventListener("mousedown",M,!1),N.domElement.addEventListener("wheel",A,!1),N.domElement.addEventListener("touchstart",R,!1),N.domElement.addEventListener("touchend",P,!1),N.domElement.addEventListener("touchmove",C,!1),window.addEventListener("keydown",L,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){
return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}}),THREE.DeviceOrientationControls=function(t){var e=this;this.object=t,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var n=function(t){e.deviceOrientation=t},r=function(){e.screenOrientation=window.orientation||0},i=function(){var t=new THREE.Vector3(0,0,1),e=new THREE.Euler,n=new THREE.Quaternion,r=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(i,o,a,s,c){e.set(a,o,-s,"YXZ"),i.setFromEuler(e),i.multiply(r),i.multiply(n.setFromAxisAngle(t,-c))}}();this.connect=function(){r(),window.addEventListener("orientationchange",r,!1),window.addEventListener("deviceorientation",n,!1),e.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",r,!1),window.removeEventListener("deviceorientation",n,!1),e.enabled=!1},this.update=function(){if(e.enabled!==!1){var t=e.deviceOrientation.alpha?THREE.Math.degToRad(e.deviceOrientation.alpha)+this.alphaOffsetAngle:0,n=e.deviceOrientation.beta?THREE.Math.degToRad(e.deviceOrientation.beta):0,r=e.deviceOrientation.gamma?THREE.Math.degToRad(e.deviceOrientation.gamma):0,o=e.screenOrientation?THREE.Math.degToRad(e.screenOrientation):0;i(e.object.quaternion,t,n,r,o),this.alpha=t}},this.updateAlphaOffsetAngle=function(t){this.alphaOffsetAngle=t,this.update()},this.dispose=function(){this.disconnect()},this.connect()};var Stats=function(){function t(t){return r.appendChild(t.dom),t}function e(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";n=t}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(t){t.preventDefault(),e(++n%r.children.length)},!1);var i=(performance||Date).now(),o=i,a=0,s=t(new Stats.Panel("FPS","#0ff","#002")),c=t(new Stats.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=t(new Stats.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:r,addPanel:t,showPanel:e,begin:function(){i=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(c.update(t-i,200),t>o+1e3&&(s.update(1e3*a/(t-o),100),o=t,a=0,l)){var e=performance.memory;l.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){i=this.end()},domElement:r,setMode:e}};Stats.Panel=function(t,e,n){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,c=48*a,l=3*a,u=2*a,h=3*a,d=15*a,p=74*a,f=30*a,m=document.createElement("canvas");m.width=s,m.height=c,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,s,c),g.fillStyle=e,g.fillText(t,l,u),g.fillRect(h,d,p,f),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h,d,p,f),{dom:m,update:function(c,v){r=Math.min(r,c),i=Math.max(i,c),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,s,d),g.fillStyle=e,g.fillText(o(c)+" "+t+" ("+o(r)+"-"+o(i)+")",l,u),g.drawImage(m,h+a,d,p-a,f,h,d,p-a,f),g.fillRect(h+p-a,d,a,f),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h+p-a,d,a,o((1-c/v)*f))}}},"object"==typeof module&&(module.exports=Stats),THREE.StereoEffect=function(t){var e=new THREE.StereoCamera;e.aspect=.5,this.setEyeSeparation=function(t){e.eyeSep=t},this.setSize=function(e,n){t.setSize(e,n)},this.render=function(n,r){n.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),e.update(r);var i=t.getSize();t.autoClear&&t.clear(),t.setScissorTest(!0),t.setScissor(0,0,i.width/2,i.height),t.setViewport(0,0,i.width/2,i.height),t.render(n,e.cameraL),t.setScissor(i.width/2,0,i.width/2,i.height),t.setViewport(i.width/2,0,i.width/2,i.height),t.render(n,e.cameraR),t.setScissorTest(!1)}};var particleCount=5,maxTrajectoryLength=500,unitArrowLength=.1,maxArrowLength=5,originalSpaceBoundaryX=5,originalSpaceBoundaryY=5,originalSpaceBoundaryZ=5,spaceBoundaryX=originalSpaceBoundaryX,spaceBoundaryY=originalSpaceBoundaryY,spaceBoundaryZ=originalSpaceBoundaryZ,dt=.01,availableCharges=[-3,-2,-1,0,1,2,3],d_min=.02,sunMass=500,if_use_periodic_boundary_condition=!0,if_override_particleCount_setting_with_lastState=!0,if_apply_LJpotential=!0,if_apply_gravitation=!0,if_apply_coulombForce=!0,if_ReferenceFrame_movesWithSun=!1,if_makeSun=!0,if_showUniverseBoundary=!0,if_showTrajectory=!0,if_showArrows=!0,if_showMapscale=!0,if_useFog=!1,if_proportionate_arrows_with_vectors=!0,if_limitArrowsMaxLength=!0,EPSILON=1,DELTA=.02,G=.08,K=.1,camera,scene,renderer,effect,controls,element,container,if_mobileDevice=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),geometry,material,mesh,particleMaterial,trajectoryMaterial,particleColors=[],particlePositions=[],particleForces=[],particleVelocities=[],particleMasses=[],particleCharges=[],arrowVelocities=[],arrowForces=[],trajectoryGeometries=[],trajectoryLines=[],totalMass=0,time=0,lastSnapshotTime=0,snapshotDuration=2*dt,strongestForcePresent=1,fastestVelocityPresent=1;$().ready(function(){init(),animate()});